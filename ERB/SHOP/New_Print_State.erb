;PRINT_XXX系コマンドと置き換えて使う関数
@NEW_PRINT_STATE, ARG, ARGS
#DIM MEMO_LINECOUNT
#DIM MEMO_FLAG3
#DIM MEMO_REDRAW

MEMO_LINECOUNT = LINECOUNT
MEMO_FLAG3 = FLAG:3
MEMO_REDRAW = CURRENTREDRAW()

REDRAW 0

SELECTCASE ARGS
CASE "通常", "通常：２", "キャラメイク", "ＬＶＵＰ"
	DRAWLINE
	IF ARG < 0
		PRINTW エラー：参照番号が負の数です
		RETURN 0
	ELSEIF ARG == 0
		PRINTW エラー：参照番号がダミーです
		RETURN 0
	ELSEIF ARG > CHARANUM-1
		PRINTW エラー：参照番号が末端キャラの登録番号を超えています
		RETURN 0
	ENDIF

	PRINTFORM ■ %CALLNAME:ARG%
	;口上セレクタ表示のテストなど
	IF ARG != MASTER
		SIF CFLAG:ARG:209 && CFLAG:ARG:209 != 1 && CFLAG:ARG:209 != 857
			PRINTFORM  口上{CFLAG:ARG:209} 
		RESULT = 0
		TRYCALLFORM IS_SINGLE_ENDING_K{NO:ARG}_{CFLAG:ARG:209}
		SIF RESULT
			CALL PRINT_STR, "(_ハートピンク_個別ＥＮＤ有_)_ _"
	ENDIF
	PRINT (
	IF STATE("悪酔い", ARG)
		CALL PRINT_COLORTEXT, "悪酔い中", DEF_COLOR("青")
		PRINT )(
	ELSEIF STATE("ドランク", ARG)
		CALL PRINT_COLORTEXT, "ドランク", DEF_COLOR("ハートピンク")
		PRINT )(
	ENDIF
	SELECTCASE ARG
	CASE MASTER
		PRINTFORM 主人 
	CASE ASSI
		SELECTCASE ABL:ASSI:助手
		CASE 0
			PRINTFORM %TEXTS("助手の名称")%見習い 
		CASEELSE
			PRINTFORM LV{ABL:ASSI:助手}%TEXTS("助手の名称")% 
		ENDSELECT
	CASE TARGET
		SIF EXP:ARG:调教次数
			PRINTFORM 調教中 
	ENDSELECT


	PRINTFORM LV:
	IF ABL:ARG:ＬＶ < NUM("最大レベル", 90)
		PRINTFORM {ABL:ARG:ＬＶ}
		SIF ARG == MASTER && ABL:MASTER:ＬＶ < FLAG:255
			PRINT  制限中
		PRINTFORM  EXP:{EXP:ARG:经验值}Ｐ
		LOCAL = 0
		SIF ARG != MASTER && ABL:ARG:ＬＶ == 14 && TALENT:ARG:梦魔
			LOCAL = 200
		IF EXP_NEXTLV(ARG, ABL:ARG:ＬＶ) + LOCAL - EXP:ARG:经验值 > 0
			PRINTFORM  NEXT:{EXP_NEXTLV(ARG, ABL:ARG:ＬＶ) + LOCAL - EXP:ARG:经验值}Ｐ
		ELSE
			CALL PRINT_STR, "黄色_LVUPOK!"
		ENDIF
	ELSE
		CALL PRINT_STR, "黄色_MAX!"
		PRINTFORM  EXP:{EXP:ARG:经验值}Ｐ
	ENDIF

	SIF COND("化蝶之梦", ARG) > 0
		PRINTFORM  %CALLNAME:COND("化蝶之梦", ARG)%の体

	PRINTFORM ) ■

	SIF TALENT:ARG:怀孕 || BASE:ARG:育児中 || GETBITS(BASE:ARG:バイオリズム, 10, 20) || COND("避妊中", ARG) || COND("着床確認", ARG)
		PRINT  (
	IF BASE:ARG:育児中
		PRINTFORM %CONDS("胎児の父親", ARG)%の子を子育て中
		SIF TALENT:ARG:怀孕 || GETBITS(BASE:ARG:バイオリズム, 10, 20) || COND("避妊中", ARG)
			PRINT 　
	ENDIF
	IF TALENT:ARG:怀孕
		PRINTFORM %CONDS("精液の優勢", ARG)%の子を妊娠中
	ELSEIF COND("発情期", ARG)
		SETCOLOR DEF_COLOR("ハートピンク")
		PRINTFORM 発情期
	ELSEIF COND("着床確認", ARG)
		SETCOLOR DEF_COLOR("ハートピンク")
		PRINTFORM %CONDS("精液の優勢", ARG)%の精子で着床
		CALL HEARTMARK
	ELSEIF COND("避妊中", ARG)
		IF TALENT:ARG:避孕护符
			PRINTFORM 避孕护符
		ELSEIF TALENT:ARG:避孕药服用
			PRINTFORM 避妊薬服用中:あと{TALENT:ARG:避孕药服用}日分
		ENDIF
	ELSEIF COND("安全日", ARG)
		PRINTFORM 安全日
	ELSEIF COND("排卵中", ARG)
		SETCOLOR DEF_COLOR("ハートピンク")
		PRINTFORM 危険日
	ELSEIF COND("危険日", ARG)
		SETCOLOR DEF_COLOR("イエロー")
		PRINTFORM 危険日
	ENDIF
	RESETCOLOR
	SIF TALENT:ARG:怀孕 || BASE:ARG:育児中 || GETBITS(BASE:ARG:バイオリズム, 10, 20) || COND("避妊中", ARG) || COND("着床確認", ARG)
		PRINT )
	PRINTL 
	;好感度
	SIF ARG != MASTER
		PRINTFORM 好感度:{CFLAG:ARG:2}　
	;体力の表示
	PRINTFORM 体力:{MAXBASE:ARG:体力}　
	PRINTFORM 気力:{MAXBASE:ARG:気力}　
	SIF MAXBASE:ARG:精力
		PRINTFORM 精力:{MAXBASE:ARG:精力}\@ MAXBASE:ARG:STOCK ? ×{MAXBASE:ARG:STOCK} # \@　
	SIF TALENT:ARG:男性 == 0
		PRINTFORM 胎内精液量:{COND("胎内の精液量", ARG)}pt
	PRINTL 
	;最後に相手した日からの経過日数
	SIF ARG != MASTER && COND("前回調教日", ARG) && COND("調教空白期間", ARG) >= 2
		PRINTFORML 前回調教日：{COND("前回調教日", ARG)}日　放置期間：{COND("調教空白期間", ARG)}日
CASE "召喚"
	CALL PROFILE_TEXT, NO:ARG
ENDSELECT


SELECTCASE ARGS
CASE "ＬＶＵＰ"
	CALL NEW_PRINT_EXP, TARGET
	SIF EXP:异常经验
		CALL NEW_PRINT_EXP50, TARGET
	CALL NEW_PRINT_JUEL, TARGET
	DRAWLINE
CASE "通常"
	IF ARG == MASTER
		CALL NEW_PRINT_3SIZE, ARG, "個別表示"
		CALL NEW_PRINT_ZOKUSEI, ARG
		CALL NEW_PRINT_JUEL, ARG
		CALL NEW_PRINT_EXP, ARG
		CALL NEW_PRINT_EXP50, ARG
		CALL NEW_PRINT_ABL, ARG
		CALL NEW_PRINT_MARK, ARG
		CALL NEW_PRINT_TALENT, ARG
		CALL NEW_PRINT_PUBICHAIR, ARG
		CALL PRINT_EQUIPPING_ACCESSORY, ARG

		CALL PRINT_MIDASHINAMI, ARG
		CALL PRINT_COS, ARG
		CALL SHOW_FAMILY, ARG
		CALL PRINT_RELATION, ARG
		CALL PRINT_OTHER, ARG
		DRAWLINE
		PRINTFORM [ 0]身嗜みの変更
		IF NUM("所持アクセサリ")
			PRINTFORM  [ 7]アクセサリセット
		ELSE
			PRINTPLAINFORM  [×]アクセサリセット
		ENDIF
		PRINTL 

		PRINTBUTTON "[Enter]閉じる", "Enter"
		;PRINTPLAINFORM  [×]page1
		PRINTFORM  [ 2]page2
		PRINTPLAINFORM  [×]主人
		IF TARGET > 0
			PRINTFORM  [ 5]調教対象
		ELSE
			PRINTPLAINFORM  [×]調教対象
		ENDIF
		IF ASSI > 0
			PRINTFORM  [ 6]%TEXTS("助手の名称")%
		ELSE
			PRINTPLAINFORM  [×]%TEXTS("助手の名称")%
		ENDIF
		PRINTFORM  [ 8]\@ ARG == 1 ? 最後 # 前 \@
		PRINTFORML  [ 9]\@ ARG == CHARANUM - 1 ? 最初 # 次 \@

		ONEINPUTS

		SELECTCASE RESULTS
		CASE "1", "3", "4"
			CLEARLINE LINECOUNT - MEMO_LINECOUNT
			RESTART
		CASE "7"
			IF NUM("所持アクセサリ")
				CALL ACCESSORY_SELECT
			ELSE
				CLEARLINE LINECOUNT - MEMO_LINECOUNT
			ENDIF
			RESTART
		CASE "0"
			CALL SET_MIDASHINAMI, MASTER
			RESTART
		CASE "2"
			ARGS = 通常：２
			RESTART
		CASE "5"
			SIF ARG != TARGET && TARGET > 0
				ARG = TARGET
			RESTART
		CASE "6"
			SIF ARG != ASSI && ASSI > 0
				ARG = ASSI
			RESTART
		CASE "8"
			IF ARG == 1
				ARG = CHARANUM - 1
			ELSE
				ARG -= 1
			ENDIF
			RESTART
		CASE "9"
			IF ARG == CHARANUM - 1
				ARG = 1
			ELSE
				ARG += 1
			ENDIF
			RESTART
		ENDSELECT
	ELSE
		CALL NEW_PRINT_3SIZE, ARG, "個別表示"
		CALL NEW_PRINT_ZOKUSEI, ARG
		CALL NEW_PRINT_JUEL, ARG
		CALL NEW_PRINT_EXP, ARG
		CALL NEW_PRINT_EXP50, ARG
		CALL NEW_PRINT_ABL, ARG
		CALL NEW_PRINT_MARK, ARG
		CALL NEW_PRINT_TALENT, ARG
		CALL NEW_PRINT_PUBICHAIR, ARG
		CALL PRINT_EQUIPPING_ACCESSORY, ARG

		DRAWLINE
		PRINTBUTTON "[Enter]閉じる", "Enter"
		;PRINTPLAINFORM  [×]page1
		PRINTFORM  [ 2]page2
		PRINTFORM  [ 4]主人
		IF ARG != TARGET && TARGET > 0
			PRINTFORM  [ 5]調教対象
		ELSE
			PRINTPLAINFORM  [×]調教対象
		ENDIF
		IF ARG != ASSI && ASSI > 0
			PRINTFORM  [ 6]%TEXTS("助手の名称")%
		ELSE
			PRINTPLAINFORM  [×]%TEXTS("助手の名称")%
		ENDIF
		PRINTFORM  [ 8]\@ ARG == 1 ? 最後 # 前 \@
		PRINTFORML  [ 9]\@ ARG == CHARANUM - 1 ? 最初 # 次 \@

		ONEINPUTS

		SELECTCASE RESULTS
		CASE "0", "1", "3", "7"
			CLEARLINE LINECOUNT - MEMO_LINECOUNT
			RESTART
		CASE "2"
			ARGS = 通常：２
			RESTART
		CASE "4"
			ARG = MASTER
			RESTART
		CASE "5"
			SIF ARG != TARGET && TARGET > 0
				ARG = TARGET
			RESTART
		CASE "6"
			SIF ARG != ASSI && ASSI > 0
				ARG = ASSI
			RESTART
		CASE "8"
			IF ARG == 1
				ARG = CHARANUM - 1
			ELSE
				ARG -= 1
			ENDIF
			RESTART
		CASE "9"
			IF ARG == CHARANUM - 1
				ARG = 1
			ELSE
				ARG += 1
			ENDIF
			RESTART
		ENDSELECT
	ENDIF
CASE "通常：２"
	IF ARG == MASTER
		CALL SHOOT_RANKING, ARG
		DRAWLINE
		PRINTFORM [ 0]身嗜みの変更
		IF NUM("所持アクセサリ")
			PRINTFORM  [ 7]アクセサリセット
		ELSE
			PRINTPLAINFORM  [×]アクセサリセット
		ENDIF
		PRINTL 

		PRINTBUTTON "[Enter]閉じる", "Enter"
		PRINTFORM  [ 1]page1
		;PRINTPLAINFORM  [×]page2
		PRINTPLAINFORM  [×]主人
		IF TARGET > 0
			PRINTFORM  [ 5]調教対象
		ELSE
			PRINTPLAINFORM  [×]調教対象
		ENDIF
		IF ASSI > 0
			PRINTFORM  [ 6]%TEXTS("助手の名称")%
		ELSE
			PRINTPLAINFORM  [×]%TEXTS("助手の名称")%
		ENDIF
		PRINTFORM  [ 8]\@ ARG == 1 ? 最後 # 前 \@
		PRINTFORML  [ 9]\@ ARG == CHARANUM - 1 ? 最初 # 次 \@
		ONEINPUTS

		SELECTCASE RESULTS
		CASE "2", "3", "4"
			CLEARLINE LINECOUNT - MEMO_LINECOUNT
			RESTART
		CASE "7"
			IF NUM("所持アクセサリ")
				CALL ACCESSORY_SELECT
			ELSE
				CLEARLINE LINECOUNT - MEMO_LINECOUNT
			ENDIF
			RESTART
		CASE "0"
			CALL SET_MIDASHINAMI, MASTER
			RESTART
		CASE "1"
			ARGS = 通常
			RESTART
		CASE "5"
			SIF ARG != TARGET && TARGET > 0
				ARG = TARGET
			RESTART
		CASE "6"
			SIF ARG != ASSI && ASSI > 0
				ARG = ASSI
			RESTART
		CASE "8"
			IF ARG == 1
				ARG = CHARANUM - 1
			ELSE
				ARG -= 1
			ENDIF
			RESTART
		CASE "9"
			IF ARG == CHARANUM - 1
				ARG = 1
			ELSE
				ARG += 1
			ENDIF
			RESTART
		ENDSELECT
	ELSE
		;CALL PRINT_REMARKS, ARG
		CALL PRINT_INDICATE, ARG
		CALL PRINT_MIDASHINAMI, ARG
		CALL PRINT_COS, ARG
		CALL SHOW_FAMILY, ARG
		CALL PRINT_RELATION, ARG
		CALL PRINT_VIDEO, ARG
		CALL PRINT_OTHER, ARG
		DRAWLINE
		PRINTBUTTON "[Enter]閉じる", "Enter"
		PRINTFORM  [ 1]page1
		;PRINTPLAINFORM  [×]page2
		PRINTFORM  [ 4]主人
		IF ARG != TARGET && TARGET > 0
			PRINTFORM  [ 5]調教対象
		ELSE
			PRINTPLAINFORM  [×]調教対象
		ENDIF
		IF ARG != ASSI && ASSI > 0
			PRINTFORM  [ 6]%TEXTS("助手の名称")%
		ELSE
			PRINTPLAINFORM  [×]%TEXTS("助手の名称")%
		ENDIF
		PRINTFORM  [ 8]\@ ARG == 1 ? 最後 # 前 \@
		PRINTFORML  [ 9]\@ ARG == CHARANUM - 1 ? 最初 # 次 \@

		ONEINPUTS

		SELECTCASE RESULTS
		CASE "0", "2", "3", "7"
			CLEARLINE LINECOUNT - MEMO_LINECOUNT
			RESTART
		CASE "1"
			ARGS = 通常
			RESTART
		CASE "4"
			ARG = MASTER
			RESTART
		CASE "5"
			SIF ARG != TARGET && TARGET > 0
				ARG = TARGET
			RESTART
		CASE "6"
			SIF ARG != ASSI && ASSI > 0
				ARG = ASSI
			RESTART
		CASE "8"
			IF ARG == 1
				ARG = CHARANUM - 1
			ELSE
				ARG -= 1
			ENDIF
			RESTART
		CASE "9"
			IF ARG == CHARANUM - 1
				ARG = 1
			ELSE
				ARG += 1
			ENDIF
			RESTART
		ENDSELECT
	ENDIF
CASE "召喚", "キャラメイク"
	CALL NEW_PRINT_3SIZE, ARG, "個別表示"
	CALL NEW_PRINT_ZOKUSEI, ARG
	CALL NEW_PRINT_TALENT, ARG
	CALL NEW_PRINT_ABL, ARG
	LOCAL = FLAG:250
	FLAG:250 = 1
	CALL NEW_PRINT_EXP, ARG
	FLAG:250 = LOCAL
	CALL NEW_PRINT_EXP50, ARG
	CALL NEW_PRINT_PUBICHAIR, ARG
	CALL PRINT_RELATION, ARG, "種族"
	;CALL PRINT_COS, ARG
	DRAWLINE
ENDSELECT

SELECTCASE RESULTS
;以下は項目ONOFFボタン
CASE "搾"
	INVERTBIT FLAG:3, 0
CASE "助"
	INVERTBIT FLAG:3, 1
CASE "出"
	INVERTBIT FLAG:3, 2
CASE "身"
	INVERTBIT FLAG:3, 3
CASE "服"
	INVERTBIT FLAG:3, 4
CASE "体"
	INVERTBIT FLAG:3, 5
CASE "性"
	INVERTBIT FLAG:3, 6
CASE "弱"
	INVERTBIT FLAG:3, 7
CASE "属"
	INVERTBIT FLAG:3, 8
CASE "宝"
	INVERTBIT FLAG:3, 9
CASE "経"
	INVERTBIT FLAG:3, 10
CASE "異"
	INVERTBIT FLAG:3, 11
CASE "能"
	INVERTBIT FLAG:3, 12
CASE "刻"
	INVERTBIT FLAG:3, 13
CASE "素"
	INVERTBIT FLAG:3, 14
CASE "家"
	INVERTBIT FLAG:3, 15
CASE "相"
	INVERTBIT FLAG:3, 16
CASE "陰"
	INVERTBIT FLAG:3, 17
CASE "ア"
	INVERTBIT FLAG:3, 18
CASE "射"
	INVERTBIT FLAG:3, 19
ENDSELECT

;項目の非表示を変更した時は履歴を消してRESTART
IF MEMO_FLAG3 != FLAG:3
	CLEARLINE LINECOUNT - MEMO_LINECOUNT
	RESTART
ENDIF

REDRAW MEMO_REDRAW

RETURN 0

;中だし履歴
@SHOOT_RANKING, ARG
#DIM LCOUNT
#DIM MEMO_LINECOUNT
#DIM DYNAMIC SPERM_TOTAL, 100
#DIM DYNAMIC SPERM_RANK, 10
#DIM SPERM_RANK_V, 10
#DIM SPERM_RANK_A, 10
#DIM SPERM_RANK_M, 10
#DIM SPERM_RANK_B, 10
#DIM SPERM_RANK_U, 10

VARSET SPERM_RANK_V, -1
VARSET SPERM_RANK_A, -1
VARSET SPERM_RANK_M, -1
VARSET SPERM_RANK_B, -1
VARSET SPERM_RANK_U, -1

;中出され履歴の有無チェック
FOR LCOUNT, 1, CHARANUM
	SIF CSTR:LCOUNT:11 != "" || CSTR:LCOUNT:12 != "" || CSTR:LCOUNT:13 != "" || CSTR:LCOUNT:14 != "" || CSTR:LCOUNT:15 != ""
		BREAK
	SIF LCOUNT == CHARANUM - 1
		RETURN 0
NEXT

CALL DRAWLINES, "□ 射精ランキング □", "射精ランキング"

SIF CONFIG("項目：射精ランキング")
	RETURN 0

;SPERM_TOTAL	LCOUNT番のキャラの総中搾精量
;SPERM_RANK		SPERM_TOTALのランキング。上位５位まで表示
;SPERM_RANK_(V, A, M, B, U)	各場所の中出しランキング。上位５位まで記録

FOR LCOUNT, 1, CHARANUM
	SPERM_TOTAL:LCOUNT += CALCF("膣内精液経験", LCOUNT, ARG)
	;順位の変動
	SELECTCASE CALCF("膣内精液経験", LCOUNT, ARG)
	CASE IS > CALCF("膣内精液経験", SPERM_RANK_V:1, ARG)
		SPERM_RANK_V:5 = SPERM_RANK_V:4
		SPERM_RANK_V:4 = SPERM_RANK_V:3
		SPERM_RANK_V:3 = SPERM_RANK_V:2
		SPERM_RANK_V:2 = SPERM_RANK_V:1
		SPERM_RANK_V:1 = LCOUNT
	CASE IS > CALCF("膣内精液経験", SPERM_RANK_V:2, ARG)
		SPERM_RANK_V:5 = SPERM_RANK_V:4
		SPERM_RANK_V:4 = SPERM_RANK_V:3
		SPERM_RANK_V:3 = SPERM_RANK_V:2
		SPERM_RANK_V:2 = LCOUNT
	CASE IS > CALCF("膣内精液経験", SPERM_RANK_V:3, ARG)
		SPERM_RANK_V:5 = SPERM_RANK_V:4
		SPERM_RANK_V:4 = SPERM_RANK_V:3
		SPERM_RANK_V:3 = LCOUNT
	CASE IS > CALCF("膣内精液経験", SPERM_RANK_V:4, ARG)
		SPERM_RANK_V:5 = SPERM_RANK_V:4
		SPERM_RANK_V:4 = LCOUNT
	CASE IS > CALCF("膣内精液経験", SPERM_RANK_V:5, ARG)
		SPERM_RANK_V:5 = LCOUNT
	ENDSELECT

	SPERM_TOTAL:LCOUNT += CALCF("肛内精液経験", LCOUNT, ARG)
	;順位の変動
	SELECTCASE CALCF("肛内精液経験", LCOUNT, ARG)
	CASE IS > CALCF("肛内精液経験", SPERM_RANK_A:1, ARG)
		SPERM_RANK_A:5 = SPERM_RANK_A:4
		SPERM_RANK_A:4 = SPERM_RANK_A:3
		SPERM_RANK_A:3 = SPERM_RANK_A:2
		SPERM_RANK_A:2 = SPERM_RANK_A:1
		SPERM_RANK_A:1 = LCOUNT
	CASE IS > CALCF("肛内精液経験", SPERM_RANK_A:2, ARG)
		SPERM_RANK_A:5 = SPERM_RANK_A:4
		SPERM_RANK_A:4 = SPERM_RANK_A:3
		SPERM_RANK_A:3 = SPERM_RANK_A:2
		SPERM_RANK_A:2 = LCOUNT
	CASE IS > CALCF("肛内精液経験", SPERM_RANK_A:3, ARG)
		SPERM_RANK_A:5 = SPERM_RANK_A:4
		SPERM_RANK_A:4 = SPERM_RANK_A:3
		SPERM_RANK_A:3 = LCOUNT
	CASE IS > CALCF("肛内精液経験", SPERM_RANK_A:4, ARG)
		SPERM_RANK_A:5 = SPERM_RANK_A:4
		SPERM_RANK_A:4 = LCOUNT
	CASE IS > CALCF("肛内精液経験", SPERM_RANK_A:5, ARG)
		SPERM_RANK_A:5 = LCOUNT
	ENDSELECT

	SPERM_TOTAL:LCOUNT += CALCF("精飲経験", LCOUNT, ARG)
	;順位の変動
	SELECTCASE CALCF("精飲経験", LCOUNT, ARG)
	CASE IS > CALCF("精飲経験", SPERM_RANK_M:1, ARG)
		SPERM_RANK_M:5 = SPERM_RANK_M:4
		SPERM_RANK_M:4 = SPERM_RANK_M:3
		SPERM_RANK_M:3 = SPERM_RANK_M:2
		SPERM_RANK_M:2 = SPERM_RANK_M:1
		SPERM_RANK_M:1 = LCOUNT
	CASE IS > CALCF("精飲経験", SPERM_RANK_M:2, ARG)
		SPERM_RANK_M:5 = SPERM_RANK_M:4
		SPERM_RANK_M:4 = SPERM_RANK_M:3
		SPERM_RANK_M:3 = SPERM_RANK_M:2
		SPERM_RANK_M:2 = LCOUNT
	CASE IS > CALCF("精飲経験", SPERM_RANK_M:3, ARG)
		SPERM_RANK_M:5 = SPERM_RANK_M:4
		SPERM_RANK_M:4 = SPERM_RANK_M:3
		SPERM_RANK_M:3 = LCOUNT
	CASE IS > CALCF("精飲経験", SPERM_RANK_M:4, ARG)
		SPERM_RANK_M:5 = SPERM_RANK_M:4
		SPERM_RANK_M:4 = LCOUNT
	CASE IS > CALCF("精飲経験", SPERM_RANK_M:5, ARG)
		SPERM_RANK_M:5 = LCOUNT
	ENDSELECT

	SPERM_TOTAL:LCOUNT += CALCF("乳内精液経験", LCOUNT, ARG)
	;順位の変動
	SELECTCASE CALCF("乳内精液経験", LCOUNT, ARG)
	CASE IS > CALCF("乳内精液経験", SPERM_RANK_B:1, ARG)
		SPERM_RANK_B:5 = SPERM_RANK_B:4
		SPERM_RANK_B:4 = SPERM_RANK_B:3
		SPERM_RANK_B:3 = SPERM_RANK_B:2
		SPERM_RANK_B:2 = SPERM_RANK_B:1
		SPERM_RANK_B:1 = LCOUNT
	CASE IS > CALCF("乳内精液経験", SPERM_RANK_B:2, ARG)
		SPERM_RANK_B:5 = SPERM_RANK_B:4
		SPERM_RANK_B:4 = SPERM_RANK_B:3
		SPERM_RANK_B:3 = SPERM_RANK_B:2
		SPERM_RANK_B:2 = LCOUNT
	CASE IS > CALCF("乳内精液経験", SPERM_RANK_B:3, ARG)
		SPERM_RANK_B:5 = SPERM_RANK_B:4
		SPERM_RANK_B:4 = SPERM_RANK_B:3
		SPERM_RANK_B:3 = LCOUNT
	CASE IS > CALCF("乳内精液経験", SPERM_RANK_B:4, ARG)
		SPERM_RANK_B:5 = SPERM_RANK_B:4
		SPERM_RANK_B:4 = LCOUNT
	CASE IS > CALCF("乳内精液経験", SPERM_RANK_B:5, ARG)
		SPERM_RANK_B:5 = LCOUNT
	ENDSELECT

	SPERM_TOTAL:LCOUNT += CALCF("膀胱精液経験", LCOUNT, ARG)
	;順位の変動
	SELECTCASE CALCF("膀胱精液経験", LCOUNT, ARG)
	CASE IS > CALCF("膀胱精液経験", SPERM_RANK_U:1, ARG)
		SPERM_RANK_U:5 = SPERM_RANK_U:4
		SPERM_RANK_U:4 = SPERM_RANK_U:3
		SPERM_RANK_U:3 = SPERM_RANK_U:2
		SPERM_RANK_U:2 = SPERM_RANK_U:1
		SPERM_RANK_U:1 = LCOUNT
	CASE IS > CALCF("膀胱精液経験", SPERM_RANK_U:2, ARG)
		SPERM_RANK_U:5 = SPERM_RANK_U:4
		SPERM_RANK_U:4 = SPERM_RANK_U:3
		SPERM_RANK_U:3 = SPERM_RANK_U:2
		SPERM_RANK_U:2 = LCOUNT
	CASE IS > CALCF("膀胱精液経験", SPERM_RANK_U:3, ARG)
		SPERM_RANK_U:5 = SPERM_RANK_U:4
		SPERM_RANK_U:4 = SPERM_RANK_U:3
		SPERM_RANK_U:3 = LCOUNT
	CASE IS > CALCF("膀胱精液経験", SPERM_RANK_U:4, ARG)
		SPERM_RANK_U:5 = SPERM_RANK_U:4
		SPERM_RANK_U:4 = LCOUNT
	CASE IS > CALCF("膀胱精液経験", SPERM_RANK_U:5, ARG)
		SPERM_RANK_U:5 = LCOUNT
	ENDSELECT

	;総合順位の変動
	SELECTCASE SPERM_TOTAL:LCOUNT
	CASE IS > SPERM_TOTAL:(SPERM_RANK:1)
		SPERM_RANK:5 = SPERM_RANK:4
		SPERM_RANK:4 = SPERM_RANK:3
		SPERM_RANK:3 = SPERM_RANK:2
		SPERM_RANK:2 = SPERM_RANK:1
		SPERM_RANK:1 = LCOUNT
	CASE IS > SPERM_TOTAL:(SPERM_RANK:2)
		SPERM_RANK:5 = SPERM_RANK:4
		SPERM_RANK:4 = SPERM_RANK:3
		SPERM_RANK:3 = SPERM_RANK:2
		SPERM_RANK:2 = LCOUNT
	CASE IS > SPERM_TOTAL:(SPERM_RANK:3)
		SPERM_RANK:5 = SPERM_RANK:4
		SPERM_RANK:4 = SPERM_RANK:3
		SPERM_RANK:3 = LCOUNT
	CASE IS > SPERM_TOTAL:(SPERM_RANK:4)
		SPERM_RANK:5 = SPERM_RANK:4
		SPERM_RANK:4 = LCOUNT
	CASE IS > SPERM_TOTAL:(SPERM_RANK:5)
		SPERM_RANK:5 = LCOUNT
	ENDSELECT
NEXT

;結果発表
FOR LCOUNT, 1, CHARANUM
	;ＴＯＰ５入りのみ表示
	SIF GROUPMATCH(LCOUNT, SPERM_RANK:1, SPERM_RANK:2, SPERM_RANK:3, SPERM_RANK:4, SPERM_RANK:5) == 0
		CONTINUE

	PRINTPLAINFORM [{LCOUNT, 2}] %TEXT_LJ(CALLNAME:LCOUNT, 16)%　総合{CALCF("何番目？", LCOUNT, SPERM_RANK:1, SPERM_RANK:2, SPERM_RANK:3, SPERM_RANK:4, SPERM_RANK:5)}位
	PRINTL 
	IF CALCF("膣内精液経験", LCOUNT, ARG)
		PRINTFORM 　膣内射精：{CALCF("膣内精液経験", LCOUNT, ARG), 6}ml　　 
		SIF GROUPMATCH(LCOUNT, SPERM_RANK_V:1, SPERM_RANK_V:2, SPERM_RANK_V:3, SPERM_RANK_V:4, SPERM_RANK_V:5)
			PRINTFORM 第{CALCF("何番目？", LCOUNT, SPERM_RANK_V:1, SPERM_RANK_V:2, SPERM_RANK_V:3, SPERM_RANK_V:4, SPERM_RANK_V:5)}位
		PRINTL 
	ENDIF

	IF CALCF("肛内精液経験", LCOUNT, ARG)
		PRINTFORM 　肛内射精：{CALCF("肛内精液経験", LCOUNT, ARG), 6}ml　　 
		SIF GROUPMATCH(LCOUNT, SPERM_RANK_A:1, SPERM_RANK_A:2, SPERM_RANK_A:3, SPERM_RANK_A:4, SPERM_RANK_A:5)
			PRINTFORM 第{CALCF("何番目？", LCOUNT, SPERM_RANK_A:1, SPERM_RANK_A:2, SPERM_RANK_A:3, SPERM_RANK_A:4, SPERM_RANK_A:5)}位
		PRINTL 
	ENDIF

	IF CALCF("精飲経験", LCOUNT, ARG)
		PRINTFORM 　口内射精：{CALCF("精飲経験", LCOUNT, ARG), 6}ml　　 
		SIF GROUPMATCH(LCOUNT, SPERM_RANK_M:1, SPERM_RANK_M:2, SPERM_RANK_M:3, SPERM_RANK_M:4, SPERM_RANK_M:5)
			PRINTFORM 第{CALCF("何番目？", LCOUNT, SPERM_RANK_M:1, SPERM_RANK_M:2, SPERM_RANK_M:3, SPERM_RANK_M:4, SPERM_RANK_M:5)}位
		PRINTL 
	ENDIF

	IF CALCF("乳内精液経験", LCOUNT, ARG)
		PRINTFORM 　乳内射精：{CALCF("乳内精液経験", LCOUNT, ARG), 6}ml　　 
		SIF GROUPMATCH(LCOUNT, SPERM_RANK_B:1, SPERM_RANK_B:2, SPERM_RANK_B:3, SPERM_RANK_B:4, SPERM_RANK_B:5)
			PRINTFORM 第{CALCF("何番目？", LCOUNT, SPERM_RANK_B:1, SPERM_RANK_B:2, SPERM_RANK_B:3, SPERM_RANK_B:4, SPERM_RANK_B:5)}位
		PRINTL 
	ENDIF

	IF CALCF("膀胱精液経験", LCOUNT, ARG)
		PRINTFORM 尿道内射精：{CALCF("膀胱精液経験", LCOUNT, ARG), 6}ml　　 
		SIF GROUPMATCH(LCOUNT, SPERM_RANK_U:1, SPERM_RANK_U:2, SPERM_RANK_U:3)
			PRINTFORM 第{CALCF("何番目？", LCOUNT, SPERM_RANK_U:1, SPERM_RANK_U:2, SPERM_RANK_U:3)}位
		PRINTL 
	ENDIF

	PRINTFORML 
	;次の表示があるかをチェック
	MEMO_LINECOUNT = LINECOUNT
NEXT

SIF LINECOUNT == MEMO_LINECOUNT
	CLEARLINE 1

;その他色々な補足の表示
;とりあえずは中出され履歴と中出し履歴か
@PRINT_OTHER, ARG
#DIM LCOUNT
#DIM MEMO_LINECOUNT
#DIM DYNAMIC SPERM_TOTAL, 100
#DIM DYNAMIC SPERM_RANK, 10
#DIM SPERM_RANK_V, 10
#DIM SPERM_RANK_A, 10
#DIM SPERM_RANK_M, 10
#DIM SPERM_RANK_B, 10
#DIM SPERM_RANK_U, 10

VARSET SPERM_RANK_V, -1
VARSET SPERM_RANK_A, -1
VARSET SPERM_RANK_M, -1
VARSET SPERM_RANK_B, -1
VARSET SPERM_RANK_U, -1

;中出され履歴の有無チェック
SIF CSTR:ARG:11 == "" && CSTR:ARG:12 == "" && CSTR:ARG:13 == "" && CSTR:ARG:14 == "" && CSTR:ARG:15 == ""
	RETURN 0
CALL DRAWLINES, "□ 搾精ランキング □", "搾精ランキング"

SIF CONFIG("項目：搾精ランキング")
	RETURN 0

;SPERM_TOTAL		LCOUNT番のキャラの総中出し量
;SPERM_RANK		SPERM_TOTALのランキング。上位３人まで表示
;SPERM_RANK_(V, A, M, B, U)	各場所の中出しランキング。上位３人まで記録

FOR LCOUNT, 1, CHARANUM
	SPERM_TOTAL:LCOUNT = CALCF("膣内精液経験", ARG, LCOUNT)
	;順位の変動
	SELECTCASE CALCF("膣内精液経験", ARG, LCOUNT)
	CASE IS > CALCF("膣内精液経験", ARG, SPERM_RANK_V:1)
		SPERM_RANK_V:3 = SPERM_RANK_V:2
		SPERM_RANK_V:2 = SPERM_RANK_V:1
		SPERM_RANK_V:1 = LCOUNT
	CASE IS > CALCF("膣内精液経験", ARG, SPERM_RANK_V:2)
		SPERM_RANK_V:3 = SPERM_RANK_V:2
		SPERM_RANK_V:2 = LCOUNT
	CASE IS > CALCF("膣内精液経験", ARG, SPERM_RANK_V:3)
		SPERM_RANK_V:3 = LCOUNT
	ENDSELECT

	SPERM_TOTAL:LCOUNT += CALCF("肛内精液経験", ARG, LCOUNT)
	;順位の変動
	SELECTCASE CALCF("肛内精液経験", ARG, LCOUNT)
	CASE IS > CALCF("肛内精液経験", ARG, SPERM_RANK_A:1)
		SPERM_RANK_A:3 = SPERM_RANK_A:2
		SPERM_RANK_A:2 = SPERM_RANK_A:1
		SPERM_RANK_A:1 = LCOUNT
	CASE IS > CALCF("肛内精液経験", ARG, SPERM_RANK_A:2)
		SPERM_RANK_A:3 = SPERM_RANK_A:2
		SPERM_RANK_A:2 = LCOUNT
	CASE IS > CALCF("肛内精液経験", ARG, SPERM_RANK_A:3)
		SPERM_RANK_A:3 = LCOUNT
	ENDSELECT

	SPERM_TOTAL:LCOUNT += CALCF("精飲経験", ARG, LCOUNT)
	;順位の変動
	SELECTCASE CALCF("精飲経験", ARG, LCOUNT)
	CASE IS > CALCF("精飲経験", ARG, SPERM_RANK_M:1)
		SPERM_RANK_M:3 = SPERM_RANK_M:2
		SPERM_RANK_M:2 = SPERM_RANK_M:1
		SPERM_RANK_M:1 = LCOUNT
	CASE IS > CALCF("精飲経験", ARG, SPERM_RANK_M:2)
		SPERM_RANK_M:3 = SPERM_RANK_M:2
		SPERM_RANK_M:2 = LCOUNT
	CASE IS > CALCF("精飲経験", ARG, SPERM_RANK_M:3)
		SPERM_RANK_M:3 = LCOUNT
	ENDSELECT

	SPERM_TOTAL:LCOUNT += CALCF("乳内精液経験", ARG, LCOUNT)
	;順位の変動
	SELECTCASE CALCF("乳内精液経験", ARG, LCOUNT)
	CASE IS > CALCF("乳内精液経験", ARG, SPERM_RANK_B:1)
		SPERM_RANK_B:3 = SPERM_RANK_B:2
		SPERM_RANK_B:2 = SPERM_RANK_B:1
		SPERM_RANK_B:1 = LCOUNT
	CASE IS > CALCF("乳内精液経験", ARG, SPERM_RANK_B:2)
		SPERM_RANK_B:3 = SPERM_RANK_B:2
		SPERM_RANK_B:2 = LCOUNT
	CASE IS > CALCF("乳内精液経験", ARG, SPERM_RANK_B:3)
		SPERM_RANK_B:3 = LCOUNT
	ENDSELECT

	SPERM_TOTAL:LCOUNT += CALCF("膀胱精液経験", ARG, LCOUNT)
	;順位の変動
	SELECTCASE CALCF("膀胱精液経験", ARG, LCOUNT)
	CASE IS > CALCF("膀胱精液経験", ARG, SPERM_RANK_U:1)
		SPERM_RANK_U:3 = SPERM_RANK_U:2
		SPERM_RANK_U:2 = SPERM_RANK_U:1
		SPERM_RANK_U:1 = LCOUNT
	CASE IS > CALCF("膀胱精液経験", ARG, SPERM_RANK_U:2)
		SPERM_RANK_U:3 = SPERM_RANK_U:2
		SPERM_RANK_U:2 = LCOUNT
	CASE IS > CALCF("膀胱精液経験", ARG, SPERM_RANK_U:3)
		SPERM_RANK_U:3 = LCOUNT
	ENDSELECT

	;総合順位の変動
	SELECTCASE SPERM_TOTAL:LCOUNT
	CASE IS > SPERM_TOTAL:(SPERM_RANK:1)
		SPERM_RANK:3 = SPERM_RANK:2
		SPERM_RANK:2 = SPERM_RANK:1
		SPERM_RANK:1 = LCOUNT
	CASE IS > SPERM_TOTAL:(SPERM_RANK:2)
		SPERM_RANK:3 = SPERM_RANK:2
		SPERM_RANK:2 = LCOUNT
	CASE IS > SPERM_TOTAL:(SPERM_RANK:3)
		SPERM_RANK:3 = LCOUNT
	ENDSELECT
NEXT

;結果発表
FOR LCOUNT, 1, CHARANUM
	;ＴＯＰ３入りのみ表示
	SIF GROUPMATCH(LCOUNT, SPERM_RANK:1, SPERM_RANK:2, SPERM_RANK:3) == 0
		CONTINUE

	PRINTPLAINFORM [{LCOUNT, 2}] %TEXT_LJ(CALLNAME:LCOUNT, 16)%　総合{CALCF("何番目？", LCOUNT, SPERM_RANK:1, SPERM_RANK:2, SPERM_RANK:3)}位
	PRINTL 
	IF CALCF("膣内精液経験", ARG, LCOUNT)
		PRINTFORM 　膣内射精：{CALCF("膣内精液経験", ARG, LCOUNT), 6}ml　　 
		SIF GROUPMATCH(LCOUNT, SPERM_RANK_V:1, SPERM_RANK_V:2, SPERM_RANK_V:3)
			PRINTFORM 第{CALCF("何番目？", LCOUNT, SPERM_RANK_V:1, SPERM_RANK_V:2, SPERM_RANK_V:3)}位
		PRINTL 
	ENDIF

	IF CALCF("肛内精液経験", ARG, LCOUNT)
		PRINTFORM 　肛内射精：{CALCF("肛内精液経験", ARG, LCOUNT), 6}ml　　 
		SIF GROUPMATCH(LCOUNT, SPERM_RANK_A:1, SPERM_RANK_A:2, SPERM_RANK_A:3)
			PRINTFORM 第{CALCF("何番目？", LCOUNT, SPERM_RANK_A:1, SPERM_RANK_A:2, SPERM_RANK_A:3)}位
		PRINTL 
	ENDIF

	IF CALCF("精飲経験", ARG, LCOUNT)
		PRINTFORM 　口内射精：{CALCF("精飲経験", ARG, LCOUNT), 6}ml　　 
		SIF GROUPMATCH(LCOUNT, SPERM_RANK_M:1, SPERM_RANK_M:2, SPERM_RANK_M:3)
			PRINTFORM 第{CALCF("何番目？", LCOUNT, SPERM_RANK_M:1, SPERM_RANK_M:2, SPERM_RANK_M:3)}位
		PRINTL 
	ENDIF

	IF CALCF("乳内精液経験", ARG, LCOUNT)
		PRINTFORM 　乳内射精：{CALCF("乳内精液経験", ARG, LCOUNT), 6}ml　　 
		SIF GROUPMATCH(LCOUNT, SPERM_RANK_B:1, SPERM_RANK_B:2, SPERM_RANK_B:3)
			PRINTFORM 第{CALCF("何番目？", LCOUNT, SPERM_RANK_B:1, SPERM_RANK_B:2, SPERM_RANK_B:3)}位
		PRINTL 
	ENDIF

	IF CALCF("膀胱精液経験", ARG, LCOUNT)
		PRINTFORM 尿道内射精：{CALCF("膀胱精液経験", ARG, LCOUNT), 6}ml　　 
		SIF GROUPMATCH(LCOUNT, SPERM_RANK_U:1, SPERM_RANK_U:2, SPERM_RANK_U:3)
			PRINTFORM 第{CALCF("何番目？", LCOUNT, SPERM_RANK_U:1, SPERM_RANK_U:2, SPERM_RANK_U:3)}位
		PRINTL 
	ENDIF

	PRINTFORML 
	;次の表示があるかをチェック
	MEMO_LINECOUNT = LINECOUNT
NEXT

;以下一般人とドラゴンと触手
IF CALCF("膣内精液経験", ARG, -4) + CALCF("肛内精液経験", ARG, -4) + CALCF("精飲経験", ARG, -4) + CALCF("乳内精液経験", ARG, -4) + CALCF("膀胱精液経験", ARG, -4)
	PRINTFORML [×] 一般人
	SIF CALCF("膣内精液経験", ARG, -4)
		PRINTFORML 　膣内射精：{CALCF("膣内精液経験", ARG, -4), 6}ml　
	SIF CALCF("肛内精液経験", ARG, -4)
		PRINTFORML 　肛内射精：{CALCF("肛内精液経験", ARG, -4), 6}ml　
	SIF CALCF("精飲経験", ARG, -4)
		PRINTFORML 　口内射精：{CALCF("精飲経験", ARG, -4), 6}ml　
	SIF CALCF("乳内精液経験", ARG, -4)
		PRINTFORML 　乳内射精：{CALCF("乳内精液経験", ARG, -4), 6}ml　
	SIF CALCF("膀胱精液経験", ARG, -4)
		PRINTFORML 尿道内射精：{CALCF("膀胱精液経験", ARG, -4), 6}ml　
	PRINTFORML 
	;次の表示があるかをチェック
	MEMO_LINECOUNT = LINECOUNT
ENDIF
IF CALCF("膣内精液経験", ARG, -3) + CALCF("肛内精液経験", ARG, -3) + CALCF("精飲経験", ARG, -3) + CALCF("乳内精液経験", ARG, -3) + CALCF("膀胱精液経験", ARG, -3)
	PRINTFORML [×] ドラゴン
	SIF CALCF("膣内精液経験", ARG, -3)
		PRINTFORML 　膣内射精：{CALCF("膣内精液経験", ARG, -3), 6}ml　
	SIF CALCF("肛内精液経験", ARG, -3)
		PRINTFORML 　肛内射精：{CALCF("肛内精液経験", ARG, -3), 6}ml　
	SIF CALCF("精飲経験", ARG, -3)
		PRINTFORML 　口内射精：{CALCF("精飲経験", ARG, -3), 6}ml　
	SIF CALCF("乳内精液経験", ARG, -3)
		PRINTFORML 　乳内射精：{CALCF("乳内精液経験", ARG, -3), 6}ml　
	SIF CALCF("膀胱精液経験", ARG, -3)
		PRINTFORML 尿道内射精：{CALCF("膀胱精液経験", ARG, -3), 6}ml　
	PRINTFORML 
	;次の表示があるかをチェック
	MEMO_LINECOUNT = LINECOUNT
ENDIF
IF CALCF("膣内精液経験", ARG, -5) + CALCF("肛内精液経験", ARG, -5) + CALCF("精飲経験", ARG, -5) + CALCF("乳内精液経験", ARG, -5) + CALCF("膀胱精液経験", ARG, -5)
	PRINTFORML [×] 触手
	SIF CALCF("膣内精液経験", ARG, -5)
		PRINTFORML 　膣内射精：{CALCF("膣内精液経験", ARG, -5), 6}ml　
	SIF CALCF("肛内精液経験", ARG, -5)
		PRINTFORML 　肛内射精：{CALCF("肛内精液経験", ARG, -5), 6}ml　
	SIF CALCF("精飲経験", ARG, -5)
		PRINTFORML 　口内射精：{CALCF("精飲経験", ARG, -5), 6}ml　
	SIF CALCF("乳内精液経験", ARG, -5)
		PRINTFORML 　乳内射精：{CALCF("乳内精液経験", ARG, -5), 6}ml　
	SIF CALCF("膀胱精液経験", ARG, -5)
		PRINTFORML 尿道内射精：{CALCF("膀胱精液経験", ARG, -5), 6}ml　
	PRINTFORML 
	;次の表示があるかをチェック
	MEMO_LINECOUNT = LINECOUNT
ENDIF

SIF LINECOUNT == MEMO_LINECOUNT
	CLEARLINE 1


@PRINT_INDICATE, ARG
SIF ABL:ARG:助手 == 0 || ARG == MASTER
	RETURN 0

LOCALS = □ %TEXTS("助手の名称")%のお仕事指示 □
CALL DRAWLINES, LOCALS, "助手のお仕事指示"

SIF CONFIG("項目：助手のお仕事指示")
	RETURN 0

CALL ASSI_LIST_INDICATE, ARG
PRINTL 

@PRINT_ANALYSIS, ARG
SIF ARG == MASTER
	RETURN 0
SWAP ARG, TARGET

CALL ANALYSIS_CALC

CALL DRAWLINES, "□ アナライズ □"

TCVAR:27 = 0
CALL COM_ORDER, 1

LOCAL = RESULT

IF EXP:调教次数 == 0
	CALL SHOW_DIFFICULTY
	PRINTL 
ENDIF
PRINTFORML 調教実行値補正:\@ LOCAL ? {LOCAL} # なし \@

CALL ANALYSIS_CALC_SB

VARSET SOURCE
VARSET CUP

FLAG:8 = 1
SWAP ARG, TARGET

@PRINT_VIDEO, ARG
#DIM LCOUNT
SIF CFLAG:ARG:60 == 0
	RETURN 0

CALL DRAWLINES, "□ 出演作品詳細(タイトル表示は最新10本のみ) □", "出演作品詳細"

SIF CONFIG("項目：出演作品詳細")
	RETURN 0

VARSET LOCALS
SPLIT CSTR:ARG:80, "/", LOCALS
FOR LCOUNT, 0, 10
	SIF LOCALS:LCOUNT == ""
		BREAK
	PRINTFORML %LOCALS:LCOUNT%
NEXT
PRINTL 
PRINTFORML 　　総作品数：{CFLAG:ARG:60, 2}本　歴代最高価格：%MONEY_C(CFLAG:ARG:61)%
;PRINTFORML 　　平均価格：%MONEY_C(CFLAG:ARG:62 / CFLAG:ARG:60)%
;SIF CFLAG:ARG:63
;	PRINTFORML 直近三本平均：%MONEY_C( (CFLAG:ARG:63 + CFLAG:ARG:64 + CFLAG:ARG:65)/3)%

@PRINT_MIDASHINAMI, ARG
#DIM LCOUNT
SIF CFLAG:ARG:368 == 0
	RETURN 0
IF ARG == MASTER
	CALL DRAWLINES, "□ 身嗜み □", "身嗜み"
ELSE
	CALL DRAWLINES, "□ 身嗜み指示 □", "身嗜み"
ENDIF

SIF CONFIG("項目：身嗜み")
	RETURN 0

SELECTCASE COND("身嗜み：陰毛", ARG)
CASE 3
	PRINTFORML ・陰毛を常にツルツルに保つ
CASE 5
	PRINTFORML ・陰毛を常に整える
CASE 7
	PRINTFORML ・陰毛を剃らない
ENDSELECT

SELECTCASE COND("身嗜み：腋毛", ARG)
CASE 3
	PRINTFORML ・%TEXTS("腋")%毛を常にツルツルに保つ
CASE 7
	PRINTFORML ・%TEXTS("腋")%毛を剃らない
ENDSELECT

SELECTCASE COND("身嗜み：Ｖ拡張", ARG)
CASE 1
	PRINTFORML ・膣に常にバイブを挿入
CASE 2
	PRINTFORML ・膣に常に大きめのバイブを挿入
CASE 3
	PRINTFORML ・膣に常に極太サイズのバイブを挿入
CASE 4
	PRINTFORML ・膣に常にバルーン型のバイブを挿入
ENDSELECT

SELECTCASE COND("身嗜み：Ａ拡張", ARG)
CASE 1
	PRINTFORML ・アナルに常にアナルプラグを挿入
CASE 2
	PRINTFORML ・アナルに常に大きめのアナルプラグを挿入
CASE 3
	PRINTFORML ・アナルに常に極太サイズのアナルプラグを挿入
CASE 4
	PRINTFORML ・アナルに常にバルーン型のアナルプラグを挿入
ENDSELECT

SELECTCASE COND("身嗜み：Ａ準備", ARG)
CASE 1
	PRINTFORML ・調教前に腸内を綺麗にする
CASE 2
	PRINTFORML ・調教前にアナルにローションを馴染ませる
CASE 3
	PRINTFORML ・調教前に腸内洗浄＆ローション準備
ENDSELECT

SELECTCASE COND("身嗜み：Ｐ準備", ARG)
CASE 1
	PRINTFORML ・ペニスの恥垢はそのままにしておく
ENDSELECT

SELECTCASE COND("身嗜み：Ｖ準備", ARG)
CASE 1
	PRINTFORML ・調教前の入浴は控える
ENDSELECT

SELECTCASE COND("身嗜み：服装", ARG)
CASE 1
	PRINTFORML ・パンツは穿かない
ENDSELECT

SELECTCASE COND("身嗜み：尿道拡張", ARG)
CASE 1
	PRINTFORML ・尿道に常にビーズ型のブジーを挿入
ENDSELECT

SELECTCASE COND("身嗜み：性行為の制限", ARG)
CASE 1
	PRINTFORML ・前の穴を使っての性行為は%CALLNAME:MASTER%とだけ
CASE 2
	PRINTFORML ・アナルを使っての性行為は%CALLNAME:MASTER%とだけ
CASE 3
	PRINTFORML ・口を使っての奉仕は%CALLNAME:MASTER%にだけ
CASE 4
	PRINTFORML ・キスは%CALLNAME:MASTER%とだけ
CASE 5
	PRINTFORML ・ペニスを使っての性行為は%CALLNAME:MASTER%とだけ
CASE 100
	PRINTFORML ・%CALLNAME:ARG%は%CALLNAME:MASTER%のもの
CASE IS > 0
	VARSET LOCALS
	LOCALS = %LOCALS%\@ COND("身嗜み：Ｖ独占", ARG) ? アソコと # \@
	LOCALS = %LOCALS%\@ COND("身嗜み：Ａ独占", ARG) ? アナルと # \@
	LOCALS = %LOCALS%\@ COND("身嗜み：口独占", ARG) ? 口での奉仕と # \@
	LOCALS = %LOCALS%\@ COND("身嗜み：キス独占", ARG) ? キスと # \@
	LOCALS = %LOCALS%\@ COND("身嗜み：Ｐ独占", ARG) ? 肉棒と # \@
	PRINTFORML ・%SUBSTRING(LOCALS, 0, STRLENS(LOCALS) - 2)%を用いた行為は%CALLNAME:MASTER%とだけ
ENDSELECT

;SELECTCASE COND("身嗜み：Ｖ準備", ARG)
;CASE 1
;	PRINTFORML ・いつもアソコを綺麗にする
;CASE 2
;	PRINTFORML ・調教前にアソコにローションを馴染ませる
;CASE 3
;	PRINTFORML ・いつもアソコ綺麗にさせる＆ローション準備
;ENDSELECT

@PRINT_COS, ARG
#DIM LCOUNT
SIF ARG == MASTER
	RETURN 0

CALL DRAWLINES, "□ 服装詳細 □", "服装詳細"

SIF CONFIG("項目：服装詳細")
	RETURN 0

SIF EQUIP:ARG:上着
	PRINTFORML 　Ｅ：[%SHIRT(ARG)%\@ CHECK_SHIRT("スカート着用", ARG) && EQUIP:ARG:スカート == 0 ? (スカートなし) # \@]
IF EQUIP:ARG:ボディスーツ
	PRINTFORM 　Ｅ：[%BODYS(ARG)%
	IF CHECK_BODYS("ファスナー", ARG)
		PRINT (ファスナー付)
	ELSEIF CHECK_BODYS("ＶＡ露出", ARG)
		PRINT (穴開き)
	ELSEIF CHECK_BODYS("Ａ露出", ARG)
		PRINT (Ａ穴開き)
	ELSEIF CHECK_BODYS("Ｖ露出", ARG)
		PRINT (Ｖ穴開き)
	ENDIF
	PRINTL ]
ENDIF
SIF EQUIP:ARG:ブラ
	PRINTFORML 　Ｅ：[%BRA(ARG)%]
IF EQUIP:ARG:アウター
	PRINTFORM 　Ｅ：[%OUTER(ARG)%
	IF CHECK_OUTER("ファスナー", ARG)
		PRINT (ファスナー付)
	ELSEIF CHECK_OUTER("スリット", ARG)
		PRINT (スリット有り)
	ELSEIF CHECK_OUTER("ＶＡ露出", ARG)
		PRINT (穴開き)
	ELSEIF CHECK_OUTER("Ａ露出", ARG)
		PRINT (Ａ穴開き)
	ELSEIF CHECK_OUTER("Ｖ露出", ARG)
		PRINT (Ｖ穴開き)
	ENDIF
	PRINTL ]
ENDIF
IF EQUIP:ARG:パンツ
	PRINTFORM 　Ｅ：[%PANTIES(ARG)%
	IF CHECK_PANTIES("ファスナー", ARG)
		PRINT (ファスナー付)
	ELSEIF CHECK_PANTIES("ＶＡ露出", ARG)
		PRINT (穴開き)
	ELSEIF CHECK_PANTIES("Ａ露出", ARG)
		PRINT (Ａ穴開き)
	ELSEIF CHECK_PANTIES("Ｖ露出", ARG)
		PRINT (Ｖ穴開き)
	ENDIF
	PRINTL ]
ENDIF
SIF EQUIP:ARG:靴下
	PRINTFORML 　Ｅ：[%SOCKS(ARG)%]
SIF EQUIP:ARG:靴
	PRINTFORML 　Ｅ：[%SHOES(ARG)%]
SIF EQUIP:ARG:手袋
	PRINTFORML 　Ｅ：[%GLOVE(ARG)%]
IF EQUIP:ARG:アクセサリ
	SPLIT CSTR:ARG:49, "/", LOCALS
	FOR LCOUNT, 0, 4
		SIF LOCALS:LCOUNT != ""
			PRINTFORML 　Ｅ：[%LOCALS:LCOUNT%]
	NEXT
ENDIF
IF TALENT:ARG:阴蒂穿环
	PRINTFORM 　Ｅ：[\@ PENIS(TARGET) ? ペニ # クリ \@ピアス
	IF CEVENTS("クリピアス", ARG) != ""
		SETCOLOR DEF_COLOR("黄色")
		PRINTFORM (%CEVENTS("クリピアス", ARG)%)
		RESETCOLOR
	ENDIF
	PRINTFORML ]
ENDIF
IF TALENT:ARG:阴唇穿环
	PRINTFORM 　Ｅ：[ラビアピアス
	IF CEVENTS("ラビアピアス", ARG) != ""
		SETCOLOR DEF_COLOR("黄色")
		PRINTFORM (%CEVENTS("ラビアピアス", ARG)%)
		RESETCOLOR
	ENDIF
	PRINTFORML ]
ENDIF
IF TALENT:ARG:乳头穿环
	PRINTFORM 　Ｅ：[ニプルピアス
	IF CEVENTS("ニプルピアス", ARG) != ""
		SETCOLOR DEF_COLOR("黄色")
		PRINTFORM (%CEVENTS("ニプルピアス", ARG)%)
		RESETCOLOR
	ENDIF
	PRINTFORML ]
ENDIF
IF TALENT:ARG:肚脐穿环
	PRINTFORM 　Ｅ：[へそピアス
	IF CEVENTS("へそピアス", ARG) != ""
		SETCOLOR DEF_COLOR("黄色")
		PRINTFORM (%CEVENTS("へそピアス", ARG)%)
		RESETCOLOR
	ENDIF
	PRINTFORML ]
ENDIF

;IF TALENT:ARG:日常按摩棒
;	LOCALS = 
;	SELECTCASE COND("身嗜み：Ｖ拡張", ARG)
;	CASE 2
;		LOCALS = (大)
;	CASE 3
;		LOCALS = (極太)
;	CASE 4
;		LOCALS = (バルーンタイプ)
;	ENDSELECT
;	PRINTFORML 　Ｅ：[バイブ%LOCALS%]
;ENDIF
;IF TALENT:ARG:日常Ａ按摩棒
;	LOCALS = 
;	SELECTCASE COND("身嗜み：Ａ拡張", ARG)
;	CASE 2
;		LOCALS = (大)
;	CASE 3
;		LOCALS = (極太)
;	CASE 4
;		LOCALS = (バルーンタイプ)
;	ENDSELECT
;	PRINTFORML 　Ｅ：[アナルプラグ%LOCALS%]
;ENDIF

LOCALS = 
IF CHECK_CLO("ハダカ", ARG)
	LOCALS = ハダカ
ELSE
	IF CHECK_CLO("ボトムレス", ARG)
		LOCALS = 下半身露出
	ELSEIF CHECK_CLO("トップレス", ARG)
		IF TALENT:ARG:男性
			LOCALS = 上半身露出
		ELSE
 			LOCALS = おっぱい露出
		ENDIF
	ELSEIF CHECK_CLO("Ｖ露出", ARG) && CHECK_CLO("Ａ露出", ARG) && CHECK_CLO("乳首露出", ARG)
		LOCALS = 大事な場所だけ露出
	ELSEIF CHECK_CLO("ノーパン", ARG)
		LOCALS = ノーパン
	ENDIF
ENDIF

SIF STRLENS(LOCALS)
	PRINTFORML 備考：%LOCALS%

;3サイズ
@NEW_PRINT_3SIZE, ARG, ARGS
SIF CONFIG("３サイズ：表示") == 0
	RETURN 0
SELECTCASE ARGS
CASE "一覧表示"
	IF BASE:ARG:身長 == 0 || (TALENT:ARG:男性 && COND("男の娘", ARG) == 0)
		PRINTL 
		RETURN 0
	ENDIF
	IF TALENT:ARG:拉弥亚
		PRINTFORM {BASE:ARG:身長 + BASE:ARG:身長の追加要素, 3}cm
	ELSE
		PRINTFORM {BASE:ARG:身長, 3}cm
	ENDIF
	
	LOCALS = (%CONDS("バストカップ", ARG)%)
	PRINTFORM  {COND("バスト", ARG), 3}%TEXT_RJ(LOCALS, 5)%-{BASE:ARG:ウェスト, 3} -{BASE:ARG:ヒップ, 3}
	;LOCALS = (%CONDS("ヒップサイズ", ARG)%)
	;PRINTFORM  %TEXT_RJ(LOCALS, 4)%
	IF TALENT:ARG:男性
		PRINTFORM (--) 
	ELSEIF TALENT:ARG:大臀 >= 3
		PRINTFORM (超) 
	ELSEIF TALENT:ARG:大臀 == 2
		PRINTFORM (爆) 
	ELSEIF TALENT:ARG:大臀
		PRINTFORM (巨) 
	ELSEIF TALENT:ARG:小臀
		PRINTFORM (小) 
	ELSE
		PRINTFORM (並) 
	ENDIF
	;陰毛の状態
	IF CONFIG("陰毛と腋毛")
		IF BASE:ARG:陰毛 == 0
			PRINTFORM ---------- 
		ELSE
			PRINTFORM %TEXT_RJ(CONDS("陰毛", ARG), 10)% 
		ENDIF
	ENDIF
	PRINTFORM %CONDS("体型", ARG)%

CASE "個別表示"
	SIF BASE:ARG:身長 == 0 || (TALENT:ARG:男性 && COND("男の娘", ARG) == 0)
		RETURN 0
	LOCALS = □ 体型:%CONDS("体型", ARG)% □
	CALL DRAWLINES, LOCALS, "体型"

	SIF CONFIG("項目：体型")
		RETURN 0

	IF TALENT:ARG:拉弥亚
		PRINTFORM 体長 {BASE:ARG:身長 + BASE:ARG:身長の追加要素}cm　
	ELSE
		PRINTFORM 身長 {BASE:ARG:身長}cm　
	ENDIF
	PRINTFORM バスト {COND("バスト", ARG)}cm (%CONDS("バストカップ", ARG)%カップ)　ウェスト {BASE:ARG:ウェスト}cm　ヒップ {BASE:ARG:ヒップ}cm 
	;SIF CONDS("お尻", ARG) != ""
	;	PRINTFORM （%CONDS("お尻", ARG)%）
	IF TALENT:ARG:男性
	;	PRINTFORM (--) 
	ELSEIF TALENT:ARG:大臀 >= 3
		PRINTFORM (超) 
	ELSEIF TALENT:ARG:大臀 == 2
		PRINTFORM (爆) 
	ELSEIF TALENT:ARG:大臀
		PRINTFORM (巨) 
	ELSEIF TALENT:ARG:小臀
		PRINTFORM (小) 
	ELSE
		PRINTFORM (並) 
	ENDIF
ENDSELECT
PRINTL 

;属性
@NEW_PRINT_ZOKUSEI, ARG, ARG:1
#DIM LCOUNT

VARSET LOCAL
SELECTCASE ARG
CASE MASTER
	IF TALENT:MASTER:性癖
		CALL DRAWLINES, "□ 性癖 □", "性癖"

		IF CONFIG("項目：性癖") == 0
			FOR LCOUNT, 0, NUM("属性")
				SIF GETBIT(TALENT:MASTER:性癖, LCOUNT) == 0
					CONTINUE

				LOCALS = %NAMES("属性", LCOUNT)%
				LOCAL += STRLENS(LOCALS)
				IF LOCAL > NUM("折り返し文字数")
					PRINTL 
					LOCAL = STRLENS(LOCALS)
				ENDIF
				PRINTFORM %LOCALS%
			NEXT
			PRINTL 
		ENDIF
	ENDIF
	IF TALENT:MASTER:弱点
		CALL DRAWLINES, "□ 弱点 □", "弱点"

		IF CONFIG("項目：弱点") == 0
			IF NUM_BIT(TALENT:MASTER:弱点) == NUM("弱点")
				PRINT [全てに弱い] 
			ELSE
				FOR LCOUNT, 0, NUM("弱点")
					SIF GETBIT(TALENT:MASTER:弱点, LCOUNT) == 0
						CONTINUE

					LOCALS = %NAMES("弱点", LCOUNT)%
					LOCAL += STRLENS(LOCALS)
					IF LOCAL > NUM("折り返し文字数")
						PRINTL 
						LOCAL = STRLENS(LOCALS)
					ENDIF
					PRINTFORM %LOCALS%
				NEXT
			ENDIF
			PRINTL 
		ENDIF
	ENDIF
ENDSELECT

;主人でも表示してみる
;SIF BASE:ARG:属性 == 0 || (ARG == MASTER && TALENT:ARG:男性)
SIF BASE:ARG:属性 == 0
	RETURN 0

CALL DRAWLINES, "□ 属性 □", "属性"

SIF CONFIG("項目：属性")
	RETURN 0

VARSET LOCAL
FOR LCOUNT, 0, NUM("属性")
	SIF GETBIT(BASE:ARG:属性, LCOUNT) == 0
		CONTINUE

	SIF GETBIT(TALENT:MASTER:性癖, LCOUNT)
		SETCOLOR DEF_COLOR("イエロー")
	LOCALS = %NAMES("属性", LCOUNT)%
	LOCAL += STRLENS(LOCALS)
	IF LOCAL > NUM("折り返し文字数")
		PRINTL 
		LOCAL = STRLENS(LOCALS)
	ENDIF
	PRINTFORM %LOCALS%
	RESETCOLOR
NEXT
PRINTL 

;宝珠
@NEW_PRINT_JUEL, ARG
#DIM LCOUNT
;改行するかの判定に使う
#DIM NEXT_LINE

;表示順の設定
; 0,　快Ｃ　  1,　快Ｖ　  2,　快Ａ　 14,　快Ｂ
;15,　快Ｍ　  5,　欲情　  4,　恭順　  6,　屈服
; 7,　習得　  8,　恥情　  9,　苦痛　 10,　恐怖
;11,　反感
SIF ARG == MASTER
	RETURN 0

CALL DRAWLINES, "□ 宝珠 □", "宝珠"

SIF CONFIG("項目：宝珠")
	RETURN 0

NEXT_LINE = 0
FOR LCOUNT, 0, 13
	SELECTCASE LCOUNT
	CASE 0
		LOCAL = 0
	CASE 1
		LOCAL = 1
	CASE 2
		LOCAL = 2
	CASE 3
		LOCAL = 14
	CASE 4
		LOCAL = 15
	CASE 5
		LOCAL = 5
	CASE 6
		LOCAL = 4
	CASE 7
		LOCAL = 6
	CASE 8
		LOCAL = 7
	CASE 9
		LOCAL = 8
	CASE 10
		LOCAL = 9
	CASE 11
		LOCAL = 10
	CASE 12
		SIF JUEL:ARG:反感 == 0
			CONTINUE
		LOCAL = 11
	ENDSELECT

	PRINTFORM %PALAMNAME:LOCAL%:%PALAM_NUM(JUEL:ARG:LOCAL)%　
	NEXT_LINE += 1
	SIF NEXT_LINE % 6 == 0
		PRINTL 
NEXT
;最後のループで改行してなかったら改行
SIF NEXT_LINE % 6
	PRINTL 

RETURN 0

;経験
@NEW_PRINT_EXP, ARG
#DIM LCOUNT
#DIM LCOUNT2
;改行するかの判定に使う
#DIM NEXT_LINE

CALL DRAWLINES, "□ 経験 □", "経験"

SIF CONFIG("項目：経験")
	RETURN 0

;表示順の設定
LOCALS = 
LOCALS += "　　　　　Ｖ経験/　　　Ｖ性交経験/　　　Ｖ拡張経験/　Ｖフィスト経験/"
LOCALS += "　　　　　Ａ経験/　　　Ａ性交経験/　　　Ａ拡張経験/　Ａフィスト経験/"
LOCALS += "　　　　子宮経験/　　　子宮姦経験/　　　　絶頂経験/　　　　射精経験/"
LOCALS += "　　　　精液経験/　　膣内精液経験/　　肛内精液経験/　　　　精飲経験/"
LOCALS += "　　　　自慰経験/　　　Ｖ挿入経験/　　　Ａ挿入経験/　　　喉性交経験/"
;[オトコ]なら40,レズ経験のかわりに41,BL経験を表示
IF TALENT:ARG:男性
	LOCALS += "　　　　ＢＬ経験/　　　　露出経験/　　　　浣腸経験/　　　　ＳＭ経験/"
ELSE
	LOCALS += "　　　　レズ経験/　　　　露出経験/　　　　浣腸経験/　　　　ＳＭ経験/"
ENDIF
LOCALS += "　　　　撮影経験/　　お漏らし経験/　　　　聖水経験/　　　　緊縛経験/"
LOCALS += "　　　　飲尿経験/　　膣内浴尿経験/　　子宮浴尿経験/　　温泉浣腸経験/"
LOCALS += "　　　　キス経験/　　　フェラ経験/　　　　手淫経験/　　　足コキ経験/"
LOCALS += "　　　腰使い経験/　　パイズリ経験/　　　Ａ責め経験/　　　クンニ経験/"
LOCALS += "　　　Ａ舐め経験/お掃除フェラ経験/お掃除クンニ経験/お掃除Ａ舐め経験/"
LOCALS += "　　奉仕快楽経験/　　嗜虐快楽経験/　　被虐快楽経験/　　羞恥快楽経験/"
LOCALS += "　　処女簒奪経験/　　童貞狩り経験/　　スライム経験/　　　　触手経験/"
LOCALS += "　　　Ｂ性交経験/　　　Ｂ挿入経験/　　乳内精液経験/　　　　噴乳経験/"
LOCALS += "　　　Ｖ竜姦経験/　　　Ａ竜姦経験/　　尿道責め経験/　　　　尿道経験/"
LOCALS += "　　尿道拡張経験/　　尿道性交経験/　　尿道挿入経験/　　膀胱精液経験/"
LOCALS += "　　　　輸尿経験/　　　　歌唱経験/　　　Ｖ損傷経験/　　　Ａ損傷経験/"


SPLIT LOCALS, "/", LOCALS

;一手間多いが上の表の見やすさのためにあえてめんどい事をやる
FOR LCOUNT, 0, 100
	FOR LCOUNT2, 0, 7
		SIF SUBSTRING(LOCALS:LCOUNT, 0, 2) != "　"
			BREAK
		LOCALS:LCOUNT = %SUBSTRING(LOCALS:LCOUNT, 2, -1)%
	NEXT
NEXT

NEXT_LINE = 0
FOR LCOUNT, 0, 100
	LOCAL = GETNUM(EXP, LOCALS:LCOUNT)

	IF LOCAL < 0
		BREAK
	ELSEIF EXP:ARG:LOCAL >= 1
		IF STRLENS(EXPNAME:LOCAL) >= 14
			PRINTFORM %TEXT_RJ(SUBSTRING(EXPNAME:LOCAL, 0, STRLENS(EXPNAME:LOCAL) - 4), 13)%:
		ELSE
			PRINTFORM %TEXT_RJ(EXPNAME:LOCAL, 13)%:
		ENDIF

		;今回調教で得た経験は色を変えるテスト
		SIF COND("調教中") && EXP_GAIN(LOCAL, ARG)
			SETCOLOR DEF_COLOR("黄色")

		SELECTCASE EXP:ARG:LOCAL
		CASE IS >= 100000000
			PRINTFORM {EXP:ARG:LOCAL/1000000, 4}M 
		CASE IS >= 100000
			PRINTFORM {EXP:ARG:LOCAL/1000, 4}k 
		CASEELSE
			PRINTFORM {EXP:ARG:LOCAL, 5} 
		ENDSELECT

		RESETCOLOR
	ELSEIF CONFIG("経験表示詰め")
		CONTINUE
	ELSE
		PRINT  ？？？？？？:　　0 
	ENDIF

	NEXT_LINE += 1
	SIF NEXT_LINE%4 == 0
		PRINTL 
NEXT
;最後のループで改行してなかったら改行
SIF NEXT_LINE%4
	PRINTL 

RETURN 0

;異常経験
@NEW_PRINT_EXP50, ARG
#DIM LCOUNT
#DIM MEMO_STR

SIF EXP:ARG:异常经验 == 0
	RETURN 0
LOCALS = □ 異常経験:{EXP:ARG:异常经验, 2} □
CALL DRAWLINES, LOCALS, "異常経験"

SIF CONFIG("項目：異常経験")
	RETURN 0

MEMO_STR = 0
VARSET LOCALS

IF GETBITS(CFLAG:ARG:11, 0, 19)
	LOCALS = 
	SIF GETBIT(CFLAG:ARG:11, 0)
		LOCALS += "極太"
	SIF GETBIT(CFLAG:ARG:11, 1)
		LOCALS += "バイブで"
	SIF GETBIT(CFLAG:ARG:11, 8)
		LOCALS += "触手で"
	SIF GETBIT(CFLAG:ARG:11, 2)
		LOCALS += "３Ｐで"
	SIF GETBIT(CFLAG:ARG:11, 3)
		LOCALS = %LOCALS%%TEXTS("助手の名称")%のペニバン
	SIF GETBIT(CFLAG:ARG:11, 4)
		LOCALS += "ペニバン"
	IF (GETBIT(CFLAG:ARG:11, 3) || GETBIT(CFLAG:ARG:11, 4) ) && GETBIT(CFLAG:ARG:11, 5)
		LOCALS += "に跨って"
	ELSEIF GETBIT(CFLAG:ARG:11, 5)
		LOCALS += "騎乗位で"
	ELSEIF GETBIT(CFLAG:ARG:11, 6)
		LOCALS += "で"
	ENDIF
	LOCALS += "処女喪失"
	SIF GETBIT(CFLAG:ARG:11, 7)
		LOCALS += "(撮影)"
	LOCALS = [%LOCALS%]
ENDIF
SIF GETBIT(CFLAG:ARG:11, 20)
	LOCALS:1 = [童貞なのにＡセックス経験]
IF GETBIT(CFLAG:ARG:11, 32)
	IF GETBIT(CFLAG:ARG:11, 30) || GETBIT(CFLAG:ARG:11, 31)
		SIF GETBIT(CFLAG:ARG:11, 30)
			LOCALS:2 += "処女"
		SIF GETBIT(CFLAG:ARG:11, 30) && GETBIT(CFLAG:ARG:11, 31)
			LOCALS:2 += "、"
		SIF GETBIT(CFLAG:ARG:11, 31)
			LOCALS:2 += "童貞"
		LOCALS:2 += "より先に"
	ENDIF
	LOCALS:2 = [%LOCALS:2%Ａ処女喪失]
ENDIF

SIF GETBIT(CFLAG:ARG:12, 0)
	LOCALS:3 = [公開自慰]
SIF GETBIT(CFLAG:ARG:12, 1)
	LOCALS:4 = [野外全裸]
SIF GETBIT(CFLAG:ARG:12, 2)
	LOCALS:5 = [公開剃毛]
SIF GETBIT(CFLAG:ARG:12, 3)
	LOCALS:6 = [公開放尿]
SIF GETBIT(CFLAG:ARG:12, 4)
	LOCALS:7 = [性器ピアス]
SIF GETBIT(CFLAG:ARG:12, 5)
	LOCALS:8 = [\@ GETBIT(CFLAG:ARG:12, 6) ? 野外 # \@排泄\@ GETBIT(CFLAG:ARG:12, 7) ? 録画 # \@]
SIF GETBIT(CFLAG:ARG:12, 8)
	LOCALS:9 = [アナル奉仕]
SIF GETBIT(CFLAG:ARG:12, 9)
	LOCALS:10 = [お掃除フェラ(Ａ)]
SIF GETBIT(CFLAG:ARG:12, 10)
	LOCALS:11 = [二穴挿入]

IF GETBIT(CFLAG:ARG:12, 11) || GETBIT(CFLAG:ARG:12, 12)
	SIF GETBIT(CFLAG:ARG:12, 11)
		LOCALS:12 += "Ｖ"
	SIF GETBIT(CFLAG:ARG:12, 12)
		LOCALS:12 += "Ａ"
	LOCALS:12 = [%LOCALS:12%拡張]
ENDIF

SIF GETBIT(CFLAG:ARG:12, 13)
	LOCALS:13 = [フィスト]
SIF GETBIT(CFLAG:ARG:12, 14)
	LOCALS:14 = [ドラ姦]

IF GETBIT(CFLAG:ARG:12, 16)
	LOCALS:15 = [五重絶頂]
ELSEIF GETBIT(CFLAG:ARG:12, 15)
	LOCALS:15 = [四重絶頂]
ENDIF

SIF GETBIT(CFLAG:ARG:12, 17)
	LOCALS:16 = [子宮絶頂]
SIF GETBIT(CFLAG:ARG:12, 18)
	LOCALS:17 = [アナルファッカー]
SIF GETBIT(CFLAG:ARG:12, 19)
	LOCALS:18 = [ミニマムいらず]
;SIF GETBIT(CFLAG:ARG:12, 20)
;	LOCALS:19 = [ＳＭ]
SIF GETBIT(CFLAG:ARG:12, 21)
	LOCALS:20 = [針さばき]
SIF GETBIT(CFLAG:ARG:12, 22)
	LOCALS:21 = [耐え難い苦痛]
SIF GETBIT(CFLAG:ARG:12, 23)
	LOCALS:22 = [望まぬ妊娠]
SIF GETBIT(CFLAG:ARG:12, 24)
	LOCALS:23 = [触手]
SIF GETBIT(CFLAG:ARG:12, 25)
	LOCALS:24 = [ふたなり化]
SIF GETBIT(CFLAG:ARG:12, 26)
	LOCALS:25 = [噴乳]
SIF GETBIT(CFLAG:ARG:12, 27)
	LOCALS:26 = [夢魔化]
SIF GETBIT(CFLAG:ARG:12, 28)
	LOCALS:27 = [性転換]
SIF GETBIT(CFLAG:ARG:12, 29)
	LOCALS:28 = [胡蝶の夢]
SIF GETBIT(CFLAG:ARG:12, 30)
	LOCALS:29 = [子宮挿入]
SIF GETBIT(CFLAG:ARG:12, 31)
	LOCALS:30 = [ニプルファック]
SIF GETBIT(CFLAG:ARG:12, 32)
	LOCALS:31 = [尿道拡張]
SIF GETBIT(CFLAG:ARG:12, 33)
	LOCALS:32 = [尿道処女喪失]

FOR LCOUNT, 0, 60
	SIF STRLENS(LOCALS:LCOUNT) == 0
		CONTINUE
	MEMO_STR += STRLENS(LOCALS:LCOUNT)
	IF MEMO_STR > NUM("折り返し文字数")
		PRINTL 
		MEMO_STR = STRLENS(LOCALS:LCOUNT)
	ENDIF
	PRINTFORM %LOCALS:LCOUNT%
NEXT
PRINTL 

RETURN 0

;---------------------------------------------------------------------
;能力の表示
;表示順が能力の番号とは異なるため、LOCALでどの能力を表示するかを管理する
;表示しない場合にはNOABL = 1とする
;---------------------------------------------------------------------
@NEW_PRINT_ABL, ARG
#DIM LCOUNT
#DIM NOABL

CALL DRAWLINES, "□ 能力 □", "能力"

SIF CONFIG("項目：能力")
	RETURN 0

;表示順の設定
; 0,　　　従順　 1,　　　欲望　 2,　　　技巧　 6,　奉仕精神　 7,　　露出癖
; 3,　　Ｃ感覚　 4,　　Ｖ感覚　 5,　　Ａ感覚　14,　　Ｂ感覚　16,　　Ｍ感覚
;10,　自慰中毒　11,　精液中毒　 8,　マゾっ気　15,　サドっ気　 9,　レズっ気
;30,　　舌使い　31,　　指使い　32,　　足使い　33,　　腰使い　34,　　　魔乳
;22,　　Ｖ使い　23,　　Ｖ拡張　24,　Ｖ名器度　28,　　喉拡張　29,　喉名器度
;25,　　Ａ使い　26,　　Ａ拡張　27,　Ａ名器度　20,　尿道拡張

;[オトコ]なら9,レズっ気のかわりに13,BLを表示

FOR LCOUNT, 0, 29
	VARSET LOCAL
	VARSET LOCALS
	NOABL = 0

	SELECTCASE LCOUNT
	CASE 0
		LOCAL = 0
	CASE 1
		LOCAL = 1
	CASE 2
		LOCAL = 2
	CASE 3
		LOCAL = 6
	CASE 4
		LOCAL = 7
	CASE 5
		LOCAL = 3
		IF TALENT:ARG:淫核
			LOCALS = (淫)
		ELSEIF TALENT:ARG:Ｃ钝感
			LOCALS = (鈍)
		ELSEIF TALENT:ARG:Ｃ敏感
			LOCALS = (敏)
		ENDIF
	CASE 6
		LOCAL = 4
		IF TALENT:ARG:淫壶
			LOCALS = (淫)
		ELSEIF TALENT:ARG:Ｖ钝感
			LOCALS = (鈍)
		ELSEIF TALENT:ARG:Ｖ敏感
			LOCALS = (敏)
		ENDIF
		SIF TALENT:ARG:男性
			NOABL = 1
	CASE 7
		LOCAL = 5
		IF TALENT:ARG:尻穴狂
			LOCALS = (淫)
		ELSEIF TALENT:ARG:Ａ钝感
			LOCALS = (鈍)
		ELSEIF TALENT:ARG:Ａ敏感
			LOCALS = (敏)
		ENDIF
	CASE 8
		LOCAL = 14
		IF TALENT:ARG:淫乳
			LOCALS = (淫)
		ELSEIF TALENT:ARG:Ｂ钝感
			LOCALS = (鈍)
		ELSEIF TALENT:ARG:Ｂ敏感
			LOCALS = (敏)
		ENDIF
	CASE 9
		LOCAL = 16
		IF TALENT:ARG:荡唇
			LOCALS = (淫)
		ELSEIF TALENT:ARG:Ｍ钝感
			LOCALS = (鈍)
		ELSEIF TALENT:ARG:Ｍ敏感
			LOCALS = (敏)
		ENDIF
	CASE 10
		LOCAL = 10
	CASE 11
		LOCAL = 11
	CASE 12
		LOCAL = 8
	CASE 13
		LOCAL = 15
	CASE 14
		IF TALENT:ARG:男性
			LOCAL = 13
		ELSE
			LOCAL = 9
		ENDIF
	CASE 15
		LOCAL = 30
	CASE 16
		LOCAL = 31
	CASE 17
		LOCAL = 32
	CASE 18
		LOCAL = 33
	CASE 19
		LOCAL = 34
		SIF TALENT:ARG:男性
			NOABL = 1

	;以下は性器詳細表示がＯＮの時のみ
	CASE 20
		;詳細表示ＯＦＦなら以下は表示しない
		SIF CONFIG("性器詳細表示") == 0
			BREAK
		LOCAL = 22
		SIF TALENT:ARG:男性 || EXP:ARG:Ｖ性交经验 == 0
			NOABL = 1
	CASE 21
		LOCAL = 23
		SIF TALENT:ARG:男性
			NOABL = 1
	CASE 22
		LOCAL = 24
		SIF TALENT:ARG:男性 || EXP:ARG:Ｖ性交经验 == 0
			NOABL = 1
	CASE 23
		LOCAL = 28
	CASE 24
		LOCAL = 29
		SIF EXP:ARG:口交经验 == 0
			NOABL = 1
	CASE 25
		LOCAL = 25
		SIF EXP:ARG:Ａ性交经验 == 0
			NOABL = 1
	CASE 26
		LOCAL = 26
	CASE 27
		LOCAL = 27
		SIF EXP:ARG:Ａ性交经验 == 0
			NOABL = 1
	CASE 28
		LOCAL = 20
		;現時点ではペニスの尿道は無し…やっぱあり
		;SIF PENIS(ARG)
		;	NOABL = 1
	ENDSELECT

	SELECTCASE ARG
	CASE MASTER
		SELECTCASE LCOUNT
		CASE 2, 12 TO 29
		CASEELSE
			NOABL = 1
		ENDSELECT
	ENDSELECT

	LOCALS = %ABLNAME:LOCAL%%LOCALS%

	SELECTCASE NOABL
	CASE 0
		SELECTCASE ABL:ARG:LOCAL
		CASE IS >= 100
			PRINTFORM %TEXT_RJ(LOCALS, 10)%:{ABL:ARG:LOCAL}　
		;CASE IS < 0
		;	PRINTFORM %TEXT_RJ(LOCALS, 10)%:-- 　
			;尿道のみ詳細表示
			;SIF LOCAL == 20 && EXP:ARG:尿道扩张经验
			;	PRINTFORM ({CALCF("尿道径", ARG)}mm)
		CASEELSE
			PRINTFORM %TEXT_RJ(LOCALS, 10)%:{ABL:ARG:LOCAL, 2} 　
		ENDSELECT
	CASEELSE
		SETCOLOR DEF_COLOR("灰色")
		PRINTFORM %TEXT_RJ(LOCALS, 10)%:-- 　
	ENDSELECT
	RESETCOLOR

	;改行
	SIF (LCOUNT+1)%5 == 0
		PRINTL 
NEXT

;最後の改行がされてないなら改行
SIF (LCOUNT+1)%5 == 0
	PRINTL 

RETURN 0


;刻印
@NEW_PRINT_MARK, ARG
#DIM LCOUNT
;改行するかの判定に使う
#DIM NEXT_LINE

SELECTCASE ARG
CASE MASTER
	IF FINDCHARA(MARK:主人屈服刻印, 1) <= 0 && FINDCHARA(MARK:主人屈服刻印, 2) <= 0 && FINDCHARA(MARK:主人屈服刻印, 3) <= 0
		SIF MARK:ARG:淫纹 == 0 || TALENT:ARG:男性
			RETURN 0
	ENDIF

	CALL DRAWLINES, "□ 刻印 □", "刻印"

	SIF CONFIG("項目：刻印")
		RETURN 0

	NEXT_LINE = 0

	FOR LCOUNT, 2, CHARANUM
		SIF MARK:LCOUNT:主人屈服刻印 == 0
			CONTINUE
		PRINTFORM 屈服刻印:LV{MARK:LCOUNT:主人屈服刻印} ([{LCOUNT, 2}] %CALLNAME:LCOUNT%)%BL(17 - STRLENS(CALLNAME:LCOUNT))%
		NEXT_LINE += 1
		SIF NEXT_LINE%2 == 0
			PRINTL 
	NEXT
	SIF NEXT_LINE%2
		PRINTL 

CASEELSE
	CALL DRAWLINES, "□ 刻印 □", "刻印"

	SIF CONFIG("項目：刻印")
		RETURN 0

	;表示順の設定
	;0,苦痛刻印　1,快楽刻印　2,屈服刻印　3,反発刻印
	FOR LCOUNT, 0, 4
		;PRINTFORM %MARKNAME:LCOUNT%:LV{MARK:ARG:LCOUNT} 
		PRINTFORM  %SUBSTRING(MARKNAME:LCOUNT, 0, 4)%LV{MARK:ARG:LCOUNT}
		CALL PRINT_BAR, "黄色ゲージ", MARK:ARG:LCOUNT, 3, 3
		PRINT 　 
	NEXT
	;PRINTL 
ENDSELECT
;淫紋は全員共通
IF MARK:ARG:淫纹 && TALENT:ARG:男性 == 0
	PRINTFORM 淫紋LV{MARK:ARG:淫纹}
	CALL PRINT_BAR, "桃色ゲージ", MARK:ARG:淫纹, 3, 3
ENDIF
PRINTL 
RETURN 0

;---------------------------------------------------------------------
;素質（整頓表示）
;---------------------------------------------------------------------
@NEW_PRINT_TALENT, ARG
#DIM LCOUNT
#DIM LCOUNT2
;表示する内容を整えるのに使う
#DIM MEMO_STR
;素質の種類番号
#DIM TALENT_TYPE
;素質の種類名
#DIMS TALENT_TYPES
;色変更をさせない
#DIM IGNORE_COLOR
;表示する内容
#DIMS PRINT_TALENTS, 10
;キャラメイクの時の固定素質
#DIMS TALENT_FIX
;キャラメイクの時の除外素質
#DIMS TALENT_RMV

IF ARG != MASTER && COND("キャラメイク中") && STRCOUNTS(CSTR:MASTER:10, "固定：", "除外：")
	PRINTFORM □ 素質 □ 
	MEMO_STR = STRLENS("□ 素質 □ ")

	VARSET LOCALS
	SPLIT TEXTS("固定可能な素質"), "/", LOCALS

	IF STRCOUNT(CSTR:MASTER:10, "固定：")
		SETCOLOR DEF_COLOR("緑")
		PRINTFORM 固定：
		MEMO_STR += 6
		FOR LCOUNT, 0, 100
			SIF LOCALS:LCOUNT == ""
				BREAK

			TALENT_FIX = 固定：%LOCALS:LCOUNT%

			SIF CEVENT(TALENT_FIX, MASTER) == 0
				CONTINUE

			PRINTFORM [%LOCALS:LCOUNT%] 
			MEMO_STR += STRLENS(LOCALS:LCOUNT) + 3
		NEXT
		RESETCOLOR
	ENDIF

	IF STRCOUNT(CSTR:MASTER:10, "除外：")
		SETCOLOR DEF_COLOR("青")
		PRINTFORM 除外：
		MEMO_STR += 6
		FOR LCOUNT, 0, 100
			SIF LOCALS:LCOUNT == ""
				BREAK

			TALENT_RMV = 除外：%LOCALS:LCOUNT%

			SIF CEVENT(TALENT_RMV, MASTER) == 0
				CONTINUE

			PRINTFORM [%LOCALS:LCOUNT%] 
			MEMO_STR += STRLENS(LOCALS:LCOUNT) + 3
		NEXT
		RESETCOLOR
	ENDIF

	FOR LCOUNT, 0, NUM("折り返し文字数") - MEMO_STR
		PRINTFORM -
	NEXT
	PRINTL 
ELSE
	CALL DRAWLINES, "□ 素質 □", "素質"
ENDIF

SIF CONFIG("項目：素質")
	RETURN 0

VARSET PRINT_TALENTS

FOR LCOUNT, 0, 300
	SIF TALENT:ARG:LCOUNT == 0
		CONTINUE
	;設定されていない素質は弾く
	SIF STRLENS(TALENTNAME:LCOUNT) == 0
		CONTINUE

	;色変更をさせないフラグ。基本は0
	IGNORE_COLOR = 0

	SELECTCASE LCOUNT
	;表示させない素質
	CASE 1, 3 TO 7, 98, 120, 137, 189, 194 TO 196, 224, 225, 226
		CONTINUE
	;性別
	CASE 2
		SIF PENIS(ARG) == 0 || CONFIG("ペニス詳細設定") == 0
			CONTINUE
		TALENT_TYPE = 0
	CASE 0, 120 TO 122, 134
		TALENT_TYPE = 0
	;性格
	CASE 98
		SIF TALENT:ARG:男性 == 0
			CONTINUE
		TALENT_TYPE = 1
	CASE 10 TO 39, 46, 47, 50, 51, 63, 70, 71, 75, 80 TO 84, 86, 87, 88
		TALENT_TYPE = 1
	;体質
	CASE 138, 139, 141
		SIF TALENT:ARG:男性
			CONTINUE
		TALENT_TYPE = 2
	;乳首素質
	CASE 8
		SIF TALENT:ARG:男性 || TALENT_NAME(LCOUNT, TALENT:ARG:LCOUNT, ARG) == ""
			CONTINUE
		TALENT_TYPE = 2
	CASE 9
		SIF PENIS(ARG)
			CONTINUE
		TALENT_TYPE = 2
	CASE 40 TO 45, 48, 52, 56 TO 62, 64, 65, 69, 72, 73, 96 TO 112, 115, 116, 124, 128 TO 133, 135, 138 TO 140, 142, 145 TO 149, 160 TO 167
		TALENT_TYPE = 2
	;技能
	CASE 37, 53 TO 55, 66, 67, 91, 92, 113, 117, 118, 125, 127, 157, 180 TO 193
		TALENT_TYPE = 3
	;アルカナ
	CASE 230 TO 259
		TALENT_TYPE = 4
	;特殊な素質
	CASE 76, 85, 93, 94, 123, 126, 136, 210 TO 229
		TALENT_TYPE = 5
	;種族特性
	CASE 151
		;大魔法使い
		SIF TALENT:ARG:魔法使 >= 2
			PRINT_TALENTS:4 = すべて
		TALENT_TYPE = 6
	CASE 90, 93, 114, 128, 150 TO 159, 200 TO 203
		TALENT_TYPE = 6
	;弱点
	CASE 49, 74, 77 TO 79, 89, 141, 143, 144
		TALENT_TYPE = 7
	;好きな体位（先頭に表示させる）
	CASE 197
		TALENT_TYPE = 7
		PRINT_TALENTS:TALENT_TYPE = [%TALENT_NAME(LCOUNT, TALENT:ARG:LCOUNT, ARG)%]/%PRINT_TALENTS:TALENT_TYPE%
		CONTINUE
	;分類していない素質（これがあるのは望ましくない）
	CASEELSE
		TALENT_TYPE = 8
	ENDSELECT

	;デフォと異なる素質は色を変える
	SIF IGNORE_COLOR == 0 && CSVTALENT_EX(ARG, LCOUNT) != TALENT:ARG:LCOUNT
		PRINT_TALENTS:TALENT_TYPE = %PRINT_TALENTS:TALENT_TYPE%色変え/

	PRINT_TALENTS:TALENT_TYPE = %PRINT_TALENTS:TALENT_TYPE%[%TALENT_NAME(LCOUNT, TALENT:ARG:LCOUNT, ARG)%]/

	;特定素質の直後に表記する素質
	;SELECTCASE LCOUNT
	;貧乳or巨乳
	;CASE 109, 110
	;	;色を変えておく
	;	SIF TALENT_NAME(8, TALENT:ARG:8, ARG) != ""
	;		PRINT_TALENTS:TALENT_TYPE = %PRINT_TALENTS:TALENT_TYPE%色変え/[%TALENT_NAME(8, TALENT:ARG:8, ARG)%]/
	;ENDSELECT
NEXT

FOR LCOUNT2, 0, 10
	SIF PRINT_TALENTS:LCOUNT2 == ""
		CONTINUE

	SELECTCASE LCOUNT2
	CASE 0
		TALENT_TYPES = 性別：
	CASE 1
		TALENT_TYPES = 性格：
	CASE 2
		TALENT_TYPES = 体質：
	CASE 3
		TALENT_TYPES = 技能：
	CASE 4
		;大魔法使い
		IF TALENT:ARG:魔法使 >= 2
			PRINTL 魔法：すべて
			CONTINUE
		ENDIF

		TALENT_TYPES = 魔法：
	CASE 5
		TALENT_TYPES = 特殊：
	CASE 6
		TALENT_TYPES = 種族：
	CASE 7
		TALENT_TYPES = 弱点：
	CASEELSE
		TALENT_TYPES = 未分類：
	ENDSELECT

	PRINTFORM %TALENT_TYPES%
	MEMO_STR = STRLENS(TALENT_TYPES)

	SPLIT PRINT_TALENTS:LCOUNT2, "/", LOCALS

	FOR LCOUNT, 0, 300
		SELECTCASE LOCALS:LCOUNT
		CASE ""
			BREAK
		CASE "色変え"
			SETCOLOR DEF_COLOR("黄色")
			CONTINUE
		ENDSELECT

		MEMO_STR += STRLENS(LOCALS:LCOUNT)
		IF MEMO_STR > NUM("折り返し文字数")
			PRINTL 
			PRINTFORM %BL(STRLENS(TALENT_TYPES) )%
			MEMO_STR = STRLENS(LOCALS:LCOUNT) + 6
		ENDIF
		PRINTFORM %LOCALS:LCOUNT%
		RESETCOLOR
	NEXT
	PRINTL 
NEXT

RETURN 0

@SHOW_FAMILY, ARG
#DIM LCOUNT
#DIM MOTHER
#DIM FATHER
#DIM FATHER_CHILD
#DIMS MOTHERS
#DIMS FATHERS

MOTHER = COND("母親", ARG)
FATHER = COND("父親", ARG)
FATHER_CHILD = COND("胎児の父親", ARG)

VARSET LOCAL
SIF TALENT:ARG:生产经历 || MOTHER > 0 || FATHER > 0 || COND("子持ち：父親", ARG)
	CALL DRAWLINES, "□ 家族構成 □", "家族構成"

SIF CONFIG("項目：家族構成")
	RETURN 0

;親の名前をステータスに表示します
IF MOTHER > 0 || FATHER > 0
	SIF MOTHER > 0
		MOTHERS = \@ MOTHER != MASTER ? [{MOTHER}] # \@%CALLNAME:MOTHER%
	SIF FATHER > 0
		FATHERS = \@ FATHER != MASTER ? [{FATHER}] # \@%CALLNAME:FATHER%

	IF FATHER > 0 && MOTHER > 0
		PRINTFORML この子は%FATHERS%と%MOTHERS%の第{BASE:ARG:何番目}子です
	ELSEIF FATHER > 0
		PRINTFORML この子は%FATHERS%の子です
	ELSEIF MOTHER > 0
		PRINTFORML この子は%MOTHERS%の第{BASE:ARG:何番目}子です
	ENDIF
ENDIF

IF TALENT:ARG:生产经历
	PRINTFORM 出産経験：前回産んだのは
	SELECTCASE FATHER_CHILD
	CASE IS > 0
		SIF FATHER_CHILD != MASTER
			PRINTFORM [{FATHER_CHILD}]
		PRINTFORM %CALLNAME:FATHER_CHILD%の子で、
	CASE -1
		PRINTFORM 売却された夢魔の子で、
	CASE -2
		PRINTFORM ミランダの娼婦の子で、
	CASE -3
		PRINTFORM ドラゴンの子で、
	CASE -4
		PRINTFORM 父親不明の子で、
	CASE -5
		PRINTFORM 異形の触手の子で、
	ENDSELECT
	PRINTFORML 今までに{TALENT:ARG:生产经历}人の子を産みました

	;子供の名前をステータスに羅列
	FOR LCOUNT, 1, CHARANUM
		SIF COND("母親", LCOUNT) != ARG
			CONTINUE

		PRINTFORM 第{BASE:LCOUNT:何番目, 2}子：[{LCOUNT, 2}]%TEXT_LJ(CALLNAME:LCOUNT, 16)% 父親：
		LOCAL = COND("父親", LCOUNT)
		SELECTCASE LOCAL
		CASE IS > 0
			SIF LOCAL != MASTER
				PRINTFORM [{LOCAL, 2}]
			PRINTFORM %CALLNAME:LOCAL%
		CASE -1
			PRINTFORM 行方不明
		CASE -2
			PRINTFORM ミランダの娼婦
		CASE -3
			PRINTFORM ドラゴン
		CASE -4
			PRINTFORM 不明
		CASE -5
			PRINTFORM 触手
		ENDSELECT
		PRINTL 
	NEXT
ENDIF

IF COND("子持ち：父親", ARG)
	IF TALENT:ARG:生产经历
		PRINTL 
		PRINTFORM また、以下のキャラの父親でもあります
	ELSE
		PRINTFORML 以下のキャラの父親です
	ENDIF

	;子供の名前をステータスに羅列
	LOCAL = 0
	FOR LCOUNT, 1, CHARANUM
		SIF COND("父親", LCOUNT) != ARG
			CONTINUE

		PRINTFORM [{LCOUNT, 2}]%TEXT_LJ(CALLNAME:LCOUNT, 16)%　
		LOCAL += 1
		SIF LOCAL%3 == 0
			PRINTL 
	NEXT
	SIF LOCAL%3
		PRINTL 
ENDIF


RETURN 0

@PRINT_RELATION, ARG, ARGS
#DIM LCOUNT
;改行するかの判定に使う
#DIM NEXT_LINE

;ARGSが"種族"の時には、種族に対する相性を出力する
;自分の種族への相性
RELATION:ARG:(NO:ARG) = MAX(RELATION:ARG:(NO:ARG), 120)

VARSET LOCAL

;一人でも相性の良かったり悪かったりする相手がいるかを判別
FOR LCOUNT, 1, 100
	SELECTCASE ARGS
	CASE "種族"
		SIF LCOUNT == NO:ARG && COND("ユニーク", ARG)
			CONTINUE

		SELECTCASE RELATION:ARG:LCOUNT
		CASE 0, 81 TO 119
			CONTINUE
		ENDSELECT
	CASEELSE
		SIF LCOUNT == ARG
			CONTINUE
		SIF LCOUNT >= CHARANUM
			BREAK

		SELECTCASE RELATION:ARG:(NO:LCOUNT)
		CASE 0, 81 TO 119
			CONTINUE
		ENDSELECT
	ENDSELECT

	LOCAL = 1
	BREAK
NEXT

SIF LOCAL == 0
	RETURN 0

CALL DRAWLINES, "□ 相性 □", "相性"

SIF CONFIG("項目：相性")
	RETURN 0

NEXT_LINE = 0

FOR LCOUNT, 1, 100
	SELECTCASE ARGS
	CASE "種族"
		SIF LCOUNT == NO:ARG && COND("ユニーク", ARG)
			CONTINUE

		LOCAL = LCOUNT
	CASEELSE
		SIF LCOUNT == ARG
			CONTINUE
		SIF LCOUNT >= CHARANUM
			BREAK

		LOCAL = NO:LCOUNT
	ENDSELECT

	SELECTCASE RELATION:ARG:LOCAL
	CASE 0, 81 TO 119
		CONTINUE
	ENDSELECT

	SELECTCASE ARGS
	CASE "種族"
		PRINTFORM %TEXT_LJ(CSVNAME(LCOUNT, 0), 17)%:
	CASEELSE
		PRINTFORM [{LCOUNT,2}]%TEXT_LJ(CALLNAME:LCOUNT, 17)%:
	ENDSELECT

	SELECTCASE RELATION:ARG:LOCAL
	CASE IS  >= 200
		PRINT ☆　
	CASE IS >= 150
		PRINT ◎　
	CASE IS >= 120
		PRINT ○　
	CASE IS <= 20
		PRINT 凶　
	CASE IS <= 50
		PRINT ×　
	CASE IS <= 80
		PRINT △　
	ENDSELECT

	NEXT_LINE += 1

	SIF NEXT_LINE%3 == 0
		PRINTL 
NEXT
;最後のループで改行してなかったら改行
SIF NEXT_LINE%3
	PRINTL 

RETURN 0

@NEW_PRINT_PUBICHAIR, ARG
SIF CONFIG("陰毛と腋毛") == 0 || (TALENT:ARG:男性 && COND("男の娘", ARG) == 0)
	RETURN 0
IF CONFIG("腋毛")
	LOCALS = □ 陰毛と%TEXTS("腋")%毛の状態 □
ELSE
	LOCALS = □ 陰毛の状態 □
ENDIF
CALL DRAWLINES, LOCALS, "陰毛"

SIF CONFIG("項目：陰毛")
	RETURN 0

IF COND("陰毛", ARG) == 0
	PRINT  ----------
ELSE
	PRINTFORM \@ CONFIG("腋毛") ? 陰毛： # \@%CONDS("陰毛", ARG)%
	IF CONDS("陰毛", ARG) == "お手入れ済" && CEVENTS("陰毛の名称", ARG) != ""
		IF CEVENTS("陰毛の形", ARG) == "HEARTMARK"
			PRINT (
			CALL HEARTMARK
			PRINTFORM  %CEVENTS("陰毛の名称", ARG)%)
		ELSE
			PRINTFORM (\@ STRLENS(CEVENTS("陰毛の形", ARG) ) ? %CEVENTS("陰毛の形", ARG)%%BL(1)% #  \@%CEVENTS("陰毛の名称", ARG)%)
		ENDIF
	ENDIF
ENDIF
SELECTCASE COND("身嗜み：陰毛", ARG)
CASE 3
	PRINTFORM 　　※ツルツルに剃る\@ ARG == MASTER ? 主義 # ようにお願い中 \@
CASE 5
	PRINTFORM 　　※形を綺麗に保つ\@ ARG == MASTER ? 主義 # ようにお願い中 \@
CASE 7
	PRINTFORM 　　※剃らない\@ ARG == MASTER ? 主義 # ようにお願い中 \@
ENDSELECT
PRINTL 
SIF CONFIG("腋毛") == 0
	RETURN 0

PRINTFORM %TEXTS("腋")%毛：%CONDS("腋毛", ARG)%
SELECTCASE COND("身嗜み：腋毛", ARG)
CASE 3
	PRINTFORM 　　※ツルツルに剃る\@ ARG == MASTER ? 主義 # ようにお願い中 \@
CASE 7
	PRINTFORM 　　※剃らない\@ ARG == MASTER ? 主義 # ようにお願い中 \@
ENDSELECT
PRINTL 

@PRINT_EQUIPPING_ACCESSORY, ARG
SIF ARG != MASTER || FLAG:399 == 0
	RETURN 0

CALL DRAWLINES, "□ アクセサリ □", "アクセサリ"

SIF CONFIG("項目：アクセサリ")
	RETURN 0

CALL PRINT_ACCESSORY, FLAG:399

RETURN 0

