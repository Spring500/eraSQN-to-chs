@VER_ERASQN()
#FUNCTION
;最新Verを更新したらここもかえる
RETURNF 277


;バージョン違いによるフラグの変換等の処理の記述。
@VERUP_ERASQN, ARG
#DIM LCOUNT
#DIMS MEMOS

;フラグに使う現実時間を取得
CALL GET_REALTIMEFORFLAG

VARSET LOCAL

;EmueraTunesの使用状況確認フラグ
FLAG:501 = 0
TRYCALL IS_EmueraTunes


;FLAG:29を使う。
SIF FLAG:29 >= VER_ERASQN()
	RETURN 0

;妊娠フラグ変更のカバー
IF FLAG:29 == 0
	LOCAL = 0
	FOR LCOUNT, 0, CHARANUM
		IF CFLAG:LCOUNT:467 >= 30 && CFLAG:LCOUNT:467 < 50 && TALENT:LCOUNT:妊娠 == 0 && FLAG:211
			CFLAG:LCOUNT:467 = 512 + RAND:3
			PRINTFORML %NAME:LCOUNT%の子育てフラグを変更しました
			LOCAL += 1
		;お産
		ELSEIF CFLAG:LCOUNT:467 == 20 && TALENT:LCOUNT:妊娠 && FLAG:211
			CFLAG:LCOUNT:467 = 256
			PRINTFORML %NAME:LCOUNT%のお産フラグを変更しました
			LOCAL += 1
		;妊娠期間
		ELSEIF CFLAG:LCOUNT:467 >= 10 && CFLAG:LCOUNT:467 < 20 && TALENT:LCOUNT:妊娠 && FLAG:211
			CFLAG:LCOUNT:467 = 128 + RAND:3
			PRINTFORML %NAME:LCOUNT%の妊娠フラグを変更しました
			LOCAL += 1
		;妊娠発覚前
		ELSEIF CFLAG:LCOUNT:467 >= 2 && CFLAG:LCOUNT:467 < 20 && TALENT:LCOUNT:妊娠 == 0 && FLAG:211
			CFLAG:LCOUNT:467 = 64 + RAND:3
			PRINTFORML %NAME:LCOUNT%の妊娠発覚フラグを変更しました
			LOCAL += 1
		;危険日
		ELSEIF CFLAG:LCOUNT:467 == 1
			CFLAG:LCOUNT:467 = 0
			PRINTFORML %NAME:LCOUNT%の危険日フラグを変更しました
			LOCAL += 1
		ENDIF
	NEXT
	IF LOCAL
		PRINTFORMW 妊娠のフラグを大幅に変えたので、以上の通り最新の値に自動的に直しました
		PRINTL 
	ENDIF
	FLAG:29 = 1
ENDIF

;着せ替えフラグの初期化
IF FLAG:29 == 1
	;この中ではFLAG:29の値は関係ないので、一時フラグとして使います。
	FLAG:29 = 0
	LOCAL = TARGET
	FOR LCOUNT, 1, CHARANUM
		TFLAG:102 = TARGET
		TARGET = LCOUNT
		;コスプレのボーナス解除
		IF CFLAG:602
			IF CFLAG:602 & 2
				ABL:技巧 -= 1
			ELSEIF CFLAG:602 & 4
				TALENT:魅惑 = 0
			ENDIF
		ELSEIF CFLAG:603 && CFLAG:603 & 2
			TALENT:気丈 = 0
		ELSEIF CFLAG:604
			IF CFLAG:604 & 2
				ABL:奉仕精神 -= 1
			ELSEIF CFLAG:604 & 4
				TALENT:献身 = 0
			ENDIF
		ELSEIF CFLAG:605
			MAXBASE:体力 -= 100
			BASE:体力 -= 100
			MAXBASE:気力 -= 100
			BASE:気力 -= 100
		ELSEIF CFLAG:606
			IF CFLAG:606 & 2
				ABL:奉仕精神 -= 1
			ELSEIF CFLAG:606 & 4
				TALENT:治療 = 0
			ENDIF
		ELSEIF CFLAG:607 && CFLAG:607 & 2
			TALENT:人気 = 0
		ELSEIF CFLAG:608
			IF CFLAG:608 & 2
				TALENT:恥じらい = 0
				TALENT:恥薄い = 1
			ELSEIF CFLAG:608 & 4
				TALENT:恥じらい = 0
			ENDIF
		ELSEIF CFLAG:609
			IF CFLAG:609 & 2
				TALENT:貞操観念 = 0
				TALENT:貞操無頓着 = 1
			ELSEIF CFLAG:609 & 4
				TALENT:貞操観念 = 0
			ENDIF
		ELSEIF CFLAG:610 && CFLAG:610 & 2
			TALENT:月光浴 = 0
		ELSEIF CFLAG:611
			IF CFLAG:611 & 2
				TALENT:Ｍ鈍感 = 1
			ELSEIF CFLAG:611 & 4
				TALENT:Ｍ敏感 = 0
			ENDIF
		ELSEIF CFLAG:651
			IF CFLAG:651 & 2
				ABL:露出癖 -= 1
			ELSEIF CFLAG:651 & 4
				TALENT:目立ちたがり = 0
			ENDIF
		ELSEIF CFLAG:652
			IF CFLAG:652 & 2
				TALENT:濡れやすい = 0
				TALENT:濡れにくい = 1
			ELSEIF CFLAG:652 & 4
				TALENT:濡れやすい = 0
			ENDIF
		ELSEIF CFLAG:653
			IF CFLAG:653 & 2
				ABL:欲望 -= 1
			ELSEIF CFLAG:653 & 4
				TALENT:淫乱 = 0
			ENDIF
		ELSEIF CFLAG:654
			IF CFLAG:654 & 2
				ABL:サドっ気 -= 1
			ELSEIF CFLAG:654 & 4
				TALENT:サド = 0
			ENDIF
		ELSEIF CFLAG:655 && CFLAG:655 & 2
			TALENT:動物耳 = 0
		ENDIF
		;以前のコスプレをしているキャラがいるなら、FLAG:29 = 1となる
		FOR LOCAL, 600, 800
			SIF CFLAG:LOCAL
				FLAG:29 = 1
			CFLAG:LOCAL = 0
		NEXT
		LCOUNT = TARGET
		SIF TFLAG:102
			TARGET = TFLAG:102
	NEXT
	TARGET = LOCAL
	FLAG:600 = 0
	M = 0
	T = 1
	FOR LCOUNT, 0, 10
		IF FLAG:(LCOUNT + 601)
			SIF LCOUNT == 0
				M = 10000
			SIF LCOUNT
				FLAG:600 |= T
			FLAG:(LCOUNT + 601) = 0
		ENDIF
		SIF LCOUNT
			T *= 2
	NEXT
	T = 1
	FOR LCOUNT, 0, 5
		IF FLAG:(LCOUNT + 651)
			FLAG:601 |= T
			FLAG:(LCOUNT + 651) = 0
		ENDIF
		T *= 2
	NEXT
	SIF FLAG:29
		PRINTFORMW コスプレのフラグを大幅に変えたので、消去します
	IF M
		MONEY += M
		PRINTFORMW また、エプロンはＳＨＯＰのものだけにしたので、${M}を返金します
	ENDIF
	FLAG:29 = 2
ENDIF

;スキュラの素質番号変更
IF FLAG:29 == 2
	FOR LCOUNT, 0, CHARANUM
		IF NO:LCOUNT == 15
			TALENT:LCOUNT:ハーピー = 0
			TALENT:LCOUNT:旧支配者の名残 = 1
		ENDIF
	NEXT
	FLAG:29 = 3
ENDIF

;スキュラの素質番号変更
IF FLAG:29 == 3
	FOR LCOUNT, 0, CHARANUM
		IF NO:LCOUNT != 15 && TALENT:LCOUNT:旧支配者の名残
			TALENT:LCOUNT:旧支配者の名残 = 0
		ENDIF
	NEXT
	FLAG:29 = 4
ENDIF

;ストックの変更
IF FLAG:29 == 4
	MAXBASE:MASTER:ストック = 0
	SIF TALENT:MASTER:謎の魅力
		MAXBASE:MASTER:ストック += 1
	SIF EXP:MASTER:絶頂経験+EXP:MASTER:射精経験 >= 100
		MAXBASE:MASTER:ストック += 1
	SIF EXP:MASTER:絶頂経験+EXP:MASTER:射精経験 >= 1000
		MAXBASE:MASTER:ストック += 1
	BASE:MASTER:ストック = MAXBASE:MASTER:ストック
	FLAG:29 = 5
ENDIF

;娘パッチに伴うCFLAGの追加
IF FLAG:29 == 5
	FOR LCOUNT, 0, CHARANUM
		CFLAG:LCOUNT:472 = NO:LCOUNT
	NEXT
	FLAG:29 = 6
ENDIF

IF FLAG:29 == 6
	;素質：ハーピー
	FOR LCOUNT, 0, CHARANUM
		SIF NO:LCOUNT == 11 || NO:LCOUNT == 38 || NO:LCOUNT == 39 || NO:LCOUNT == 40
			TALENT:LCOUNT:ハーピー = 1
	NEXT
	FLAG:29 = 7
ENDIF

;娘パッチのCFLAGの移植eraSQ→eraSQN
IF FLAG:29 == 7
	FOR LCOUNT, 0, CHARANUM
		IF CFLAG:LCOUNT:474
			A = CFLAG:LCOUNT:474
			B = CFLAG:LCOUNT:475
			C = CFLAG:LCOUNT:476

			CFLAG:LCOUNT:474 = B
			CFLAG:LCOUNT:475 = 0
			CFLAG:LCOUNT:476 = A
			CFLAG:LCOUNT:478 = C
		ENDIF
	NEXT
	FLAG:29 = 8
ENDIF

;素質の整備
IF FLAG:29 == 8
	FOR LCOUNT, 0, CHARANUM
		IF NO:LCOUNT == 9
			TALENT:LCOUNT:清楚 = 1
		ELSEIF NO:LCOUNT == 12
			TALENT:LCOUNT:生意気 = 0
			TALENT:LCOUNT:意地悪 = 1
		ELSEIF NO:LCOUNT == 13
			TALENT:LCOUNT:賢い = 1
		ELSEIF NO:LCOUNT == 16
			TALENT:LCOUNT:献身 = 0
		ELSEIF NO:LCOUNT == 17
			TALENT:LCOUNT:意地悪 = 1
		ELSEIF NO:LCOUNT == 19
			TALENT:LCOUNT:生意気 = 0
			TALENT:LCOUNT:意地悪 = 1
			TALENT:LCOUNT:賢い = 1
		ELSEIF NO:LCOUNT == 20
			TALENT:LCOUNT:内気 = 0
			TALENT:LCOUNT:清楚 = 1
			TALENT:LCOUNT:賢い = 1
		ELSEIF NO:LCOUNT == 21
			TALENT:LCOUNT:賢い = 1
		ELSEIF NO:LCOUNT == 22
			TALENT:LCOUNT:生意気 = 0
		ELSEIF NO:LCOUNT == 26
			TALENT:LCOUNT:好奇心 = 0
			TALENT:LCOUNT:献身 = 0
		ELSEIF NO:LCOUNT == 27
			TALENT:LCOUNT:生意気 = 0
			TALENT:LCOUNT:意地悪 = 1
			TALENT:LCOUNT:賢い = 1
		ELSEIF NO:LCOUNT == 29
			TALENT:LCOUNT:愚か = 1
			TALENT:LCOUNT:献身 = 0
		ELSEIF NO:LCOUNT == 30
			TALENT:LCOUNT:内気 = 0
			TALENT:LCOUNT:清楚 = 1
		ELSEIF NO:LCOUNT == 34
			TALENT:LCOUNT:意地悪 = 1
		ENDIF
	NEXT
	FLAG:29 = 9
ENDIF

;娘の名前の処理が抜けていたので、もう一度名前の付け直し処理
IF FLAG:29 == 9
	LOCAL = TARGET

	FOR LCOUNT, 1, CHARANUM
		CALL SET_NEWNAME, LCOUNT
	NEXT

	TARGET = LOCAL
	FLAG:29 = 10
ENDIF

;素質の整備
IF FLAG:29 == 10
	FOR LCOUNT, 0, CHARANUM
		IF TALENT:LCOUNT:腰使い
			TALENT:LCOUNT:腰使い = 0
			TALENT:LCOUNT:甘い言葉 = 1
		ENDIF
		IF TALENT:LCOUNT:魔乳
			TALENT:LCOUNT:魔乳 = 0
			TALENT:LCOUNT:てかげん = 1
		ENDIF
		IF TALENT:LCOUNT:調教知識
			TALENT:LCOUNT:調教知識 = 0
			TALENT:LCOUNT:歌唱技能 = 1
		ENDIF
		IF TALENT:LCOUNT:誓約
			TALENT:LCOUNT:誓約 = 0
			TALENT:LCOUNT:舌使い = 1
		ENDIF
		IF TALENT:LCOUNT:相思相愛
			TALENT:LCOUNT:相思相愛 = 0
			TALENT:LCOUNT:指使い = 1
		ENDIF
		IF TALENT:LCOUNT:212
			TALENT:LCOUNT:212 = 0
			TALENT:LCOUNT:足使い = 1
		ENDIF
		IF TALENT:LCOUNT:218
			TALENT:LCOUNT:218 = 0
			TALENT:LCOUNT:188 = 1
		ENDIF
		IF TALENT:LCOUNT:219
			TALENT:LCOUNT:219 = 0
			TALENT:LCOUNT:189 = 1
		ENDIF
	NEXT
	FLAG:29 = 11
ENDIF
;カウンターのフラグ変更の後始末、反抗的の処理
IF FLAG:29 == 11
	;以前のコンフィグで弄られた可能性あり
	FLAG:217 = 0
	FOR LCOUNT, 0, CHARANUM
		CFLAG:LCOUNT:444 = 0
		CFLAG:LCOUNT:445 = 0
		CFLAG:LCOUNT:446 = 0
		CFLAG:LCOUNT:447 = 0
		CFLAG:LCOUNT:448 = 0
		CFLAG:LCOUNT:449 = 0
		CFLAG:LCOUNT:450 = 0
		CFLAG:LCOUNT:451 = 0
		CFLAG:LCOUNT:452 = 0
		CFLAG:LCOUNT:453 = 0
		CFLAG:LCOUNT:454 = 0
		CFLAG:LCOUNT:455 = 0
		CFLAG:LCOUNT:456 = 0
		CFLAG:LCOUNT:457 = 0
		CFLAG:LCOUNT:458 = 0
		CFLAG:LCOUNT:459 = 0

		SIF TALENT:LCOUNT:反抗的 && TALENT:LCOUNT:恋慕
			TALENT:LCOUNT:反抗的 = 0
	NEXT
	FLAG:29 = 12
ENDIF
;異常経験の整備
IF FLAG:29 == 12
	FOR LCOUNT, 0, CHARANUM
		E = 0
		IF CFLAG:LCOUNT:3
			CFLAG:LCOUNT:3 = 0
			CFLAG:LCOUNT:12 |= 2
			E += 1
		ENDIF
		IF CFLAG:LCOUNT:4
			CFLAG:LCOUNT:4 = 0
			CFLAG:LCOUNT:12 |= 4
			E += 1
		ENDIF
		IF CFLAG:LCOUNT:503
			CFLAG:LCOUNT:503 = 0
			CFLAG:LCOUNT:12 |= 16
			E += 1
		ENDIF
		IF EXP:LCOUNT:Ｖ拡張経験
			CFLAG:LCOUNT:13 |= 2
			E += 1
		ENDIF
		IF EXP:LCOUNT:Ａ拡張経験
			CFLAG:LCOUNT:13 |= 4
			E += 1
		ENDIF
		IF CFLAG:LCOUNT:261
			CFLAG:LCOUNT:13 |= 8
			E += 1
		ENDIF
		IF CFLAG:LCOUNT:342 || CFLAG:LCOUNT:343
			CFLAG:LCOUNT:13 |= 16
			E += 1
		ENDIF
		IF CFLAG:LCOUNT:364 || CFLAG:LCOUNT:371
			CFLAG:LCOUNT:14 |= 1
			EXP:LCOUNT:異常経験 += 1
			E += 1
		ENDIF
		IF EXP:LCOUNT:触手経験
			CFLAG:LCOUNT:16 |= 1
			E += 1
		ENDIF
		IF EXP:LCOUNT:射精経験 && TALENT:LCOUNT:オトコ == 0
			CFLAG:LCOUNT:16 |= 2
			E += 1
		ENDIF
		IF EXP:LCOUNT:噴乳経験
			CFLAG:LCOUNT:16 |= 4
			E += 1
		ENDIF
		SIF EXP:LCOUNT:異常経験 < E
			EXP:LCOUNT:異常経験 = E
	NEXT
	;使われている可能性があるフラグの初期化
	FLAG:218 = 0

	FLAG:29 = 13
ENDIF
;娘の名前に使うCFLAG:6の意味を強めに
IF FLAG:29 == 13
	FOR LCOUNT, 0, CHARANUM
		CFLAG:LCOUNT:6 = 0
	NEXT
	FLAG:29 = 14
ENDIF
;CFLAG:6のミス修正
IF FLAG:29 == 14
	FOR LCOUNT, 0, CHARANUM
		SIF CFLAG:LCOUNT:6 == 0 && NO:LCOUNT == 97 && CFLAG:LCOUNT:7 == 6
			CFLAG:LCOUNT:6 = 27
	NEXT
	FLAG:29 = 15
ENDIF

;ステラやきもち度再設定
IF FLAG:29 == 15
	CFLAG:MASTER:471 = 0
	FOR LCOUNT, 0, CHARANUM
		IF NO:LCOUNT == 50 && TALENT:LCOUNT:恋慕 && LCOUNT
			FLAG:471 = LCOUNT
			CFLAG:LCOUNT:470 = 1
		ELSE
			CFLAG:LCOUNT:470 = 0
		ENDIF
	NEXT
	FLAG:29 = 16
ENDIF

;素質：ドラグーン　設定
IF FLAG:29 == 16
	FOR LCOUNT, 0, CHARANUM
		SIF NO:LCOUNT == 26 || CFLAG:LCOUNT:472 == 26
			TALENT:LCOUNT:ドラグーン = 1
	NEXT
	FLAG:29 = 17
ENDIF

;素質：歌唱技能のcsv設定し忘れ
IF FLAG:29 == 17
	FOR LCOUNT, 0, CHARANUM
		IF TALENT:LCOUNT:調教知識
			TALENT:LCOUNT:調教知識 = 0
			TALENT:LCOUNT:歌唱技能 = 1
		ENDIF
	NEXT
	FLAG:29 = 18
ENDIF

;CFLAG:4を一律０にする＆占いのFLAGをFLAG:213からFLAG:299へ変換
IF FLAG:29 == 18
	FOR LCOUNT, 0, CHARANUM
		CFLAG:LCOUNT:4 = 0
	NEXT
	SIF FLAG:211 > 2
		FLAG:211 = 0
	FLAG:299 = FLAG:213
	FLAG:213 = 0
	FLAG:29 = 19
ENDIF

;指使いなどの種族特色技能の習得（SHOPへ移行）
IF FLAG:29 == 19
	FLAG:29 = 20
ENDIF
;異常経験（ふたなり化）の整備
IF FLAG:29 == 20
	FOR LCOUNT, 0, CHARANUM
		IF TALENT:LCOUNT:ふたなり == 2 && (CFLAG:LCOUNT:16+2)&2
			EXP:LCOUNT:異常経験 += 1
			CFLAG:LCOUNT:16 |= 2
		ENDIF
	NEXT
	FLAG:29 = 21
ENDIF
;フラグの穴埋め
IF FLAG:29 == 21
	FLAG:221 = FLAG:301
	FLAG:301 = 0
	FLAG:532 = 0
	FLAG:29 = 22
ENDIF

;相性の整備
IF FLAG:29 == 22
	LOCAL = TARGET
	FOR LCOUNT, 0, CHARANUM
		SIF LCOUNT == 0
			CONTINUE
		TARGET = LCOUNT
		N = NO:TARGET
		SIF RELATION:N <= 120
			RELATION:N = 120
		IF N == 1 || N == 2
			SIF RELATION:1 <= 120
				RELATION:1 = 120
			SIF RELATION:2 <= 120
				RELATION:2 = 120
		ELSEIF N == 3 || N == 4 || N == 5
			SIF RELATION:3 <= 120
				RELATION:3 = 120
			SIF RELATION:4 <= 120
				RELATION:4 = 120
			SIF RELATION:5 <= 120
				RELATION:5 = 120
		ELSEIF N == 6 || N == 7
			SIF RELATION:6 <= 120
				RELATION:6 = 120
			SIF RELATION:7 <= 120
				RELATION:7 = 120
		ELSEIF N == 10 || N == 11 || N == 12
			SIF RELATION:10 <= 120
				RELATION:10 = 120
			SIF RELATION:11 <= 120
				RELATION:11 = 120
			SIF RELATION:12 <= 120
				RELATION:12 = 120
		ELSEIF N == 13 || N == 15
			SIF RELATION:13 <= 120
				RELATION:13 = 120
			SIF RELATION:15 <= 120
				RELATION:15 = 120
		ELSEIF N == 20
			SIF RELATION:21 <= 150
				RELATION:21 = 150
		ELSEIF N == 21
			SIF RELATION:20 <= 150
				RELATION:20 = 150
		ELSEIF N == 23 || N == 58
			SIF RELATION:23 <= 120
				RELATION:23 = 120
			SIF RELATION:58 <= 120
				RELATION:58 = 120
		ELSEIF N == 24 || N == 25
			SIF RELATION:24 <= 120
				RELATION:24 = 120
			SIF RELATION:25 <= 120
				RELATION:25 = 120
		ELSEIF N == 26 || N == 27 || N == 28
			SIF RELATION:26 <= 120
				RELATION:26 = 120
			SIF RELATION:27 <= 120
				RELATION:27 = 120
			SIF RELATION:28 <= 120
				RELATION:28 = 120
		ELSEIF N == 29 || N == 30 || N == 31
			SIF RELATION:29 <= 120
				RELATION:29 = 120
			SIF RELATION:30 <= 120
				RELATION:30 = 120
			SIF RELATION:31 <= 120
				RELATION:31 = 120
		ELSEIF N == 38 || N == 39 || N == 40
			SIF RELATION:38 <= 150 && N != 38
				RELATION:38 = 150
			SIF RELATION:39 <= 150 && N != 39
				RELATION:39 = 150
			SIF RELATION:40 <= 150 && N != 40
				RELATION:40 = 150
		ELSEIF N == 41 || N == 42 || N == 43
			SIF RELATION:41 <= 120
				RELATION:41 = 120
			SIF RELATION:42 <= 120
				RELATION:42 = 120
			SIF RELATION:43 <= 120
				RELATION:43 = 120
		ENDIF
		LCOUNT = TARGET
	NEXT
	TARGET = LOCAL
	FLAG:29 = 23
ENDIF
;素質：うねうね尻尾　設定
IF FLAG:29 == 23
	FOR LCOUNT, 0, CHARANUM
		SIF CFLAG:LCOUNT:472 == 1 || CFLAG:LCOUNT:472 == 2 || CFLAG:LCOUNT:472 == 6
			TALENT:LCOUNT:300 = 1
	NEXT
	FLAG:29 = 24
ENDIF
;素質：スライム　設定
IF FLAG:29 == 24
	FOR LCOUNT, 0, CHARANUM
		SIF CFLAG:LCOUNT:472 == 29
			TALENT:LCOUNT:スライム = 1
	NEXT
	FLAG:29 = 25
ENDIF
;素質：アナル処女　設定
IF FLAG:29 == 25
	FOR LCOUNT, 0, CHARANUM
		SIF CFLAG:LCOUNT:239 + CFLAG:LCOUNT:365 + CFLAG:LCOUNT:378 == 0
			TALENT:LCOUNT:310 = 1
	NEXT
	FLAG:29 = 26
ENDIF
;素質：幼稚　設定など
IF FLAG:29 == 26
	FOR LCOUNT, 0, CHARANUM
		SIF NO:LCOUNT == 2 || NO:LCOUNT == 32
			TALENT:LCOUNT:幼稚 = 1
	NEXT

	;PALAM表示の問題
	IF FLAG:98 == 0
		FLAG:98 = 1
		PRINTFORML Emueraにおいてはパラメータ表示方式がデフォルトだとおかしくなることがあるため、
		PRINTFORML 勝手ながら表示をシンプルに変えさせていただきます。
		PRINTFORMW なお、表示方式を変えたいときには、[777]の 表示方式変更 で変更できます。
	ENDIF
	FLAG:29 = 27
ENDIF
;攻略済みキャラの記憶
IF FLAG:29 == 27
	FLAG:31 = 0
	FOR LCOUNT, 0, CHARANUM
		IF TALENT:LCOUNT:淫乱 || TALENT:LCOUNT:恋慕
			A = NO:LCOUNT + 1099
			;上位夢魔などにも個別対応
			IF CFLAG:LCOUNT:8 == 4
				IF (FLAG:A + 16) & 16
					FLAG:A |= 16
					FLAG:31 += 1
				ENDIF
			ELSEIF CFLAG:LCOUNT:8 == 3
				IF (FLAG:A + 8) & 8
					FLAG:A |= 8
					FLAG:31 += 1
				ENDIF
			ELSEIF CFLAG:LCOUNT:8 == 2
				IF (FLAG:A + 4) & 4
					FLAG:A |= 4
					FLAG:31 += 1
				ENDIF
			ELSEIF CFLAG:LCOUNT:8 == 1
				IF (FLAG:A + 2) & 2
					FLAG:A |= 2
					FLAG:31 += 1
				ENDIF
			ELSEIF CFLAG:LCOUNT:8 == 0
				IF (FLAG:A + 1) & 1
					FLAG:A |= 1
					FLAG:31 += 1
				ENDIF
			ELSE
				IF (FLAG:A + 32) & 32
					FLAG:A |= 32
					FLAG:31 += 1
				ENDIF
			ENDIF
		ENDIF
	NEXT

	;相性の整備
	LOCAL = TARGET
	FOR LCOUNT, 0, CHARANUM
		SIF LCOUNT == 0
			CONTINUE
		TARGET = LCOUNT
		N = NO:TARGET
		SIF RELATION:N <= 120
			RELATION:N = 120
		IF N == 16
			SIF RELATION:22 <= 120
				RELATION:22 = 120
		ELSEIF N == 22
			SIF RELATION:16 <= 120
				RELATION:16 = 120
		ENDIF
		LCOUNT = TARGET
	NEXT
	TARGET = LOCAL
	FLAG:29 = 28
ENDIF
;曜日依存ランダムの設定
IF FLAG:29 == 28
	FLAG:230 = RAND:420
	FLAG:231 = RAND:420
	FLAG:232 = RAND:420
	FLAG:233 = RAND:420
	FLAG:234 = RAND:420
	FLAG:235 = RAND:420
	FLAG:236 = RAND:420
	A = DAY + 1
	B = A%7 + 230
	FLAG:229 = FLAG:B

	FLAG:29 = 29
ENDIF
;Emueraに移行
IF FLAG:29 == 29
	FOR LCOUNT, 0, CHARANUM
		CFLAG:LCOUNT:7 = 0
	NEXT
	FLAG:29 = 30
ENDIF
;素質：アナル処女　設定
IF FLAG:29 == 30
	FOR LCOUNT, 0, CHARANUM
		SIF CFLAG:LCOUNT:239 + CFLAG:LCOUNT:365 + CFLAG:LCOUNT:378
			TALENT:LCOUNT:Ａ処女 = 0

		TALENT:LCOUNT:310 = 0
	NEXT
	FLAG:29 = 31
ENDIF
;アルカナ系素質設定
IF FLAG:29 == 31
	FOR LCOUNT, 0, CHARANUM
		;エオルグン
		SIF NO:LCOUNT == 34
			TALENT:LCOUNT:魔乳 = 1
		;ロギン
		SIF NO:LCOUNT == 20 || NO:LCOUNT == 30 || NO:LCOUNT == 34 || NO:LCOUNT == 35 || NO:LCOUNT == 54
			TALENT:LCOUNT:186 = 1
		;大魔法使い
		IF NO:LCOUNT == 47
			TALENT:LCOUNT:魔法使い = 2
			TALENT:LCOUNT:舌使い = 0
			TALENT:LCOUNT:指使い = 0
			TALENT:LCOUNT:足使い = 0
			TALENT:LCOUNT:腰使い = 0
			TALENT:LCOUNT:魔乳 = 0
			TALENT:LCOUNT:調教知識 = 0
			TALENT:LCOUNT:186 = 0
			TALENT:LCOUNT:187 = 0
			TALENT:LCOUNT:188 = 0
			TALENT:LCOUNT:189 = 0
		ENDIF
	NEXT
	FLAG:29 = 32
ENDIF
;３サイズもういちど消去
IF FLAG:29 <= 33
	FOR LCOUNT, 0, CHARANUM
		CFLAG:LCOUNT:900 = 0
		CFLAG:LCOUNT:901 = 0
		CFLAG:LCOUNT:902 = 0
		CFLAG:LCOUNT:903 = 0
		CFLAG:LCOUNT:904 = 0
	NEXT
	FLAG:29 = 34
ENDIF
;スキュラのミス修正
IF FLAG:29 == 34
	FOR LCOUNT, 0, CHARANUM
		IF CFLAG:LCOUNT:472 == 15 || NO:LCOUNT == 15
			TALENT:LCOUNT:ハーピー = 0
			TALENT:LCOUNT:旧支配者の名残 = 1
		ENDIF
	NEXT
	FLAG:29 = 35
ENDIF
;CFLAG:465のミス修正
IF FLAG:29 == 35
	FOR LCOUNT, 0, CHARANUM
		IF NO:LCOUNT != 34 && NO:LCOUNT != 46 && NO:LCOUNT != 48
			CFLAG:LCOUNT:465 = 0
		ENDIF
	NEXT
	FLAG:29 = 36
ENDIF
;指輪の数のミス修正
IF FLAG:29 == 36
	A = 0
	FOR LCOUNT, 0, CHARANUM
		SIF LCOUNT && TALENT:LCOUNT:相思相愛
			A += 1
	NEXT
	ITEM:誓約の指輪 = A
	FLAG:29 = 37
ENDIF
;CFLAG:3の初期化
IF FLAG:29 == 37
	FOR LCOUNT, 0, CHARANUM
		CFLAG:LCOUNT:3 = 0
	NEXT
	FLAG:29 = 38
ENDIF
;拘束ツールの単純化
IF FLAG:29 == 38
	IF ITEM:拘束ツール >= 2
		MONEY += (ITEM:拘束ツール - 1)*3000
		ITEM:拘束ツール = 1
	ENDIF
	FLAG:29 = 39
ENDIF
;アクセサリシステム改変に伴う処理
IF FLAG:29 == 39
	FOR LCOUNT, 5000, 5051
		IF LCOUNT == 5001 || LCOUNT == 5011 || LCOUNT == 5021 || LCOUNT == 5031 || LCOUNT == 5041
			IF FLAG:LCOUNT == 5
				MONEY += 50000
			ELSEIF FLAG:LCOUNT > 0
				MONEY += 20000
			ENDIF
		ENDIF
		FLAG:LCOUNT = 0
	NEXT
	FLAG:29 = 40
ENDIF
;ドラゴンの子供に素質：竜の血 をもたせる
IF FLAG:29 == 40
	FOR LCOUNT, 0, CHARANUM
		IF (NO:LCOUNT == 95 || NO:LCOUNT == 97) && CFLAG:LCOUNT:475 == -3 && TALENT:LCOUNT:竜の血 == 0
			TALENT:LCOUNT:竜の血 = RAND:2 + 1
			MAXBASE:LCOUNT:体力 += 400
			MAXBASE:LCOUNT:気力 += 400

			BASE:LCOUNT:体力 = MAXBASE:LCOUNT:体力
			BASE:LCOUNT:気力 = MAXBASE:LCOUNT:気力
		ENDIF
	NEXT
	FLAG:29 = 41
ENDIF
;ルヴィッサの能力を変更
IF FLAG:29 == 41
	FOR LCOUNT, 0, CHARANUM
		IF NO:LCOUNT == 52
			TALENT:LCOUNT:上位夢魔 = 0
			TALENT:LCOUNT:魔王のかけら = 1

			A = MAXBASE:LCOUNT:体力 - 3000
			SIF A < 0
				A = 0
			B = MAXBASE:LCOUNT:気力 - 2000
			SIF B < 0
				B = 0
			MAXBASE:LCOUNT:体力 = 1500 + A*2
			MAXBASE:LCOUNT:気力 = 1000 + B*2

			BASE:LCOUNT:体力 = MAXBASE:LCOUNT:体力
			BASE:LCOUNT:気力 = MAXBASE:LCOUNT:気力
		ENDIF
	NEXT
	FLAG:29 = 42
ENDIF
;エストの能力を変更
IF FLAG:29 == 42
	FOR LCOUNT, 0, CHARANUM
		IF NO:LCOUNT == 48 && EXP:LCOUNT:Ｖ経験 >= 3000 && EXP:LCOUNT:精液経験 >= 9000 && EXP:LCOUNT:嗜虐快楽経験 >= 5000
			MARK:LCOUNT:機嫌 = CFLAG:LCOUNT:461
			CFLAG:LCOUNT:461 = 0

			CFLAG:LCOUNT:900 = 0
			CFLAG:LCOUNT:901 = 0
			CFLAG:LCOUNT:902 = 0
			CFLAG:LCOUNT:903 = 0
			CFLAG:LCOUNT:904 = 0

			TALENT:LCOUNT:反抗的 = 0
			TALENT:LCOUNT:気丈 = 0
			TALENT:LCOUNT:高慢 = 0
			TALENT:LCOUNT:好奇心 = 1
			TALENT:LCOUNT:貞操無頓着 = 1
			TALENT:LCOUNT:抑圧 = 0
			TALENT:LCOUNT:解放 = 0
			TALENT:LCOUNT:抵抗 = 0
			TALENT:LCOUNT:調合知識 = 0
			TALENT:LCOUNT:薬毒耐性 = 0
			TALENT:LCOUNT:汚臭鈍感 = 0
			TALENT:LCOUNT:汚臭敏感 = 0
			TALENT:LCOUNT:汚れ無視 = 1
			TALENT:LCOUNT:快感に素直 = 1
			TALENT:LCOUNT:倒錯的 = 1
			TALENT:LCOUNT:長身 = 1
			TALENT:LCOUNT:Ｃ敏感 = 1
			TALENT:LCOUNT:Ｖ敏感 = 1
			TALENT:LCOUNT:Ｂ敏感 = 0
			TALENT:LCOUNT:具現 = 0

			EXP:LCOUNT:Ｖ経験 -= 2700
			EXP:LCOUNT:Ａ経験 -= 720
			EXP:LCOUNT:絶頂経験 -= 1290
			EXP:LCOUNT:自慰経験 -= 90
			EXP:LCOUNT:精液経験 -= 8100
			EXP:LCOUNT:フェラ経験 -= 4500
			EXP:LCOUNT:奉仕快楽経験 -= 3500
			EXP:LCOUNT:被虐快楽経験 -= 1000
			EXP:LCOUNT:嗜虐快楽経験 -= 5000
			EXP:LCOUNT:レズ経験 -= 1350
			EXP:LCOUNT:異常経験 -= 15
			EXP:LCOUNT:緊縛経験 -= 30
			EXP:LCOUNT:Ｖ拡張経験 -= 95
			EXP:LCOUNT:噴乳経験 -= 5
			EXP:LCOUNT:触手経験 -= 90
			EXP:LCOUNT:スライム経験 -= 100
			EXP:LCOUNT:Ａ拡張経験 -= 15
		ENDIF
	NEXT
	FLAG:29 = 43
ENDIF
;レズ中毒を廃止
IF FLAG:29 == 43
	FOR LCOUNT, 0, CHARANUM
		ABL:LCOUNT:レズっ気 = MAX(ABL:LCOUNT:レズっ気, ABL:LCOUNT:12)
		ABL:LCOUNT:12 = 0
	NEXT
	FLAG:29 = 44
ENDIF
;クノイチの技能を強化
IF FLAG:29 <= 45
	FOR LCOUNT, 0, CHARANUM
		IF CFLAG:LCOUNT:472 == 22
			ABL:LCOUNT:舌使い = 1
			ABL:LCOUNT:腰使い = 2
		ENDIF
	NEXT
	FLAG:29 = 46
ENDIF
;幾つかのCFLAG等をBASEへ変化、FLAG:239の値の変更
IF FLAG:29 == 46
	FOR LCOUNT, 0, CHARANUM
		BASE:LCOUNT:身長 = CFLAG:LCOUNT:900
		CFLAG:LCOUNT:900 = 0
		BASE:LCOUNT:バスト = CFLAG:LCOUNT:901
		CFLAG:LCOUNT:901 = 0
		BASE:LCOUNT:カップ = CFLAG:LCOUNT:904
		CFLAG:LCOUNT:904 = 0
		BASE:LCOUNT:ウェスト = CFLAG:LCOUNT:902
		CFLAG:LCOUNT:902 = 0
		BASE:LCOUNT:ヒップ = CFLAG:LCOUNT:903
		CFLAG:LCOUNT:903 = 0

		BASE:LCOUNT:バイオリズム = CFLAG:LCOUNT:5
		CFLAG:LCOUNT:5 = 0
	NEXT
	IF FLAG:239 == 1
		FLAG:239 = 1+2
	ELSEIF FLAG:239 == 2
		FLAG:239 = 1+4
	ELSEIF FLAG:239 == 3
		FLAG:239 = 1+8
	ENDIF
	FLAG:29 = 47
ENDIF
;やきもちフラグの場所を移動
IF FLAG:29 == 47
	FLAG:252 = FLAG:471
	FLAG:471 = 0
	FLAG:29 = 48
ENDIF
;調教自慰経験をなくす
IF FLAG:29 == 48
	FOR LCOUNT, 0, CHARANUM
		EXP:LCOUNT:処女簒奪経験 = 0
	NEXT
	FLAG:29 = 49
ENDIF
;喫茶店でエロ無しは無くす
IF FLAG:29 == 49
	FOR LCOUNT, 0, 5
		SIF FLAG:(400 + LCOUNT*10 + 1) == 2
			FLAG:(400 + LCOUNT*10 + 1) = 0
	NEXT
	FLAG:29 = 50
ENDIF
;主人のレベル最大値
IF FLAG:29 == 50
	FLAG:255 = ABL:MASTER:ＬＶ
	FLAG:29 = 51
ENDIF
;胸フラグを一応立てる
IF FLAG:29 == 51
	FOR LCOUNT, 0, CHARANUM
		SIF NO:LCOUNT != 95 && NO:LCOUNT != 97
			CONTINUE
		CFLAG:LCOUNT:484 = 2048 * (TALENT:LCOUNT:貧乳 == 1) + 4096 * (TALENT:LCOUNT:巨乳 == 1) + 16384
		IF CFLAG:LCOUNT:468&1
			CFLAG:LCOUNT:484 = 2048+16384
		ENDIF
		SIF CFLAG:LCOUNT:468&2
			CFLAG:LCOUNT:484 = 2048 * (TALENT:LCOUNT:貧乳 == 1) + 16384
	NEXT
	FLAG:29 = 52
ENDIF
;CFLAG:479の廃止
IF FLAG:29 == 52
	FOR LCOUNT, 0, CHARANUM
		CFLAG:LCOUNT:479 = 0
	NEXT
	FLAG:29 = 53
ENDIF
;コンフィグなどの整理
IF FLAG:29 == 53
	;ハートマーク
	FLAG:238 = 0
	;素質表示整頓
	FLAG:240 = 0
	FLAG:29 = 54
ENDIF
;ラミアの身長管理
IF FLAG:29 == 54
	LOCAL = TARGET
	FOR LCOUNT, 0, CHARANUM
		IF TALENT:LCOUNT:ラミア && BASE:LCOUNT:身長
			;長身 164～175cm
			IF TALENT:LCOUNT:長身
				T = 164 + RAND:12
			;小柄体系 135～144cm
			ELSEIF TALENT:LCOUNT:小柄体型
				T = 135 + RAND:10
			;普通 145～163cm
			ELSE
				T = 145 + RAND:11 + RAND:5 + RAND:5
			ENDIF
			BASE:LCOUNT:身長の追加要素 = BASE:LCOUNT:身長 - T
			BASE:LCOUNT:身長 = T

			TARGET = LCOUNT
			;バストカップ計測
			CALL SETFLAG, "バスト設定", TARGET
		ENDIF
	NEXT
	TARGET = LOCAL
	FLAG:29 = 55
ENDIF
;ＬＶはみんな見えるのがデフォにする
IF FLAG:29 == 55
	SIF FLAG:242 >= 2
		FLAG:242 = 1
	FLAG:29 = 56
ENDIF
;野外プレイのCFLAGを変更
IF FLAG:29 == 56
	FOR LCOUNT, 0, CHARANUM
		SIF CFLAG:LCOUNT:258 >= 5
			CFLAG:LCOUNT:258 = 4
		SIF CFLAG:LCOUNT:335 >= 5
			CFLAG:LCOUNT:335 = 4
		SIF CFLAG:LCOUNT:336 >= 5
			CFLAG:LCOUNT:336 = 4
		SIF CFLAG:LCOUNT:337 >= 5
			CFLAG:LCOUNT:337 = 4
	NEXT
	FLAG:29 = 57
ENDIF
;妊娠パッチのフラグ変更
IF FLAG:29 == 57
	FLAG:212 = 0
	SIF FLAG:211
		PRINTL 妊娠パッチの設定を少々変更しました
	FLAG:29 = 58
ENDIF
;コマンドフィルタの移行
IF FLAG:29 == 58
	IF FLAG:209 & 4
		SIF FLAG:210 & 1
			DITEMTYPE:0:130 = 1
		SIF FLAG:210 & 2
			DITEMTYPE:0:131 = 1
		SIF FLAG:210 & 4
			DITEMTYPE:0:132 = 1
		SIF FLAG:210 & 8
			DITEMTYPE:0:133 = 1
		SIF FLAG:210 & 16
			DITEMTYPE:0:134 = 1
		SIF FLAG:210 & 32
			DITEMTYPE:0:135 = 1
		SIF FLAG:210 & 64
			DITEMTYPE:0:136 = 1
		SIF FLAG:210 & 256
			DITEMTYPE:0:137 = 1
		SIF FLAG:210 & 512
			DITEMTYPE:0:138 = 1
		SIF FLAG:210 & 1024
			DITEMTYPE:0:140 = 1
		SIF FLAG:210 & 2048
			DITEMTYPE:0:141 = 1
		SIF FLAG:210 & 4096
			DITEMTYPE:0:142 = 1
		SIF FLAG:210 & 8192
			DITEMTYPE:0:143 = 1
		SIF FLAG:210 & 16384
			DITEMTYPE:0:144 = 1
		SIF FLAG:210 & 32768
			DITEMTYPE:0:145 = 1
		SIF FLAG:210 & 131072
			DITEMTYPE:0:146 = 1
		SIF FLAG:210 & 262144
			DITEMTYPE:0:147 = 1
		SIF FLAG:210 & 524288
			DITEMTYPE:0:148 = 1
		SIF FLAG:210 & 1048576
			DITEMTYPE:0:120 = 1
		SIF FLAG:210 & 2097152
			DITEMTYPE:0:121 = 1
		IF FLAG:210 & 65536
			DITEMTYPE:0:304 = 1
			DITEMTYPE:0:305 = 1
		ENDIF
	ENDIF
	FLAG:210 = 0
	FLAG:29 = 59
ENDIF
;衣装をFLAGからITEMに移行
IF FLAG:29 == 59
	SIF FLAG:600&1
		ITEM:女教師 = 1
	SIF FLAG:600&2
		ITEM:和服 = 1
	SIF FLAG:600&4
		ITEM:メイド服 = 1
	SIF FLAG:600&8
		ITEM:体操服 = 1
	SIF FLAG:600&16
		ITEM:ナース服 = 1
	SIF FLAG:600&32
		ITEM:チャイナ服 = 1
	SIF FLAG:600&64
		ITEM:セーラー服 = 1
	SIF FLAG:600&128
		ITEM:巫女服 = 1
	SIF FLAG:600&256
		ITEM:ベビードール = 1
	SIF FLAG:600&512
		ITEM:ウェディングドレス = 1
	SIF FLAG:601&1
		ITEM:ビキニ = 1
	SIF FLAG:601&2
		ITEM:スク水 = 1
	SIF FLAG:601&4
		ITEM:危ないレオタード = 1
	SIF FLAG:601&8
		ITEM:ボンデージ = 1
	SIF FLAG:601&16
		ITEM:バニースーツ = 1

	FLAG:600 = 0
	FLAG:601 = 0

	;助手可能人数、調教中のキャラ以外にもキャラが居るかについては関数化
	FLAG:26 = 0
	FLAG:27 = 0

	FLAG:29 = 60
ENDIF
;夢魔化パッチのフラグ変更
IF FLAG:29 == 60
	FLAG:226 = FLAG:670
	FLAG:227 = FLAG:671
	FLAG:670 = 0
	FLAG:671 = 0

	FOR LCOUNT, 0, CHARANUM
		SIF CFLAG:LCOUNT:18&1
			CFLAG:LCOUNT:16 |= 256
		SIF CFLAG:LCOUNT:18&2
			CFLAG:LCOUNT:16 |= 512
		CFLAG:LCOUNT:18 = 0
	NEXT
	FLAG:29 = 61
ENDIF
IF FLAG:29 == 61
	FOR LCOUNT, 0, CHARANUM
		SIF CFLAG:LCOUNT:18&1
			CFLAG:LCOUNT:16 |= 256
		SIF CFLAG:LCOUNT:18&2
			CFLAG:LCOUNT:16 |= 512
		CFLAG:LCOUNT:18 = 0
	NEXT
	FLAG:29 = 62
ENDIF
;アルケニーは多腕
IF FLAG:29 == 62
	FOR LCOUNT, 0, CHARANUM
		SIF CFLAG:LCOUNT:472 == 18
			TALENT:LCOUNT:多腕 = 4
	NEXT
	FLAG:29 = 63
ENDIF
;購入処理を変更
IF FLAG:29 == 63
	FOR LCOUNT, 0, 100
		FLAG:(1000 + LCOUNT) = 0
	NEXT
	FLAG:29 = 64
ENDIF
;獣耳等
IF FLAG:29 == 64
	FOR LCOUNT, 0, CHARANUM
		IF TALENT:LCOUNT:動物耳
			IF CFLAG:LCOUNT:472 == 7
				TALENT:LCOUNT:動物耳 = 2
			ELSEIF CFLAG:LCOUNT:472 == 16
				TALENT:LCOUNT:動物耳 = 3
			ELSEIF CFLAG:LCOUNT:472 == 23 || CFLAG:LCOUNT:472 == 58
				TALENT:LCOUNT:動物耳 = 4
			ELSEIF CFLAG:LCOUNT:472 == 30
				TALENT:LCOUNT:動物耳 = 5
			ENDIF
		ENDIF
		SIF CFLAG:472 == 23 || CFLAG:472 == 58
			CFLAG:620 = 1+4+32+64
	NEXT
	;購入処理をもう一度変更
	FOR LCOUNT, 0, 100
		FLAG:(1000 + LCOUNT) = 0
	NEXT
	FLAG:29 = 65
ENDIF
;CFLAGのミス
IF FLAG:29 == 65
	FOR LCOUNT, 0, CHARANUM
		SIF CFLAG:LCOUNT:11&32 && !(CFLAG:LCOUNT:11&8) && !(CFLAG:LCOUNT:11&16)
			EXP:LCOUNT:異常経験 += 1
	NEXT
	FLAG:29 = 66
ENDIF
;母乳体質を天然と後天に分ける
IF FLAG:29 == 66
	FOR LCOUNT, 0, CHARANUM
		IF TALENT:LCOUNT:母乳体質
			IF NO:LCOUNT == 49
			ELSEIF NO:LCOUNT == 10 && CFLAG:8 == 4
			ELSE
				TALENT:LCOUNT:母乳体質 = 2
			ENDIF
		ENDIF
	NEXT
	FLAG:29 = 67
ENDIF
;サロメの口上の371_1を削除し、371_2を371版とする
IF FLAG:29 == 67
	FOR LCOUNT, 0, CHARANUM
		IF NO:LCOUNT == 24
			SIF CFLAG:LCOUNT:209 == 3
				CFLAG:LCOUNT:209 = 2
		ENDIF
	NEXT
	FLAG:29 = 68
ENDIF
IF FLAG:29 == 68
	FOR LOCAL, 229, 237
		FLAG:LOCAL = 0
	NEXT
	FLAG:29 = 69
ENDIF
;経験値
IF FLAG:29 == 69
	FOR LCOUNT, 0, CHARANUM
		SIF LCOUNT == 0
			CONTINUE
		IF EXP:LCOUNT:イかせた回数
			CALL GET_EXPERIENCE, EXP:LCOUNT:イかせた回数, LCOUNT
		ENDIF
	NEXT
	FLAG:29 = 70
ENDIF
;エルダーサキュバス設定など
IF FLAG:29 == 70
	FOR LCOUNT, 0, CHARANUM
		CFLAG:LCOUNT:34 = 0
		SIF LCOUNT == 0
			CONTINUE
		SIF (NO:LCOUNT == 48 || NO:LCOUNT == 50) && TALENT:LCOUNT:上位夢魔
			TALENT:LCOUNT:上位夢魔 = 2
	NEXT
	FLAG:29 = 71
ENDIF
;しっぽと弱点、アルカナの素質整備
IF FLAG:29 == 71
	FOR LCOUNT, 0, CHARANUM
		;弱点をTALENT:弱点のビットに再設定
		FOR LOCAL, 0, 10
			SIF TALENT:LCOUNT:(160+LOCAL)
				SETBIT TALENT:LCOUNT:弱点, LOCAL
			TALENT:LCOUNT:(160+LOCAL) = 0
		NEXT

		;うねうねしっぽ（暫定）を消去
		TALENT:LCOUNT:300 = 0
		SELECTCASE CFLAG:LCOUNT:472
		;悪魔の尻尾
		CASE 1, 2
			TALENT:LCOUNT:しっぽ = 6
		;ねこまた
		CASE 6
			TALENT:LCOUNT:しっぽ = 1
		;狼
		CASE 7
			TALENT:LCOUNT:しっぽ = 2
		;リザード系
		CASE 12, 34, 35
			TALENT:LCOUNT:しっぽ = 7
		;狐
		CASE 16
			TALENT:LCOUNT:しっぽ = 3
		;ウサギ
		CASE 23, 58
			TALENT:LCOUNT:しっぽ = 4
		;馬
		CASE 30
			TALENT:LCOUNT:しっぽ = 5
		;ジャバウォック
		CASE 41
			TALENT:LCOUNT:しっぽ = 8
		ENDSELECT
	NEXT
	FLAG:29 = 72
ENDIF
;孫とかの体力気力
IF FLAG:29 <= 73
	FOR LCOUNT, 0, CHARANUM
		IF NO:LCOUNT == 95 || NO:LCOUNT == 97
			LOCAL = CSVBASE(CFLAG:LCOUNT:472, 0, 0)*100/120 + TALENT:LCOUNT:オトコ*200
			IF MAXBASE:LCOUNT:体力 < LOCAL
				MAXBASE:LCOUNT:体力 = LOCAL
				BASE:LCOUNT:体力 = MAXBASE:LCOUNT:体力
			ENDIF
			LOCAL:1 = CSVBASE(CFLAG:LCOUNT:472, 1, 0)*100/120
			IF MAXBASE:LCOUNT:気力 < LOCAL:1
				MAXBASE:LCOUNT:気力 = LOCAL:1
				BASE:LCOUNT:気力 = MAXBASE:LCOUNT:気力
			ENDIF
		ENDIF
	NEXT
	FLAG:29 = 74
ENDIF
;名前をNAMEとCALLNAMEに戻す
IF FLAG:29 == 74
	FOR LCOUNT, 0, CHARANUM
		NAME:LCOUNT = %SAVESTR:LCOUNT%
		CALLNAME:LCOUNT = %NAME:LCOUNT%
		IF NO:LCOUNT == 39
			NICKNAME:TARGET = リズ
		ELSEIF NO:LCOUNT == 40
			NICKNAME:TARGET = ロッコ
		ENDIF
	NEXT
	VARSET SAVESTR
	;喫茶店の名前
	FOR LCOUNT, 0, 10
		SAVESTR:LCOUNT = %CSTR:MASTER:LCOUNT%
		CSTR:MASTER:LCOUNT = 
	NEXT
	FLAG:29 = 75
ENDIF
;ミス修正
IF FLAG:29 == 75
	FOR LCOUNT, 0, CHARANUM
		IF NO:LCOUNT == 95 || NO:LCOUNT == 97
			SIF CALLNAME:LCOUNT == "NAME:TARGET"
				CALLNAME:LCOUNT = %NAME:LCOUNT%
		ENDIF
	NEXT
	FLAG:29 = 76
ENDIF
;バイトフラグ
IF FLAG:29 == 76
	FOR LCOUNT, 0, CHARANUM
		SIF CFLAG:LCOUNT:31 == 99
			CFLAG:LCOUNT:31 = 10
	NEXT
	FLAG:29 = 77
ENDIF
;オートロギンフラグ消去
IF FLAG:29 == 77
	FLAG:251 = 0
	FLAG:29 = 78
ENDIF
;経験の補正
IF FLAG:29 == 78
	FOR LCOUNT, 0, CHARANUM
		LOCAL = 0
		SIF TALENT:LCOUNT:処女 != 1 && EXP:LCOUNT:Ｖ性交経験 < CSVEXP(NO:LCOUNT, 12, 0)
			LOCAL = 1
		SIF EXP:LCOUNT:Ａ性交経験 < CSVEXP(NO:LCOUNT, 13, 0)
			LOCAL = 1
		SIF EXP:LCOUNT:Ｖ挿入経験 < CSVEXP(NO:LCOUNT, 15, 0)
			LOCAL = 1
		SIF EXP:LCOUNT:Ａ挿入経験 < CSVEXP(NO:LCOUNT, 16, 0)
			LOCAL = 1
		SIF EXP:LCOUNT:手淫経験 < CSVEXP(NO:LCOUNT, 23, 0)
			LOCAL = 1
		SIF EXP:LCOUNT:足コキ経験 < CSVEXP(NO:LCOUNT, 24, 0)
			LOCAL = 1
		SIF TALENT:LCOUNT:処女 != 1 && EXP:LCOUNT:腰使い経験 < CSVEXP(NO:LCOUNT, 25, 0)
			LOCAL = 1
		SIF EXP:LCOUNT:パイズリ経験 < CSVEXP(NO:LCOUNT, 26, 0)
			LOCAL = 1
		SIF EXP:LCOUNT:Ａ責め経験 < CSVEXP(NO:LCOUNT, 27, 0)
			LOCAL = 1
		SIF EXP:LCOUNT:クンニ経験 < CSVEXP(NO:LCOUNT, 28, 0)
			LOCAL = 1

		IF LOCAL
			SIF TALENT:LCOUNT:処女 != 1 && EXP:LCOUNT:Ｖ性交経験 + CSVEXP(NO:LCOUNT, 12, 0) < EXP:LCOUNT:Ｖ経験
				EXP:LCOUNT:Ｖ性交経験 += CSVEXP(NO:LCOUNT, 12, 0)
			SIF EXP:LCOUNT:Ａ性交経験 + CSVEXP(NO:LCOUNT, 13, 0) < EXP:LCOUNT:Ａ経験
				EXP:LCOUNT:Ａ性交経験 += CSVEXP(NO:LCOUNT, 13, 0)
			EXP:LCOUNT:Ｖ挿入経験 += CSVEXP(NO:LCOUNT, 15, 0)
			EXP:LCOUNT:Ａ挿入経験 += CSVEXP(NO:LCOUNT, 16, 0)
			EXP:LCOUNT:手淫経験 += CSVEXP(NO:LCOUNT, 23, 0)
			EXP:LCOUNT:足コキ経験 += CSVEXP(NO:LCOUNT, 24, 0)
			SIF TALENT:LCOUNT:処女 != 1 && EXP:LCOUNT:腰使い経験 + CSVEXP(NO:LCOUNT, 25, 0) < EXP:LCOUNT:Ｖ経験
				EXP:LCOUNT:腰使い経験 += CSVEXP(NO:LCOUNT, 25, 0)
			EXP:LCOUNT:パイズリ経験 += CSVEXP(NO:LCOUNT, 26, 0)
			EXP:LCOUNT:Ａ責め経験 += CSVEXP(NO:LCOUNT, 27, 0)
			EXP:LCOUNT:クンニ経験 += CSVEXP(NO:LCOUNT, 28, 0)
		ENDIF
	NEXT
	FLAG:29 = 79
ENDIF
;ツノと羽
IF FLAG:29 == 79
	FOR LCOUNT, 0, CHARANUM
		;ツノ
		SELECTCASE CFLAG:LCOUNT:472
		;悪魔
		CASE 1, 2, 48, 50
			TALENT:LCOUNT:ツノ = 6
		;ユニコーン(馬)
		CASE 30
			TALENT:LCOUNT:ツノ = 5
		;ゴブリン(鬼)
		CASE 31
			TALENT:LCOUNT:ツノ = 9
		CASEELSE
			TALENT:LCOUNT:ツノ = 0
		ENDSELECT
		;羽or翼
		SELECTCASE CFLAG:LCOUNT:472
		;悪魔
		CASE 1, 2
			TALENT:LCOUNT:翼 = 6
		;妖精
		CASE 4
			TALENT:LCOUNT:翼 = 10
		;ハーピー
		CASE 11
			TALENT:LCOUNT:翼 = 11
		;天使
		CASE 20, 21
			TALENT:LCOUNT:翼 = 12
		CASEELSE
			TALENT:LCOUNT:翼 = 0
			SIF TALENT:LCOUNT:ハーピー
				TALENT:LCOUNT:翼 = 11
		ENDSELECT
	NEXT
	FLAG:29 = 80
ENDIF
;鈍感の消去
IF FLAG:29 == 80
	FOR LCOUNT, 0, CHARANUM
		SIF ABL:LCOUNT:Ｃ感覚 >= 3
			TALENT:LCOUNT:Ｃ鈍感 = 0
		SIF ABL:LCOUNT:Ｖ感覚 >= 3
			TALENT:LCOUNT:Ｖ鈍感 = 0
		SIF ABL:LCOUNT:Ａ感覚 >= 3
			TALENT:LCOUNT:Ａ鈍感 = 0
		SIF ABL:LCOUNT:Ｂ感覚 >= 3
			TALENT:LCOUNT:Ｂ鈍感 = 0
		SIF ABL:LCOUNT:Ｍ感覚 >= 3
			TALENT:LCOUNT:Ｍ鈍感 = 0
	NEXT
	FLAG:29 = 81
ENDIF
;ＬＶのデフォ化
IF FLAG:29 == 81
	VARSET LOCAL
	IF FLAG:247 || FLAG:248 || FLAG:249 || ABL:MASTER:ＬＶ < FLAG:255
		PRINTFORML 今回のVERUPでLV制度を標準化＆変更するので、レベルリミッターの上限を合わせます
		LOCAL:247 = FLAG:247
		LOCAL:248 = FLAG:248
		LOCAL:249 = FLAG:249
		LOCAL:255 = ABL:MASTER:ＬＶ

		FLAG:247 = 0
		FLAG:248 = 0
		FLAG:249 = (FLAG:249 / 10) * 10
		ABL:MASTER:ＬＶ = FLAG:255
	ELSE
		PRINTFORML LV制度を標準化＆変更するので、LVの再計算を行います。
	ENDIF

	;MASTERのLVの再計算
	ABL:MASTER:ＬＶ = 0
	FOR LCOUNT, 0, CHARANUM
		CALL SET_LV_MUMA, LCOUNT
	NEXT
	FLAG:255 = ABL:MASTER:ＬＶ

	;MASTERのLVに基づく最小経験値算出（Extraの時）
	SIF NO:MASTER && FLAG:255 >= 2
		LOCAL = MAX(EXP_NEXTLV(MASTER, FLAG:255 - 1), EXP:MASTER:経験値)
	;攻略人数による最小経験値の概算値算出
	EXP:MASTER:経験値 = MAX(EXP:MASTER:経験値, FLAG:30*100 + LOCAL, FLAG:31*100 + LOCAL, (FLAG:30 + FLAG:31)*75 + LOCAL)

	;MASTERのLVの再設定
	CALL LVUPCHECK_MASTER

	FLAG:242 = 0

	;精力とストックと射精ゲージの再セット
	CALL SET_COUNTER_BASE
	CALL SETFLAG, "射精ゲージ", MASTER

	;レベルリミッターの再セット
	IF LOCAL:255
		SIF LOCAL:247 && LOCAL:247 < MAXBASE:MASTER:絶頂
			FLAG:247 = LOCAL:247
		SIF LOCAL:248 && LOCAL:248 < MAXBASE:MASTER:精力
			FLAG:248 = LOCAL:248
		SIF LOCAL:249 && LOCAL:249%10 - 1 < MAXBASE:MASTER:ストック
			FLAG:249 = LOCAL:249
		SIF LOCAL:255 && LOCAL:255 < FLAG:255
			ABL:MASTER:ＬＶ = LOCAL:255
	ENDIF

	FLAG:29 = 82
ENDIF
;素質：力持ち
IF FLAG:29 == 82
	FOR LCOUNT, 0, CHARANUM
		SELECTCASE CFLAG:LCOUNT:472
		CASE 7, 12, 22, 26, 28, 31, 34, 41
			TALENT:LCOUNT:力持ち = 1
		;ダーキニー
		CASE 14
			SIF CFLAG:LCOUNT:8 == 3
				TALENT:LCOUNT:力持ち = 1
		CASEELSE
			TALENT:LCOUNT:力持ち = 0
		ENDSELECT
		;クララの人気は除外
		SIF NO:LCOUNT == 46
			TALENT:LCOUNT:人気 = 0
	NEXT
	FLAG:29 = 83
ENDIF
;LVUPに必要な経験値の変更(今のＬＶに合わせる)
IF FLAG:29 == 83
	EXP:MASTER:経験値 = MAX(EXP_NEXTLV(MASTER, FLAG:255 - 1), EXP:MASTER:経験値)
	IF ABL:MASTER:ＬＶ >= FLAG:255
		ABL:MASTER:ＬＶ = MASTER_LV()
		FLAG:255 = ABL:MASTER:ＬＶ
	ENDIF
	FLAG:29 = 84
ENDIF
;幾つかの記憶をTCVARに変更
IF FLAG:29 == 84
	FOR LCOUNT, 0, CHARANUM
		FOR LOCAL, 700, 710
			CFLAG:LCOUNT:LOCAL = 0
		NEXT
		FOR LOCAL, 800, 900
			CFLAG:LCOUNT:LOCAL = 0
		NEXT
	NEXT
	FLAG:29 = 85
ENDIF
;従順が高いと反抗的が消える
IF FLAG:29 == 85
	FOR LCOUNT, 0, CHARANUM
		SIF ABL:LCOUNT:従順 >= 4 && MARK:LCOUNT:反発刻印 == 0
			TALENT:LCOUNT:反抗的 = 0
	NEXT
	FLAG:29 = 86
ENDIF
;アイテムの番号変更
IF FLAG:29 == 86
	VARSET LOCAL
	LOCAL:20 = ITEM:38
	LOCAL:21 = ITEM:46
	LOCAL:22 = ITEM:47
	LOCAL:23 = ITEM:48
	LOCAL:24 = ITEM:フランキンセンス
	LOCAL:25 = ITEM:元気になる薬
	LOCAL:26 = ITEM:53
	LOCAL:30 = ITEM:エプロン
	LOCAL:31 = ITEM:大鏡
	LOCAL:32 = ITEM:39
	LOCAL:33 = ITEM:拡張バルーン
	LOCAL:34 = ITEM:45
	LOCAL:35 = ITEM:赤いドロップ
	LOCAL:36 = ITEM:68
	LOCAL:40 = ITEM:☆技巧Lv
	LOCAL:41 = ITEM:☆てかげん
	LOCAL:42 = ITEM:☆汚れ無視
	LOCAL:79 = ITEM:54

	ITEM:ローズニルの詩集 = ITEM:43

	FOR LOCAL, 20, 90
		ITEM:LOCAL = MAX(LOCAL:LOCAL, 0)
	NEXT

	IF FLAG:256 + FLAG:257
		PRINTL アイテムの番号が変化したため、アイテムフィルタを初期化させます
		PRINTW 面倒だと思いますが、また設定しなおしてください
		FLAG:256 = 0
		FLAG:257 = 0
	ENDIF
	FLAG:29 = 87
ENDIF
;ドロレスって夢魔だよね…？
IF FLAG:29 == 87
	FOR LCOUNT, 0, CHARANUM
		IF NO:LCOUNT == 59
			SIF TALENT:夢魔 + TALENT:上位夢魔 == 0
				TALENT:LCOUNT:夢魔 = 1
		ENDIF
	NEXT
	FLAG:29 = 88
ENDIF
;妊娠関係のフラグ変更
IF FLAG:29 == 88
	FOR LCOUNT, 0, CHARANUM
		BASE:LCOUNT:陰毛 = CFLAG:LCOUNT:369*100 + CFLAG:LCOUNT:367
		BASE:LCOUNT:精液の優勢 = CFLAG:LCOUNT:480
		BASE:LCOUNT:胎児の父親 = CFLAG:LCOUNT:481
		BASE:LCOUNT:誕生日 = BASE:LCOUNT:バイオリズム
		BASE:LCOUNT:種族 = CFLAG:LCOUNT:472
		BASE:LCOUNT:父親 = CFLAG:LCOUNT:475
		BASE:LCOUNT:母親 = CFLAG:LCOUNT:476
		BASE:LCOUNT:何番目 = CFLAG:LCOUNT:473
		BASE:LCOUNT:世代 = CFLAG:LCOUNT:477

		IF CFLAG:LCOUNT:474
			TALENT:LCOUNT:出産経験 = CFLAG:LCOUNT:474
			SIF CFLAG:LCOUNT:467&512
				TALENT:LCOUNT:出産経験 += 1
		ENDIF

		;危険日と安全日フラグ消去
		CLEARBIT CFLAG:LCOUNT:467, 10
		CLEARBIT CFLAG:LCOUNT:467, 11

		;子育て中
		IF CFLAG:LCOUNT:467&512
			BASE:LCOUNT:育児中 = 2 + (CFLAG:LCOUNT:467%8)*2
			SIF CFLAG:LCOUNT:482 == 2
				BASE:LCOUNT:育児中 += 1
			CLEARBIT CFLAG:LCOUNT:467, 9
		ENDIF
		BASE:LCOUNT:胎児 += CFLAG:LCOUNT:483*2
		SIF CFLAG:LCOUNT:467&64
			BASE:LCOUNT:胎児 += 2
		SIF CFLAG:LCOUNT:467&128
			BASE:LCOUNT:胎児 += 128
		IF CFLAG:LCOUNT:467&256
			BASE:LCOUNT:胎児 = 1024 + BASE:LCOUNT:胎児%2
			TALENT:LCOUNT:妊娠 = 3
		ENDIF

		CFLAG:LCOUNT:367 = 0
		CFLAG:LCOUNT:369 = 0

		CFLAG:LCOUNT:467 = 0
		CFLAG:LCOUNT:472 = 0
		CFLAG:LCOUNT:473 = 0
		CFLAG:LCOUNT:474 = 0
		CFLAG:LCOUNT:475 = 0
		CFLAG:LCOUNT:476 = 0
		CFLAG:LCOUNT:477 = 0
		CFLAG:LCOUNT:478 = 0
		CFLAG:LCOUNT:480 = 0
		CFLAG:LCOUNT:481 = 0
		CFLAG:LCOUNT:483 = 0
	NEXT
	FLAG:29 = 89
ENDIF
;TALENT:内気0番台を消去
IF FLAG:29 == 89
	FOR LCOUNT, 0, CHARANUM
		FOR LOCAL, 140, 150
			TALENT:LCOUNT:LOCAL = 0
		NEXT
	NEXT
	FLAG:29 = 90
ENDIF
;指輪
IF FLAG:29 == 90
	ITEM:誓約の指輪 = 0
	FOR LOCAL, 1, CHARANUM
		SIF TALENT:LOCAL:相思相愛
			ITEM:誓約の指輪 += 1
	NEXT
	SIF ITEM:誓約の指輪 >= 2
		FLAG:241 |= 1
	FLAG:29 = 91
ENDIF
;ちょっとミス修正
IF FLAG:29 == 91
	FOR LCOUNT, 0, CHARANUM
		JUEL:LCOUNT:20 = 0
		JUEL:LCOUNT:21 = 0
		JUEL:LCOUNT:22 = 0
		JUEL:LCOUNT:23 = 0
		JUEL:LCOUNT:24 = 0
	NEXT
	FLAG:29 = 92
ENDIF
;着せ替えリセット
IF FLAG:29 == 92
	FLAG:242 = 0
	;夢魔化フラグをリセット
	IF FLAG:669
		FLAG:669 = 0
		PRINTL 夢魔変化パッチの内容が少々変わったので、関連するフラグをリセットします。
		PRINTW コンフィグを確認してみてください
	ENDIF

	FOR LCOUNT, 0, CHARANUM
		CALL COORDINATE_MUMA, LCOUNT
		CALL MEMO_FAVORITE_DRESS, LCOUNT
	NEXT
	FLAG:29 = 93
ENDIF
;胡蝶の夢はバグの宝庫やでぇ
IF FLAG:29 == 93
	;種族ごとの考えを設定
	FOR LCOUNT, 0, CHARANUM
		BASE:LCOUNT:種族思考 = BASE:LCOUNT:種族
	NEXT
	;胡蝶の夢
	IF ITEM:胡蝶の夢
		LOCAL:1 = FLAG:229/100
		LOCAL:2 = FLAG:229%100
		FOR LOCAL, 40, 60
			SWAP EQUIP:(LOCAL:1):LOCAL, EQUIP:(LOCAL:2):LOCAL
			SWAP CSTR:(LOCAL:1):LOCAL, CSTR:(LOCAL:2):LOCAL
		NEXT
		SWAP BASE:(LOCAL:1):種族思考, BASE:(LOCAL:2):種族思考
	ENDIF

	FLAG:29 = 94
ENDIF
;触手のフラグ変更
IF FLAG:29 == 94
	LOCAL:100 = 0
	FOR LOCAL, 80, 87
		SIF FLAG:LOCAL == 1
			SETBIT FLAG:80, LOCAL:100
		SIF FLAG:LOCAL == 9
			SETBIT FLAG:80, LOCAL:100+1
		LOCAL:100 += 2
	NEXT
	VARSET FLAG, 0, 81, 87
	FLAG:29 = 95
ENDIF
;アルカナなどの番号変更
IF FLAG:29 == 95
	FOR LCOUNT, 0, CHARANUM
		FOR LOCAL, 180, 190
			TALENT:LCOUNT:(LOCAL+50) = TALENT:LCOUNT:LOCAL
			TALENT:LCOUNT:LOCAL = 0
		NEXT
	NEXT

	FLAG:29 = 96
ENDIF
IF FLAG:29 == 96
	IF TALENT:MASTER:ストック
		PRINTFORML MASTERのストックの使用はとりあえず封印することとなりました。
		PRINTFORMW 代金を返却します。所持金+%MONEY_C(ITEMPRICE:85)%
		MONEY += ITEMPRICE:85
		TALENT:MASTER:ストック = 0
	ENDIF
	FLAG:29 = 97
ENDIF
;特技の仕組み変更
IF FLAG:29 == 97
	SIF FLAG:34&1
		TALENT:MASTER:舌使い = 3
	SIF FLAG:34&2
		TALENT:MASTER:指使い = 3
	SIF FLAG:34&4
		TALENT:MASTER:足使い = 3
	SIF FLAG:34&8
		TALENT:MASTER:腰使い = 3
	SIF FLAG:34&16
		TALENT:MASTER:魔乳 = 3
	FOR LCOUNT, 0, CHARANUM
		TALENT:LCOUNT:52 = 0
		CALL GET_EXABL, LCOUNT
	NEXT

	FLAG:29 = 98
ENDIF
;表示でデフォルトを禁止
IF FLAG:29 == 98
	IF FLAG:98 == 0
		FLAG:98 = 1
		PRINTFORML Emueraにおいてはパラメータ表示方式がデフォルトだとおかしくなることがあるため、
		PRINTFORML 勝手ながら表示をシンプルに変えさせていただきます。
		PRINTFORMW なお、表示方式を変えたいときには、[777]の 表示方式変更 で変更できます。
	ENDIF
	FLAG:29 = 99
ENDIF
;アナル正常位開放
IF FLAG:29 == 99
	DITEMTYPE:0:70 = 1
	DITEMTYPE:0:72 = 1
	DITEMTYPE:0:73 = 1
	DITEMTYPE:0:74 = 1
	PRINTW アナル挿入コマンドを開放しました。初期状態だと[350]の表示コマンド反転で隠してあります
	FLAG:29 = 100
ENDIF
;具現
IF FLAG:29 == 100
	FOR LCOUNT, 0, CHARANUM
		SIF NO:LCOUNT == 21
			TALENT:LCOUNT:具現 = 1
	NEXT

	FLAG:29 = 101
ENDIF
;感度の上限の引き上げ
IF FLAG:29 == 101
	FOR LCOUNT, 0, CHARANUM
		;CVABM感覚を(3,4,5)→(4,5,6)とする
		SIF ABL:LCOUNT:Ｃ感覚 >= 3
			ABL:LCOUNT:Ｃ感覚 += 1
		SIF ABL:LCOUNT:Ｖ感覚 >= 3
			ABL:LCOUNT:Ｖ感覚 += 1
		SIF ABL:LCOUNT:Ａ感覚 >= 3
			ABL:LCOUNT:Ａ感覚 += 1
		SIF ABL:LCOUNT:Ｂ感覚 >= 3
			ABL:LCOUNT:Ｂ感覚 += 1
		SIF ABL:LCOUNT:Ｍ感覚 >= 3
			ABL:LCOUNT:Ｍ感覚 += 1
	NEXT

	FLAG:29 = 102
ENDIF
;娘の胸の成長
IF FLAG:29 == 102
	FLAG:212 = 0
	IF FLAG:211
		PRINTL 娘の胸の成長をコンフィグの 妊娠パッチの使用状況 でON/OFFできるようにしました
		PRINTW 初期状態ではOFFとすることとします
	ENDIF
	FLAG:29 = 103
ENDIF
;感覚LVが10を越すのを直す
IF FLAG:29 <= 104
	FOR LCOUNT, 0, CHARANUM
		SIF ABL:LCOUNT:Ｃ感覚 >= 10
			ABL:LCOUNT:Ｃ感覚 = 10
		SIF ABL:LCOUNT:Ｖ感覚 >= 10
			ABL:LCOUNT:Ｖ感覚 = 10
		SIF ABL:LCOUNT:Ａ感覚 >= 10
			ABL:LCOUNT:Ａ感覚 = 10
		SIF ABL:LCOUNT:Ｂ感覚 >= 10
			ABL:LCOUNT:Ｂ感覚 = 10
		SIF ABL:LCOUNT:Ｍ感覚 >= 10
			ABL:LCOUNT:Ｍ感覚 = 10
	NEXT
	FLAG:29 = 105
ENDIF
;名器度を再計算
IF FLAG:29 == 105
	FOR LCOUNT, 0, CHARANUM
		CALL GET_EXABL2, LCOUNT
	NEXT
	FLAG:29 = 106
ENDIF
;サドっ気
IF FLAG:29 == 106
	FOR LCOUNT, 0, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 11, 21, 48, 57
			SIF ABL:LCOUNT:サドっ気 < 5
				TALENT:LCOUNT:サド = 0
		ENDSELECT
		SIF TALENT:LCOUNT:サド
			ABL:LCOUNT:サドっ気 = 5
		SIF TALENT:LCOUNT:マゾ
			ABL:LCOUNT:マゾっ気 = 5
	NEXT
	FLAG:29 = 107
ENDIF
;FLAGの管理ミス
IF FLAG:29 == 107
	IF FLAG:98 == 1
		FLAG:98 = 0
	ELSEIF FLAG:98 == 2
		FLAG:98 = 0
		SETBIT FLAG:98, 0
	ELSEIF FLAG:98 == 3
		FLAG:98 = 0
		SETBIT FLAG:98, 1
	ENDIF
	SETBIT FLAG:98, 2
	FLAG:29 = 108
ENDIF
;CFLAGの変更
IF FLAG:29 == 108
	FOR LCOUNT, 0, CHARANUM
		CFLAG:LCOUNT:310 = 0
		CFLAG:LCOUNT:338 = 0
	NEXT
	FLAG:29 = 109
ENDIF
;CFLAGの変更
IF FLAG:29 == 109
	FOR LCOUNT, 0, CHARANUM
		VARSET CFLAG:LCOUNT:0, 0, 700, 710

		SIF CFLAG:LCOUNT:271
			CALL SET_EV, LCOUNT, "Ｖ潤LV3突破"
		SIF CFLAG:LCOUNT:272
			CALL SET_EV, LCOUNT, "欲情LV3突破"
		SIF CFLAG:LCOUNT:273
			CALL SET_EV, LCOUNT, "恥情LV3突破"
		SIF CFLAG:LCOUNT:274
			CALL SET_EV, LCOUNT, "恐怖LV3突破"
		SIF CFLAG:LCOUNT:275
			CALL SET_EV, LCOUNT, "Ｃ絶頂"
		SIF CFLAG:LCOUNT:276
			CALL SET_EV, LCOUNT, "Ｖ絶頂"
		SIF CFLAG:LCOUNT:277
			CALL SET_EV, LCOUNT, "Ａ絶頂"
		SIF CFLAG:LCOUNT:278
			CALL SET_EV, LCOUNT, "Ｂ絶頂"
		SIF CFLAG:LCOUNT:279
			CALL SET_EV, LCOUNT, "処女喪失"
		SIF CFLAG:LCOUNT:280
			CALL SET_EV, LCOUNT, "絶頂：Ｖ中出し"
		SIF CFLAG:LCOUNT:281
			CALL SET_EV, LCOUNT, "絶頂：手"
		SIF CFLAG:LCOUNT:282
			CALL SET_EV, LCOUNT, "絶頂：口"
		SIF CFLAG:LCOUNT:283
			CALL SET_EV, LCOUNT, "射精した"
		SIF CFLAG:LCOUNT:284
			CALL SET_EV, LCOUNT, "噴乳した"
		SIF CFLAG:LCOUNT:285
			CALL SET_EV, LCOUNT, "Ｃ絶頂20回以上"
		SIF CFLAG:LCOUNT:286
			CALL SET_EV, LCOUNT, "Ｖ絶頂20回以上"
		SIF CFLAG:LCOUNT:287
			CALL SET_EV, LCOUNT, "Ａ絶頂20回以上"
		SIF CFLAG:LCOUNT:288
			CALL SET_EV, LCOUNT, "Ｂ絶頂20回以上"
		SIF CFLAG:LCOUNT:289
			CALL SET_EV, LCOUNT, "絶頂：胸"
		SIF CFLAG:LCOUNT:290
			CALL SET_EV, LCOUNT, "絶頂：Ａ中出し"
		SIF CFLAG:LCOUNT:291
			CALL SET_EV, LCOUNT, "絶頂：キス"
		SIF CFLAG:LCOUNT:292
			CALL SET_EV, LCOUNT, "絶頂：逆アナル"
		SIF CFLAG:LCOUNT:293
			CALL SET_EV, LCOUNT, "絶頂放尿"
		SIF CFLAG:LCOUNT:297
			CALL SET_EV, LCOUNT, "苦痛刻印Lv3取得"
		SIF CFLAG:LCOUNT:298
			CALL SET_EV, LCOUNT, "快楽刻印Lv3取得"
		SIF CFLAG:LCOUNT:299
			CALL SET_EV, LCOUNT, "屈服刻印Lv3取得"
		SIF CFLAG:LCOUNT:300
			CALL SET_EV, LCOUNT, "反発刻印Lv3取得"
		SIF CFLAG:LCOUNT:330
			CALL SET_EV, LCOUNT, "Ｃ焦らし"
		SIF CFLAG:LCOUNT:331
			CALL SET_EV, LCOUNT, "Ｖ焦らし"
		SIF CFLAG:LCOUNT:332
			CALL SET_EV, LCOUNT, "Ａ焦らし"
		SIF CFLAG:LCOUNT:333
			CALL SET_EV, LCOUNT, "Ｂ焦らし"
		SIF CFLAG:LCOUNT:334
			CALL SET_EV, LCOUNT, "射精焦らし"
		SIF CFLAG:LCOUNT:398
			CALL SET_EV, LCOUNT, "絶頂：脚"

		VARSET CFLAG:LCOUNT:0, 0, 271, 294
		VARSET CFLAG:LCOUNT:0, 0, 297, 301
		VARSET CFLAG:LCOUNT:0, 0, 330, 335
		CFLAG:LCOUNT:398 = 0

		CALL SET_CHOSECOM, LCOUNT, -1
		CALL RESET_CHOSECOM, LCOUNT
	NEXT
	FLAG:29 = 110
ENDIF
;ENDフラグ整備
IF FLAG:29 == 110
	SIF GETBIT(FLAG:1230, 0)
		SETBIT FLAG:1230, 1
	SIF GETBIT(FLAG:1241, 0)
		SETBIT FLAG:1241, 1
	FLAG:29 = 111
ENDIF
IF FLAG:29 == 111
	FLAG:7 = 2
	FLAG:29 = 112
ENDIF
;気品と粗野
IF FLAG:29 == 112
	FOR LCOUNT, 0, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 34
			TALENT:LCOUNT:粗野 = 1
		CASE 10
			SIF CFLAG:LCOUNT:8 == 2
				TALENT:LCOUNT:気品 = 1
		CASE 16
			SIF CFLAG:LCOUNT:8 == 3
				TALENT:LCOUNT:気品 = 1
		CASE 3, 24, 25, 49
			TALENT:LCOUNT:気品 = 1
		ENDSELECT

	NEXT
	FLAG:29 = 113
ENDIF
;粗野つけ忘れ＆ゴブリンのセレクタ対応
IF FLAG:29 == 113
	FOR LCOUNT, 0, CHARANUM
		SIF NO:LCOUNT == 7
			TALENT:LCOUNT:粗野 = 1
		IF NO:LCOUNT == 31
			TALENT:LCOUNT:粗野 = 1
			CFLAG:LCOUNT:209 = 1
		ENDIF
	NEXT
	FLAG:29 = 114
ENDIF
;やきもちフラグなど調整＆番号を1つずらしてみた
IF FLAG:29 == 114
	FLAG:252 = 0
	CVARSET CFLAG, 470, 0

	ADDCHARA 93
	FOR LOCAL, 1, CHARANUM
		LOCAL:1 = CHARANUM - LOCAL
		LOCAL:2 = LOCAL:1 - 1
		CALL SWAP_CHARA, LOCAL:1, LOCAL:2
	NEXT
	MASTER = 1
	FOR LOCAL, 2, CHARANUM
		SIF BASE:LOCAL:胎内精液量 && BASE:LOCAL:胎児 == 0 && COND("妊娠可能", LOCAL) && BASE:LOCAL:精液の優勢 == 0
			BASE:LOCAL:精液の優勢 = MASTER

		IF BASE:LOCAL:胎児 || BASE:LOCAL:育児中 || TALENT:LOCAL:妊娠 || TALENT:LOCAL:出産経験
			SIF BASE:LOCAL:精液の優勢 == 0
				BASE:LOCAL:精液の優勢 = MASTER
			SIF BASE:LOCAL:胎児の父親 == 0
				BASE:LOCAL:胎児の父親 = MASTER
		ENDIF
	NEXT
	FLAG:29 = 115
ENDIF
;ヴァンパイアのセレクタ対応
IF FLAG:29 <= 116
	FOR LCOUNT, 2, CHARANUM
		SIF NO:LCOUNT == 25 && CFLAG:LCOUNT:209 == 0
			CFLAG:LCOUNT:209 = 1
	NEXT
	FLAG:29 = 117
ENDIF
;やきもちのバグ
IF FLAG:29 == 117
	IF CONFIG("調教相手変更不可")
		IF GETCHARA(50) > MASTER
			TARGET = GETCHARA(50)
		ELSE
			FLAG:252 = 0
		ENDIF
	ENDIF
	FLAG:29 = 118
ENDIF
;喫茶店のフラグなど
IF FLAG:29 == 118
	MONEY:7 = FLAG:451
	MONEY:8 = FLAG:452
	FLAG:451 = 0
	FLAG:452 = 0
	FOR LCOUNT, 2, CHARANUM
		BASE:LCOUNT:欲求不満 = CFLAG:LCOUNT:498
		CFLAG:LCOUNT:498 = 0
	NEXT
	FLAG:29 = 119
ENDIF
IF FLAG:29 == 119
	FOR LCOUNT, 2, CHARANUM
		IF NO:LCOUNT == 25 && CFLAG:LCOUNT:209 == 2 && TALENT:LCOUNT:恋慕
			TALENT:LCOUNT:冷静 = 0
			TALENT:LCOUNT:陰気 = 0
			TALENT:LCOUNT:一線越えない = 0
			TALENT:LCOUNT:陽気 = 1
		ENDIF
	NEXT
	FLAG:29 = 120
ENDIF
IF FLAG:29 == 120
	FOR LCOUNT, 1, CHARANUM
		IF TALENT:LCOUNT:Ｍ鈍感 && TALENT:LCOUNT:Ｍ敏感
			TALENT:LCOUNT:Ｍ鈍感 = 0
			TALENT:LCOUNT:Ｍ敏感 = 0
		ENDIF
		IF TALENT:LCOUNT:Ｃ鈍感 && TALENT:LCOUNT:Ｃ敏感
			TALENT:LCOUNT:Ｃ鈍感 = 0
			TALENT:LCOUNT:Ｃ敏感 = 0
		ENDIF
		IF TALENT:LCOUNT:Ｖ鈍感 && TALENT:LCOUNT:Ｖ敏感
			TALENT:LCOUNT:Ｖ鈍感 = 0
			TALENT:LCOUNT:Ｖ敏感 = 0
		ENDIF
		IF TALENT:LCOUNT:Ａ鈍感 && TALENT:LCOUNT:Ａ敏感
			TALENT:LCOUNT:Ａ鈍感 = 0
			TALENT:LCOUNT:Ａ敏感 = 0
		ENDIF
		IF TALENT:LCOUNT:Ｂ鈍感 && TALENT:LCOUNT:Ｂ敏感
			TALENT:LCOUNT:Ｂ鈍感 = 0
			TALENT:LCOUNT:Ｂ敏感 = 0
		ENDIF
		SELECTCASE NO:LCOUNT
		CASE 28, 41, 44
			TALENT:LCOUNT:肌の色 = 1
		CASE 21
			TALENT:LCOUNT:肌の色 = 2
		CASE 3, 10
			SIF CFLAG:LCOUNT:8 != 2
				TALENT:LCOUNT:肌の色 = 1
		CASE 2, 15
			SIF CFLAG:LCOUNT:8 == 2
				TALENT:LCOUNT:肌の色 = 1
		CASE 6, 7, 14, 17
			SIF CFLAG:LCOUNT:8 == 3
				TALENT:LCOUNT:肌の色 = 1
		CASE 18
			SIF CFLAG:LCOUNT:8 == 4
				TALENT:LCOUNT:肌の色 = 1
		ENDSELECT
		IF NO:LCOUNT == 41
			TALENT:LCOUNT:動物足 = 8
		ELSEIF TALENT:LCOUNT:ハーピー
			TALENT:LCOUNT:動物足 = 11
		ELSE
			CONTINUE
		ENDIF
		CALL SET_SHOES, LCOUNT
		EQUIP:LCOUNT:57 = 0
	NEXT
	FLAG:29 = 121
ENDIF
;調教開始イベントのフラグ立て
IF FLAG:29 == 121
	FOR LCOUNT, 2, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 3
			IF CFLAG:LCOUNT:201 == 6
				CFLAG:LCOUNT:201 = 1+2+4+8+16+64
				CONTINUE
			ENDIF
		CASE 16
			IF TALENT:LCOUNT:小柄体型 && CFLAG:LCOUNT:201 >= 5
				CFLAG:LCOUNT:201 = 1+2+4+8+16
				IF CFLAG:LCOUNT:201 == 5
					SETBIT CFLAG:LCOUNT:201, 30
				ELSEIF CFLAG:LCOUNT:201 == 6
					SETBIT CFLAG:LCOUNT:201, 31
				ELSEIF CFLAG:LCOUNT:201 == 7
					SETBIT CFLAG:LCOUNT:201, 32
				ENDIF
				CONTINUE
			ELSEIF TALENT:LCOUNT:小柄体型 == 0 && CFLAG:LCOUNT:201 == 6
				CFLAG:LCOUNT:201 = 1+2+4+8+16
				CONTINUE
			ENDIF
		CASE 20, 21
			IF CFLAG:LCOUNT:201 == 6
				CFLAG:LCOUNT:201 = 1+2+4+8+16
				SETBIT CFLAG:LCOUNT:201, 30
				CONTINUE
			ENDIF
		CASE 24
			IF CFLAG:LCOUNT:209 == 1 && CFLAG:LCOUNT:201 >= 6
				CFLAG:LCOUNT:201 = 1+2+4+8+16
				SETBIT CFLAG:LCOUNT:201, 30
				CONTINUE
			ENDIF
		CASE 34
			IF CFLAG:LCOUNT:201 >= 2
				IF CFLAG:LCOUNT:201 == 2
					CFLAG:LCOUNT:201 = 1
				ELSEIF CFLAG:LCOUNT:201 == 3
					CFLAG:LCOUNT:201 = 1+2
				ELSEIF CFLAG:LCOUNT:201 == 4
					CFLAG:LCOUNT:201 = 1+2+4
				ELSEIF CFLAG:LCOUNT:201 == 6
					CFLAG:LCOUNT:201 = 1+2+4+8
				ELSEIF CFLAG:LCOUNT:201 == 7
					CFLAG:LCOUNT:201 = 1+2+4+8+16
				ENDIF
				SETBIT CFLAG:LCOUNT:201, 30
				CONTINUE
			ENDIF
		CASE 37
			IF CFLAG:LCOUNT:201 >= 6
				LOCAL = 1+2+4+8+16
				SIF CFLAG:LCOUNT:201 >= 6
					SETBIT LOCAL, 30
				SIF CFLAG:LCOUNT:201 >= 7
					SETBIT LOCAL, 31
				SIF CFLAG:LCOUNT:201 >= 8
					SETBIT LOCAL, 32
				SIF CFLAG:LCOUNT:201 >= 9
					SETBIT LOCAL, 33
				SIF CFLAG:LCOUNT:201 >= 10
					SETBIT LOCAL, 34
				CFLAG:LCOUNT:201 = LOCAL
				CONTINUE
			ENDIF
		CASE 97
			IF CFLAG:LCOUNT:209 == 857 && CFLAG:LCOUNT:201 >= 6
				CFLAG:LCOUNT:201 = 1+2+4+8+16
				SETBIT CFLAG:LCOUNT:201, 30
				CONTINUE
			ENDIF
		ENDSELECT

		SELECTCASE CFLAG:LCOUNT:201
		CASE 2
			CFLAG:LCOUNT:201 = 1+2
		CASE 3
			CFLAG:LCOUNT:201 = 1+2+4
		CASE 4
			CFLAG:LCOUNT:201 = 1+2+4+8
		CASE 5
			CFLAG:LCOUNT:201 = 1+2+4+8+16
		CASE 6
			CFLAG:LCOUNT:201 = 1+2+4+8+16+64
		CASE 7
			CFLAG:LCOUNT:201 = 1+2+4+8+16+64+128
		CASE 8
			CFLAG:LCOUNT:201 = 1+2+4+8+16+64+128+256
		ENDSELECT
	NEXT
	FLAG:29 = 122
ENDIF
IF FLAG:29 <= 124
	FOR LCOUNT, 1, CHARANUM
		CALL GET_EXABL, LCOUNT
	NEXT
	FLAG:29 = 125
ENDIF
IF FLAG:29 == 125
	FOR LCOUNT, 1, CHARANUM
		JUEL:LCOUNT:0 = MAX(JUEL:LCOUNT:0, 0)
		JUEL:LCOUNT:1 = MAX(JUEL:LCOUNT:1, 0)
		JUEL:LCOUNT:2 = MAX(JUEL:LCOUNT:2, 0)
		JUEL:LCOUNT:14 = MAX(JUEL:LCOUNT:14, 0)
		JUEL:LCOUNT:15 = MAX(JUEL:LCOUNT:15, 0)
	NEXT
	FLAG:29 = 126
ENDIF
IF FLAG:29 == 126
	FOR LCOUNT, 1, CHARANUM
		JUEL:LCOUNT:7 = MAX(JUEL:LCOUNT:7, 0)
	NEXT
	FLAG:29 = 127
ENDIF
IF FLAG:29 == 127
	FOR LCOUNT, 1, CHARANUM
		IF TALENT:LCOUNT:オトコ
			PRINTFORML %CALLNAME:LCOUNT%を"男の娘"にしますか？
			PRINTFORML [ 0] 男の娘にする\@ TALENT:LCOUNT:長身 ? (長身は失います) # \@
			PRINTFORML [ 1] 普通のオトコのままで良い
			CALL INPUT_SELECT, 2
			IF RESULT == 0
				TALENT:LCOUNT:男の娘 = 1
				TALENT:LCOUNT:長身 = 0
				CALL SET_3SIZE, LCOUNT
				PRINTFORMW %CALLNAME:LCOUNT%を"男の娘"にしました
			ENDIF
			PRINTL 
		ENDIF
	NEXT
	FLAG:29 = 128
ENDIF
IF FLAG:29 <= 129
	FOR LCOUNT, 1, CHARANUM
		SIF CFLAG:LCOUNT:209
			CONTINUE

		SELECTCASE NO:LCOUNT
		CASE 7
			CFLAG:LCOUNT:209 = 1
			TALENT:LCOUNT:動物足 = 2
			TALENT:LCOUNT:四足歩行 = 1
		CASE 10
			CFLAG:LCOUNT:209 = 1
			SIF CFLAG:LCOUNT:8 == 2
				CFLAG:LCOUNT:209 = 2
		CASE 17
			CFLAG:LCOUNT:209 = 1
		ENDSELECT
	NEXT
	FLAG:29 = 130
ENDIF
;売却と助手可能フラグをビット管理
IF FLAG:29 == 130
	FOR LCOUNT, 1, CHARANUM
		SIF CFLAG:LCOUNT:1 == 2
			CFLAG:LCOUNT:1 = 3
	NEXT
	FLAG:29 = 131
ENDIF
;寝取られフラグをちょっと変更
IF FLAG:29 == 131
	FOR LCOUNT, 1, CHARANUM
		IF GETBIT(CFLAG:LCOUNT:470, 4)
			SETBIT CFLAG:LCOUNT:470, 3
			CLEARBIT CFLAG:LCOUNT:470, 4
		ENDIF
	NEXT
	FLAG:29 = 132
ENDIF
;胸の成長システムなど変更
IF FLAG:29 == 132
	FOR LCOUNT, 1, CHARANUM
		SIF BASE:LCOUNT:バスト == 0
			CALL SET_3SIZE, LCOUNT

		SIF TALENT:LCOUNT:貧乳 && TALENT:LCOUNT:巨乳
			TALENT:LCOUNT:貧乳 = 0
		SIF CFLAG:LCOUNT:484 == 0
			CONTINUE
		IF GETBIT(CFLAG:LCOUNT:484, 10)
			SIF TALENT:LCOUNT:巨乳 == 0 && RAND:3 == 0
				TALENT:LCOUNT:将来性 = 1
		ELSEIF GETBIT(CFLAG:LCOUNT:484, 12)
			IF TALENT:LCOUNT:貧乳
				SIF RAND:3
					TALENT:LCOUNT:将来性 = 2
			ELSEIF TALENT:LCOUNT:巨乳 == 0
				SIF RAND:3
					TALENT:LCOUNT:将来性 = 1
			ENDIF
		ENDIF

		IF TALENT:LCOUNT:将来性
			CLEARBIT CFLAG:LCOUNT:484, 10
			CLEARBIT CFLAG:LCOUNT:484, 11
			CLEARBIT CFLAG:LCOUNT:484, 12
			CLEARBIT CFLAG:LCOUNT:484, 13
			CLEARBIT CFLAG:LCOUNT:484, 14
			CLEARBIT CFLAG:LCOUNT:484, 15

			CFLAG:LCOUNT:484 = MIN(CFLAG:LCOUNT:484&1023, 1000)
			IF TALENT:LCOUNT:妖精
				BASE:LCOUNT:バストの成長 += CFLAG:LCOUNT:484 / 20
			ELSE
				BASE:LCOUNT:バストの成長 += CFLAG:LCOUNT:484 / 10
			ENDIF
		ENDIF
		CFLAG:LCOUNT:484 = 0
		CFLAG:LCOUNT:485 = 0
	NEXT
	FLAG:29 = 133
ENDIF
;バストカップなどの補正
IF FLAG:29 == 133
	FOR LCOUNT, 1, CHARANUM
		;オトコ以外のカップの値などを補正
		IF BASE:LCOUNT:バスト && TALENT:LCOUNT:オトコ == 0
			IF TALENT:LCOUNT:巨乳 >= 2
				IF CALCF("バストカップ", CALCF("バストカップ計算値", LCOUNT) ) <= NUM("巨乳の上限")
					BASE:LCOUNT:バスト += 1
					IF CALCF("バストカップ", CALCF("バストカップ計算値", LCOUNT) ) <= NUM("巨乳の上限")
						LCOUNT -= 1
						CONTINUE
					ENDIF
				ENDIF
			ELSEIF TALENT:LCOUNT:巨乳
				IF CALCF("バストカップ", CALCF("バストカップ計算値", LCOUNT) ) <= NUM("並乳の上限")
					BASE:LCOUNT:バスト += 1
					IF CALCF("バストカップ", CALCF("バストカップ計算値", LCOUNT) ) <= NUM("並乳の上限")
						LCOUNT -= 1
						CONTINUE
					ENDIF
				ENDIF
			ELSEIF TALENT:LCOUNT:貧乳 == 0
				IF CALCF("バストカップ", CALCF("バストカップ計算値", LCOUNT) ) <= NUM("貧乳の上限")
					BASE:LCOUNT:バスト += 1
					IF CALCF("バストカップ", CALCF("バストカップ計算値", LCOUNT) ) <= NUM("貧乳の上限")
						LCOUNT -= 1
						CONTINUE
					ENDIF
				ENDIF
			ENDIF
			BASE:LCOUNT:カップ = CALCF("バストカップ", CALCF("バストカップ計算値", LCOUNT) )
		ENDIF
	NEXT
	FLAG:29 = 134
ENDIF
IF FLAG:29 == 134
	FOR LCOUNT, 1, CHARANUM
		IF GETBIT(CFLAG:LCOUNT:470, 4)
			SETBIT CFLAG:LCOUNT:470, 3
			CLEARBIT CFLAG:LCOUNT:470, 4
		ENDIF
		IF GETBIT(CFLAG:LCOUNT:4, 13)
			CLEARBIT CFLAG:LCOUNT:4, 13
			TALENT:LCOUNT:出産経験 = 1
		ENDIF
	NEXT
	FLAG:29 = 135
ENDIF
IF FLAG:29 == 135
	FOR LCOUNT, 1, CHARANUM
		SIF NO:LCOUNT == 9
			CFLAG:LCOUNT:209 = 1
	NEXT
	FLAG:29 = 136
ENDIF
IF FLAG:29 <= 138
	FOR LCOUNT, 1, CHARANUM
		IF NO:LCOUNT == 9 && CFLAG:LCOUNT:209 == 2
			TALENT:LCOUNT:恥じらい = 0
			TALENT:LCOUNT:一線越えない = 0
			TALENT:LCOUNT:目立ちたがり = 1
		ENDIF
	NEXT
	FLAG:29 = 139
ENDIF
IF FLAG:29 == 139
	FOR LCOUNT, 1, CHARANUM
		CFLAG:LCOUNT:6 = 0
		CFLAG:LCOUNT:486 = 0

		IF COND("子孫", LCOUNT)
			BASE:LCOUNT:誕生日 = MAX(BASE:LCOUNT:誕生日, DAY - 120)
			CFLAG:LCOUNT:484 = 0
			FOR LOCAL:1, 2, 10
				IF BASE:LCOUNT:父親 >= 0 || BASE:LCOUNT:母親 >= 0
					LOCAL = (BASE:LCOUNT:母親 >= 0) ? BASE:LCOUNT:母親 # BASE:LCOUNT:父親
					SIF TALENT:LOCAL:CALCF("成長後に変化する素質", LOCAL:1)
						SETBIT CFLAG:LCOUNT:484, LOCAL:1
				ELSE
					SIF CSVTALENT(BASE:LCOUNT:種族, CALCF("成長後に変化する素質", LOCAL:1), 0)
						SETBIT CFLAG:LCOUNT:484, LOCAL:1
				ENDIF
			NEXT
		ENDIF
		SIF BASE:LCOUNT:育児中
			CFLAG:LCOUNT:485 = DAY
	NEXT
	FLAG:29 = 140
ENDIF
IF FLAG:29 == 140
	IF NUM("所持店舗")
		VARSET SAVESTR, "", 2, 10
		FLAG:401 = 1
		SIF FLAG:402 == 1
			SETBIT FLAG:401, 1
		IF GETBIT(FLAG:403, 0)
			SETBIT FLAG:401, 10
		ELSEIF GETBIT(FLAG:403, 1)
			SETBIT FLAG:401, 11
		ENDIF
		VARSET FLAG, 0, 402, 450
	ENDIF
	FLAG:29 = 141
ENDIF
;身嗜み指示
IF FLAG:29 == 141
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE CFLAG:LCOUNT:368
		CASE 3
			CFLAG:LCOUNT:368 = 2
		CASE 5
			CFLAG:LCOUNT:368 = 4
		CASE 7
			CFLAG:LCOUNT:368 = 8
		ENDSELECT
	NEXT
	FLAG:29 = 142
ENDIF
;攻略刻印
IF FLAG:29 == 142
	FOR LCOUNT, 1, CHARANUM
		MARK:LCOUNT:攻略刻印 = MAX(CFLAG:LCOUNT:502 - 2, 0)
		SELECTCASE NO:LCOUNT
		CASE 34
			SELECTCASE CFLAG:LCOUNT:465
			CASE 1
				SETBIT CFLAG:LCOUNT:201, 30
			CASE 2
				SETBIT CFLAG:LCOUNT:201, 30
				SETBIT CFLAG:LCOUNT:201, 31
			CASE 3
				SETBIT CFLAG:LCOUNT:201, 30
				SETBIT CFLAG:LCOUNT:201, 31
				SETBIT CFLAG:LCOUNT:201, 32
			ENDSELECT
			IF CFLAG:LCOUNT:262 == 1
				SETBIT CFLAG:LCOUNT:201, 33
			ELSEIF CFLAG:LCOUNT:262 >= 2
				SETBIT CFLAG:LCOUNT:201, 34
			ENDIF
		CASE 37
			SIF GETBIT(CFLAG:LCOUNT:465, 0)
				SETBIT CFLAG:LCOUNT:201, 40
			SIF GETBIT(CFLAG:LCOUNT:465, 1)
				SETBIT CFLAG:LCOUNT:201, 41
			CFLAG:LCOUNT:465 = 0
		CASE 52
			CFLAG:LCOUNT:460 = 0
		ENDSELECT
		SIF EXP:LCOUNT:調教回数 && CFLAG:LCOUNT:209 == 0
			CFLAG:LCOUNT:209 = 1

		SIF MARK:LCOUNT:攻略刻印
			CONTINUE

		LOCAL = LCOUNT
		LOCAL:1 = TARGET
		TARGET = LCOUNT

		MARK:攻略刻印 += FIRST_EV("Ｃ絶頂") + FIRST_EV("Ｖ絶頂") + FIRST_EV("Ａ絶頂") + FIRST_EV("Ｂ絶頂") + FIRST_EV("Ｍ絶頂") + FIRST_EV("絶頂放尿")
		MARK:攻略刻印 += 2 * (FIRST_EV("Ｃ絶頂20回以上") + FIRST_EV("Ｖ絶頂20回以上") + FIRST_EV("Ａ絶頂20回以上") + FIRST_EV("Ｂ絶頂20回以上") + FIRST_EV("Ｍ絶頂20回以上") )

		TARGET = LOCAL:1
		LCOUNT = LOCAL
	NEXT
	CVARSET CFLAG, 502, 0
	FLAG:7 = 1
	FLAG:29 = 143
ENDIF
;好きな体位
IF FLAG:29 == 143
	FOR LCOUNT, 1, CHARANUM
		CALL CALC, "好きな体位", LCOUNT
	NEXT
	FLAG:29 = 144
ENDIF
;眷属
IF FLAG:29 == 144
	FOR LCOUNT, 1, CHARANUM
		SIF TALENT:LCOUNT:眷属 == -1
			TALENT:LCOUNT:眷属 = MASTER
	NEXT
	FLAG:29 = 145
ENDIF
IF FLAG:29 == 145
	FOR LCOUNT, 1, CHARANUM
		SIF GETBIT(CFLAG:LCOUNT:12, 8) || GETBIT(CFLAG:LCOUNT:12, 9)
			SETBIT CFLAG:LCOUNT:12, 7
		CLEARBIT CFLAG:LCOUNT:12, 8
		CLEARBIT CFLAG:LCOUNT:12, 9
	NEXT
	FLAG:29 = 146
ENDIF
IF FLAG:29 == 146
	FOR LCOUNT, 1, CHARANUM
		SIF NO:LCOUNT == 21
			CLEARBIT CFLAG:LCOUNT:201, 30
	NEXT
	FLAG:29 = 147
ENDIF
IF FLAG:29 == 147
	VARSET LOCALS
	FOR LOCAL, 1, CHARANUM
		CALL GET_EXTALENT, LOCAL
		SIF TALENT:LOCAL:吸精体質
			LOCALS = %LOCALS%[{LOCAL, 2}]%CALLNAME:LOCAL%、
	NEXT
	IF LOCALS != ""
		PRINTFORML %SUBSTRING(LOCALS, 0, STRLENS(LOCALS) - 2)%が素質[吸精体質]を得ました
		PRINTFORMW 精力が少ないと相手するのがきついかもしれませんので注意してください
	ENDIF
	FLAG:29 = 148
ENDIF
IF FLAG:29 == 148
	FOR LCOUNT, 1, CHARANUM
		CALL GET_EXABL2, LCOUNT
	NEXT
	FLAG:29 = 149
ENDIF
IF FLAG:29 == 149
	FOR LCOUNT, 1, CHARANUM
		FOR LOCAL, 700, 720
			SIF LOCAL == 700 || LOCAL == 710
				CONTINUE
			FOR LOCAL:1, 0, 64
				SIF GETBIT(CFLAG:LCOUNT:LOCAL, LOCAL:1) == 0
					CONTINUE
				IF LOCAL:1 - LOCAL%10 >= 0
					SETBIT CFLAG:LCOUNT:LOCAL, LOCAL:1 - LOCAL%10
				ELSE
					SETBIT CFLAG:LCOUNT:(LOCAL - 1), 64 + LOCAL:1 - LOCAL%10
				ENDIF
				CLEARBIT CFLAG:LCOUNT:LOCAL, LOCAL:1
			NEXT
		NEXT
	NEXT
	FLAG:29 = 150
ENDIF
;コンフィグの召喚事故に項目追加と画面表示のフラグ変更
IF FLAG:29 == 150
	SIF FLAG:221 == 2
		FLAG:221 = 3

	LOCAL = FLAG:98
	FLAG:98 = 0
	IF GETBIT(LOCAL, 0) || GETBIT(LOCAL, 1)
		SETBIT FLAG:98, 0
		PRINTFORML バーの表示を変更しました
		PRINTFORMW 詳しくはコンフィグの画面や各種ゲージの表示に関する設定をご覧下さい
	ENDIF
	SIF GETBIT(LOCAL, 1)
		SETBIT FLAG:98, 2
	SIF FLAG:259
		SETBIT FLAG:98, 1
	SIF FLAG:240 == 4
		SETBIT FLAG:98, 3
	FLAG:240 = 0
	FLAG:259 = 0

	FLAG:29 = 151
ENDIF
IF FLAG:29 == 151
	FOR LCOUNT, 1, CHARANUM
		CALL SET_OTHER, LCOUNT, BASE:LCOUNT:種族
	NEXT
	FLAG:29 = 152
ENDIF
IF FLAG:29 == 152
	FOR LCOUNT, 1, CHARANUM
		SIF BASE:LCOUNT:種族 == 43
			TALENT:LCOUNT:発情体質 = 1
	NEXT
	FLAG:29 = 153
ENDIF
IF FLAG:29 == 153
	DAY += 1
	FOR LCOUNT, 1, CHARANUM
		IF CFLAG:LCOUNT:97
			CLEARBIT CFLAG:LCOUNT:97, 16
			CFLAG:LCOUNT:97 = MIN(CFLAG:LCOUNT:97 + (FLAG:872 - 1)*120, DAY)
		ENDIF
	NEXT
	FLAG:29 = 154
ENDIF
IF FLAG:29 == 154
	FLAG:871 = (DAY - 1)%120 + 1
	FLAG:872 = (DAY+119)/120
	FLAG:873 = (FLAG:871 - 1) / 30
	FOR LCOUNT, 1, CHARANUM
		IF CFLAG:LCOUNT:97
			CLEARBIT CFLAG:LCOUNT:97, 16
			CFLAG:LCOUNT:97 = MIN(CFLAG:LCOUNT:97 + (FLAG:872 - 1)*120, DAY)
		ENDIF
	NEXT
	FLAG:29 = 155
ENDIF
IF FLAG:29 == 155
	FOR LCOUNT, 1, CHARANUM
		SIF CFLAG:LCOUNT:97 > DAY
			CFLAG:LCOUNT:97 = DAY
	NEXT
	FLAG:29 = 156
ENDIF
IF FLAG:29 == 156
	FOR LCOUNT, 1, CHARANUM
		CALL GET_EXTALENT, LCOUNT
	NEXT
	FLAG:29 = 157
ENDIF
;異常経験フラグ整理
IF FLAG:29 == 157
	FOR LCOUNT, 1, CHARANUM
		VARSET LOCAL
		LOCAL:11 = CFLAG:LCOUNT:11
		SIF GETBIT(CFLAG:LCOUNT:17, 0)
			SETBIT LOCAL:11, 20

		SIF GETBIT(CFLAG:LCOUNT:13, 10)
			SETBIT LOCAL:11, 30
		SIF GETBIT(CFLAG:LCOUNT:13, 11)
			SETBIT LOCAL:11, 31

		SIF GETBIT(CFLAG:LCOUNT:16, 3)
			EXP:LCOUNT:異常経験 -= 1
		SIF GETBIT(CFLAG:LCOUNT:16, 5)
			EXP:LCOUNT:異常経験 -= 1

		SIF GETBIT(CFLAG:LCOUNT:12, 1)
			SETBIT LOCAL:12, 0
		SIF GETBIT(CFLAG:LCOUNT:12, 4)
			SETBIT LOCAL:12, 1
		SIF GETBIT(CFLAG:LCOUNT:12, 5)
			SETBIT LOCAL:12, 2
		SIF GETBIT(CFLAG:LCOUNT:12, 6)
			SETBIT LOCAL:12, 3
		SIF GETBIT(CFLAG:LCOUNT:12, 7)
			SETBIT LOCAL:12, 4
		SIF GETBIT(CFLAG:LCOUNT:12, 2)
			SETBIT LOCAL:12, 5
		SIF GETBIT(CFLAG:LCOUNT:12, 3)
			SETBIT LOCAL:12, 6
		SIF GETBIT(CFLAG:LCOUNT:12, 10)
			SETBIT LOCAL:12, 7

		SIF GETBIT(CFLAG:LCOUNT:14, 0)
			SETBIT LOCAL:12, 8
		SIF GETBIT(CFLAG:LCOUNT:14, 1)
			SETBIT LOCAL:12, 9

		SIF GETBIT(CFLAG:LCOUNT:13, 0)
			SETBIT LOCAL:12, 10
		SIF GETBIT(CFLAG:LCOUNT:13, 1)
			SETBIT LOCAL:12, 11
		SIF GETBIT(CFLAG:LCOUNT:13, 2)
			SETBIT LOCAL:12, 12
		SIF GETBIT(CFLAG:LCOUNT:13, 3)
			SETBIT LOCAL:12, 13
		SIF GETBIT(CFLAG:LCOUNT:13, 4)
			SETBIT LOCAL:12, 14
		SIF GETBIT(CFLAG:LCOUNT:13, 5)
			SETBIT LOCAL:12, 15
		SIF GETBIT(CFLAG:LCOUNT:13, 6)
			SETBIT LOCAL:12, 16
		SIF GETBIT(CFLAG:LCOUNT:13, 7)
			SETBIT LOCAL:12, 17
		SIF GETBIT(CFLAG:LCOUNT:13, 8)
			SETBIT LOCAL:12, 18
		SIF GETBIT(CFLAG:LCOUNT:13, 9)
			SETBIT LOCAL:12, 19

		SIF GETBIT(CFLAG:LCOUNT:15, 0)
			SETBIT LOCAL:12, 20
		SIF GETBIT(CFLAG:LCOUNT:15, 1)
			SETBIT LOCAL:12, 21
		SIF GETBIT(CFLAG:LCOUNT:15, 2)
			SETBIT LOCAL:12, 22
		SIF GETBIT(CFLAG:LCOUNT:15, 3)
			SETBIT LOCAL:12, 23

		SIF GETBIT(CFLAG:LCOUNT:16, 0)
			SETBIT LOCAL:12, 24
		SIF GETBIT(CFLAG:LCOUNT:16, 1)
			SETBIT LOCAL:12, 25
		SIF GETBIT(CFLAG:LCOUNT:16, 2)
			SETBIT LOCAL:12, 26
		SIF GETBIT(CFLAG:LCOUNT:16, 4)
			EXP:LCOUNT:異常経験 -= 1
		SIF GETBIT(CFLAG:LCOUNT:16, 6)
			EXP:LCOUNT:異常経験 -= 1
		SIF GETBIT(CFLAG:LCOUNT:16, 7)
			EXP:LCOUNT:異常経験 -= 1
		SIF GETBIT(CFLAG:LCOUNT:16, 8)
			SETBIT LOCAL:12, 27
		SIF GETBIT(CFLAG:LCOUNT:16, 9)
			SETBIT LOCAL:12, 28
		SIF GETBIT(CFLAG:LCOUNT:16, 10)
			SETBIT LOCAL:12, 29

		CFLAG:LCOUNT:11 = LOCAL:11
		CFLAG:LCOUNT:12 = LOCAL:12
		CFLAG:LCOUNT:13 = 0
		CFLAG:LCOUNT:14 = 0
		CFLAG:LCOUNT:15 = 0
		CFLAG:LCOUNT:16 = 0
		CFLAG:LCOUNT:17 = 0
		SIF EXP:LCOUNT:異常経験 < 0
			EXP:LCOUNT:異常経験 = 0
	NEXT
	FLAG:29 = 158
ENDIF
;夢魔化のコンフィグのビットフラグ化
IF FLAG:29 == 158
	LOCAL = FLAG:227
	SELECTCASE FLAG:227
	CASE 1
		FLAG:227 = 1p0
	CASE 2
		FLAG:227 = 1p1
	CASE 3
		FLAG:227 = 1p1 + 1p2
	CASE 4
		FLAG:227 = 1p1 + 1p2 + 1p3
	ENDSELECT
	IF LOCAL >= 3
		PRINTFORML コンフィグの主人・助手の夢魔化の数値を変更しました
		PRINTFORML コンフィグのセーブデータ自体の数値も変更しますか？
		PRINTFORML [ 0] はい
		PRINTFORML [ 1] いいえ
		CALL INPUT_SELECT, 2
		IF RESULT == 0
			LOADGLOBAL
			GLOBAL:170 = FLAG:227
			SAVEGLOBAL
			PRINTW 変更しました
		ELSE
			PRINTW 変更はしません。古いコンフィグデータをロードする時には注意してください
		ENDIF
	ENDIF
	FLAG:29 = 159
ENDIF
;性転換フラグの小変更
IF FLAG:29 == 159
	FOR LCOUNT, 1, CHARANUM
		SIF CFLAG:LCOUNT:4 == 0
			CONTINUE

		LOCAL = CFLAG:LCOUNT:4
		CFLAG:LCOUNT:4 = 0
		IF TALENT:LCOUNT:オトコ
			SIF GETBIT(LOCAL, 0)
				SETBIT CFLAG:LCOUNT:4, 0
			SIF GETBIT(LOCAL, 1)
				SETBIT CFLAG:LCOUNT:4, 9
			SIF GETBIT(LOCAL, 2)
				SETBIT CFLAG:LCOUNT:4, 13
			SIF GETBIT(LOCAL, 3)
				SETBIT CFLAG:LCOUNT:4, 14
			SIF GETBIT(LOCAL, 4)
				SETBIT CFLAG:LCOUNT:4, 15
			SIF GETBIT(LOCAL, 5)
				SETBIT CFLAG:LCOUNT:4, 16
			SIF GETBIT(LOCAL, 7)
				SETBIT CFLAG:LCOUNT:4, 18
			SIF GETBIT(LOCAL, 8)
				SETBIT CFLAG:LCOUNT:4, 20
			SIF GETBIT(LOCAL, 9)
				TALENT:LCOUNT:具現 = 1
			SIF GETBIT(LOCAL, 10)
				SETBIT CFLAG:LCOUNT:4, 24
			SIF GETBIT(LOCAL, 11)
				SETBIT CFLAG:LCOUNT:4, 2
			SIF GETBIT(LOCAL, 12)
				SETBIT CFLAG:LCOUNT:4, 3
		ELSE
			SIF GETBIT(LOCAL, 0)
				SETBIT CFLAG:LCOUNT:4, 24
		ENDIF
	NEXT
	FLAG:29 = 160
ENDIF
;バインドの習得
IF FLAG:29 == 160
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 3
			TALENT:LCOUNT:バインド = 2
		CASE 10
			TALENT:LCOUNT:バインド = 3
		CASE 17
			TALENT:LCOUNT:バインド = 4
		CASE 18
			TALENT:LCOUNT:バインド = 5
		CASE 31
			TALENT:LCOUNT:バインド = 6
		CASE 34
			TALENT:LCOUNT:バインド = 7
		CASE 46
			TALENT:LCOUNT:バインド = 8
		CASE 21
			TALENT:LCOUNT:バインド = 1
		CASEELSE
			SIF TALENT:LCOUNT:魔法使い && ABL:LCOUNT:技巧 > RAND:10
				TALENT:LCOUNT:バインド = 1
		ENDSELECT
	NEXT
	FLAG:29 = 161
ENDIF
IF FLAG:29 == 161
	FOR LCOUNT, 1, CHARANUM
		IF NO:LCOUNT == 48 && CFLAG:LCOUNT:209 >= 2
			CFLAG:LCOUNT:209 = 2
			CLEARBIT CFLAG:LCOUNT:201, 41
		ENDIF
	NEXT
	FLAG:29 = 162
ENDIF
;いくつかの素質の管理
IF FLAG:29 == 162
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 3, 10, 13, 18, 19, 23, 27, 35, 42
			TALENT:LCOUNT:恥薄い = 0
		CASE 41
			TALENT:LCOUNT:快感に素直 = 1
		CASE 48
			TALENT:LCOUNT:恥薄い = 0
			TALENT:LCOUNT:濡れやすい = 0
			TALENT:LCOUNT:小悪魔 = 0
			TALENT:LCOUNT:Ｃ敏感 = 0
		ENDSELECT
	NEXT
	FLAG:29 = 163
ENDIF
;ピアス経験はなくす
IF FLAG:29 == 163
	FOR LCOUNT, 1, CHARANUM
		EXP:LCOUNT:ピアス経験 = 0
	NEXT
	FLAG:29 = 164
ENDIF
;いくつかの素質の管理
IF FLAG:29 == 164
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 41
			SIF TALENT:LCOUNT:汚臭鈍感 == 0 && TALENT:LCOUNT:汚れ無視 == 0
				TALENT:LCOUNT:汚臭敏感 = 1
		ENDSELECT
	NEXT
	FLAG:29 = 165
ENDIF
;アルカナの追加習得
IF FLAG:29 == 165
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 41
			TALENT:LCOUNT:バインド = 9
			TALENT:LCOUNT:アルスグン = 1
		ENDSELECT
	NEXT
	FLAG:29 = 166
ENDIF
;喫茶店の制服フラグ
IF FLAG:29 == 166
	IF FLAG:401
		LOCAL = 0
		IF GETBIT(FLAG:401, 1)
			LOCAL = 1
		ELSEIF GETBIT(FLAG:401, 2)
			LOCAL = 2
		ENDIF
		FLAG:401 = CLEARBITS(FLAG:401, 0, 9)
		SETBIT FLAG:401, LOCAL
	ENDIF
	FLAG:29 = 167
ENDIF
;調教知識整備
IF FLAG:29 == 167
	FOR LCOUNT, 1, CHARANUM
		CALL GET_EXTALENT, LCOUNT
	NEXT
	FLAG:29 = 168
ENDIF
;なぜかルヴィッサが小柄だったので普通化
IF FLAG:29 == 168
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 52
			CALL CALC, "普通体型化", LCOUNT
		ENDSELECT
	NEXT
	FLAG:29 = 169
ENDIF
;異常経験のSMを一時見送り
IF FLAG:29 == 169
	FOR LCOUNT, 1, CHARANUM
		SIF GETBIT(CFLAG:LCOUNT:12, 20) == 0
			CONTINUE
		CLEARBIT CFLAG:LCOUNT:12, 20
		EXP:LCOUNT:異常経験 -= 1
	NEXT
	FLAG:29 = 170
ENDIF
;素質によるＶＡ名器度
IF FLAG:29 == 170
	FOR LCOUNT, 1, CHARANUM
		CALL GET_EXABL, LCOUNT
	NEXT
	FLAG:29 = 171
ENDIF
IF FLAG:29 == 171
	SIF FLAG:5 != 9
		FLAG:5 = 1
	FLAG:29 = 172
ENDIF
;ＶＡ挿入or性交経験の是正
IF FLAG:29 == 172
	FOR LCOUNT, 1, CHARANUM
		IF TALENT:LCOUNT:オンナ && TALENT:LCOUNT:具現 == 0 && GETBIT(CFLAG:LCOUNT:12, 25) + GETBIT(CFLAG:LCOUNT:12, 28) + GETBIT(CFLAG:LCOUNT:12, 29) == 0
			EXP:LCOUNT:Ｖ挿入経験 = 0
			EXP:LCOUNT:Ａ挿入経験 = 0
		ENDIF
	NEXT
	FLAG:29 = 173
ENDIF
;ドラ姦イベントフラグ修正
IF FLAG:29 == 173
	FOR LCOUNT, 1, CHARANUM
		IF EXP:LCOUNT:Ｖ竜姦経験 == 0
			CFLAG:LCOUNT:470 = 0
			CFLAG:LCOUNT:471 = 0
			CFLAG:LCOUNT:472 = 0
		ENDIF
	NEXT
	FLAG:29 = 174
ENDIF
;夢魔化イベントのフラグ変更
IF FLAG:29 == 174
	LOCAL = FLAG:226
	SELECTCASE FLAG:226
	CASE 0
		FLAG:226 = 1p0 + 1p1
	CASE 1
		FLAG:226 = 1p0
	CASE 2
		FLAG:226 = 1p0 + 1p1 + 1p2
	ENDSELECT

	SIF GETBIT(FLAG:227, 1)
		SETBIT FLAG:227, 0
	SIF FLAG:227
		INVERTBIT FLAG:227, 3

	IF LOCAL >= 2 || FLAG:227
		PRINTFORML コンフィグの夢魔化の数値を変更しました
		PRINTFORML コンフィグのセーブデータ自体の数値も変更しますか？
		PRINTFORML [ 0] はい
		PRINTFORML [ 1] いいえ
		CALL INPUT_SELECT, 2
		IF RESULT == 0
			LOADGLOBAL
			GLOBAL:169 = FLAG:226
			GLOBAL:170 = FLAG:227
			SAVEGLOBAL
			PRINTW 変更しました
		ELSE
			PRINTW 変更はしません。古いコンフィグデータをロードする時には注意してください
		ENDIF
	ENDIF
	FLAG:29 = 175
ENDIF
;肌の色フラグ変更
IF FLAG:29 == 175
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE TALENT:LCOUNT:肌の色
		CASE 2
			TALENT:LCOUNT:肌の色 = 1
		CASE 4
			TALENT:LCOUNT:肌の色 = 2
		ENDSELECT
	NEXT
	FLAG:29 = 176
ENDIF
IF FLAG:29 == 176
	IF GETBIT(FLAG:9, 9)
		CLEARBIT FLAG:9, 9
		SETBIT FLAG:9, 11
	ENDIF
	IF GETBIT(FLAG:9, 10)
		CLEARBIT FLAG:9, 10
		SETBIT FLAG:9, 12
	ENDIF
	FLAG:29 = 177
ENDIF
;ジャブジャブは陽気
IF FLAG:29 == 177
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 43
			TALENT:LCOUNT:陽気 = 1
		ENDSELECT
	NEXT
	FLAG:29 = 178
ENDIF
;アイテム番号小変更
IF FLAG:29 == 178
	ITEM:302 = ITEM:305
	ITEM:303 = ITEM:306
	ITEM:304 = ITEM:310
	ITEM:305 = ITEM:311
	ITEM:306 = 0
	ITEM:310 = ITEM:315
	ITEM:311 = 0
	ITEM:315 = 0

	FOR LCOUNT, 1, CHARANUM
		SIF EQUIP:LCOUNT:アクセサリ == 0
			CONTINUE
		CLEARBIT EQUIP:LCOUNT:アクセサリ, 19
		CLEARBIT EQUIP:LCOUNT:アクセサリ, 29
		CLEARBIT EQUIP:LCOUNT:アクセサリ, 39
	NEXT
	FLAG:29 = 179
ENDIF
;使用するフラグを念のため初期化
IF FLAG:29 == 179
	CVARSET CFLAG, 30, 0
	FLAG:29 = 180
ENDIF
;抵抗とか
IF FLAG:29 == 180
	FOR LCOUNT, 1, CHARANUM
		SIF TALENT:LCOUNT:抑圧 == 0 && TALENT:LCOUNT:抵抗 == 0
			CONTINUE
		SIF ABL:LCOUNT:従順 < 4 && TALENT:LCOUNT:恋慕 == 0 && ABL:LCOUNT:欲望 < 3 && TALENT:LCOUNT:淫乱 == 0
			CONTINUE

		TALENT:LCOUNT:抑圧 = 0
		TALENT:LCOUNT:抵抗 = 0
		JUEL:LCOUNT:100 /= 2
	NEXT
	FLAG:29 = 181
ENDIF
;助手ＬＶの設定ミス
IF FLAG:29 == 181
	FOR LCOUNT, 1, CHARANUM
		SIF ABL:LCOUNT:助手 > 5
			ABL:LCOUNT:助手 = 5
	NEXT
	FLAG:29 = 182
ENDIF
IF FLAG:29 == 182
	SIF DITEMTYPE:0:65 == 2
		DITEMTYPE:0:65 = 1
	FLAG:29 = 183
ENDIF
IF FLAG:29 == 183
	CLEARBIT FLAG:98, 1
	FLAG:29 = 184
ENDIF
;アルカナ覚える際の計算ミス修正
IF FLAG:29 == 184
	FOR LCOUNT, 1, CHARANUM
		SIF JUEL:LCOUNT:習得 < 0
			JUEL:LCOUNT:習得 += 5000
	NEXT
	FLAG:29 = 185
ENDIF
;いくつか初期素質などの変更
IF FLAG:29 == 185
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 27, 35
			IF TALENT:LCOUNT:謎の魅力
				TALENT:LCOUNT:謎の魅力 = 0
				TALENT:LCOUNT:魅惑 = 1
			ENDIF
		CASE 48
			TALENT:LCOUNT:謎の魅力 = 0
			TALENT:LCOUNT:一線越えない = 0
		CASE 54
			TALENT:LCOUNT:謎の魅力 = 0
		ENDSELECT
	NEXT
	FLAG:29 = 186
ENDIF
;妊娠パッチのフラグ変更
IF FLAG:29 == 186
	IF FLAG:211
		LOCAL = FLAG:211
		FLAG:211 = 1
		SIF LOCAL == 1
			SETBIT FLAG:211, 1
		SIF FLAG:212
			SETBIT FLAG:211, 4
		IF FLAG:213 == 2
			SETBIT FLAG:211, 2
			CLEARBIT FLAG:211, 1
		ENDIF
		SIF FLAG:214
			SETBIT FLAG:211, 3

		PRINTFORML コンフィグの妊娠パッチ部分の数値を変更しました
		PRINTFORML コンフィグのセーブデータ自体の数値も変更しますか？
		PRINTFORML [ 0] はい
		PRINTFORML [ 1] いいえ
		CALL INPUT_SELECT, 2
		IF RESULT == 0
			LOADGLOBAL
			GLOBAL:120 = FLAG:211
			GLOBAL:121 = 0
			GLOBAL:122 = 0
			GLOBAL:123 = 0
			SAVEGLOBAL
			PRINTW 変更しました
		ELSE
			PRINTW 変更はしません。古いコンフィグデータをロードする時には注意してください
		ENDIF
	ENDIF
	FLAG:212 = 0
	FLAG:213 = 0
	FLAG:214 = 0
	FLAG:29 = 187
ENDIF
;妊娠イベントのフラグ変更
IF FLAG:29 == 187
	FOR LCOUNT, 1, CHARANUM
		IF BASE:LCOUNT:胎児
			LOCAL = BASE:LCOUNT:胎児
			BASE:LCOUNT:胎児 = GETBITS(LOCAL, 1, 5)/2 + GETBITS(LOCAL, 6, 10)
			SIF GETBIT(LOCAL, 0)
				SETBIT BASE:LCOUNT:胎児, 20
		ENDIF
		IF BASE:LCOUNT:育児中
			LOCAL = BASE:LCOUNT:育児中
			BASE:LCOUNT:育児中 = GETBITS(LOCAL, 1, 5)/2 + GETBITS(LOCAL, 6, 10)
			SIF GETBIT(LOCAL, 0)
				SETBIT BASE:LCOUNT:育児中, 20
		ENDIF
	NEXT
	FLAG:29 = 188
ENDIF
IF FLAG:29 == 188
	FOR LCOUNT, 0, CHARANUM
		CALL GET_EXABL2, LCOUNT
	NEXT
	FLAG:29 = 189
ENDIF
IF FLAG:29 == 189
	FOR LCOUNT, 0, CHARANUM
		SIF EQUIP:LCOUNT:アクセサリ == 0
			CONTINUE
		FOR LOCAL, 30, 64
			IF GETBIT(EQUIP:LCOUNT:アクセサリ, LOCAL)
				CLEARBIT EQUIP:LCOUNT:アクセサリ, LOCAL
				SETBIT EQUIP:LCOUNT:アクセサリ, LOCAL - 5
			ENDIF
		NEXT
		CSTR:LCOUNT:49 = %CSTR:LCOUNT:49%\/
	NEXT
	FLAG:29 = 190
ENDIF
IF FLAG:29 == 190
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 16
			CFLAG:LCOUNT:466 = 0
			CLEARBIT CFLAG:LCOUNT:201, 55
		ENDSELECT
	NEXT
	FLAG:29 = 191
ENDIF
IF FLAG:29 == 191
	FOR LCOUNT, 1, CHARANUM
		BASE:LCOUNT:眷属 = TALENT:LCOUNT:眷属
	NEXT
	FLAG:29 = 192
ENDIF
IF FLAG:29 == 192
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 30
			CFLAG:LCOUNT:459 = CFLAG:LCOUNT:458
			CFLAG:LCOUNT:458 = 0
		ENDSELECT
	NEXT
	FLAG:29 = 193
ENDIF
IF FLAG:29 == 193
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 16
			IF CFLAG:LCOUNT:466 == 100
				CFLAG:LCOUNT:466 = 0
				CLEARBIT CFLAG:LCOUNT:201, 55
			ENDIF
		ENDSELECT
	NEXT
	FLAG:29 = 194
ENDIF
;コマンド変更に伴う以前のフィルタの撤回
IF FLAG:29 == 194
	DITEMTYPE:0:138 = 0
	FLAG:29 = 195
ENDIF
;探索での調合の複雑さを無くす
IF FLAG:29 == 195
	LOCAL = ITEM:淫魔の雫
	FOR LCOUNT, 351, 370
		ITEM:淫魔の雫 = MIN(ITEM:淫魔の雫 + ITEM:LCOUNT*5, 999)
		ITEM:LCOUNT = 0
	NEXT
	IF ITEM:淫魔の雫 > LOCAL
		PRINTFORML 探索で入手した素材を用いた調合は煩雑だったため、淫魔の雫とお金でのみ行う事とします
		PRINTFORML なお、淫魔の雫以外の素材一つにつき淫魔の雫を5個増やしておきます(最大所持数は999)
		PRINTFORMW ＜淫魔の雫が{ITEM:淫魔の雫 - LOCAL}個増えて、{ITEM:淫魔の雫}個になりました＞
	ENDIF
	FLAG:29 = 196
ENDIF
;巨尻の素質化
IF FLAG:29 <= 197
	FOR LCOUNT, 1, CHARANUM
		CALL SET_3SIZE, LCOUNT
	NEXT
	FLAG:29 = 198
ENDIF
;妊娠判定の見逃し修正
IF FLAG:29 == 198
	FOR LCOUNT, 1, CHARANUM
		SIF BASE:LCOUNT:精液の優勢 >= CHARANUM
			BASE:LCOUNT:精液の優勢 = -4
		SIF BASE:LCOUNT:胎児の父親 >= CHARANUM
			BASE:LCOUNT:胎児の父親 = -4
	NEXT
	FLAG:29 = 199
ENDIF
;バイオリズムのビット変更
IF FLAG:29 == 199
	FOR LCOUNT, 1, CHARANUM
		IF COND("妊娠可能", LCOUNT) == 0 || TALENT:LCOUNT:スライム
			BASE:LCOUNT:バイオリズム = 0
			CONTINUE
		ENDIF
		BASE:LCOUNT:バイオリズム = ABS(BASE:LCOUNT:誕生日%10 - DAY%10 + 10) % 10
	NEXT
	CALL SETFLAG, "安全危険日判定"
	FLAG:29 = 200
ENDIF
;胎内精液量の内訳変更
IF FLAG:29 == 200
	FOR LCOUNT, 1, CHARANUM
		BASE:LCOUNT:胎内精液量 += BASE:LCOUNT:胎内精子量*99
	NEXT
	FLAG:29 = 201
ENDIF
IF FLAG:29 == 201
	FOR LCOUNT, 1, CHARANUM
		IF EXP:LCOUNT:Ａ性交経験
			EXP:LCOUNT:異常経験 += 1
			SETBIT CFLAG:LCOUNT:11, 32
		ENDIF
	NEXT
	FLAG:29 = 202
ENDIF
;助手フラグの整理
IF FLAG:29 == 202
	FOR LCOUNT, 1, CHARANUM
		SIF GETBIT(CFLAG:LCOUNT:36, 0)
			SETBIT CFLAG:LCOUNT:35, 20
		SIF GETBIT(CFLAG:LCOUNT:36, 1)
			SETBIT CFLAG:LCOUNT:35, 21
		SIF GETBIT(CFLAG:LCOUNT:36, 2)
			SETBIT CFLAG:LCOUNT:35, 22
		SIF GETBIT(CFLAG:LCOUNT:36, 3)
			SETBIT CFLAG:LCOUNT:35, 23
		SIF GETBIT(CFLAG:LCOUNT:36, 4)
			SETBIT CFLAG:LCOUNT:35, 24
		SIF GETBIT(CFLAG:LCOUNT:36, 5)
			SETBIT CFLAG:LCOUNT:35, 25
		SIF GETBIT(CFLAG:LCOUNT:36, 6)
			SETBIT CFLAG:LCOUNT:35, 26
		SIF GETBIT(CFLAG:LCOUNT:37, 0)
			SETBIT CFLAG:LCOUNT:35, 30
		SIF GETBIT(CFLAG:LCOUNT:37, 1)
			SETBIT CFLAG:LCOUNT:35, 31
		SIF GETBIT(CFLAG:LCOUNT:37, 2)
			SETBIT CFLAG:LCOUNT:35, 32
		SIF GETBIT(CFLAG:LCOUNT:37, 10)
			SETBIT CFLAG:LCOUNT:35, 35
		SIF GETBIT(CFLAG:LCOUNT:37, 11)
			SETBIT CFLAG:LCOUNT:35, 36
		SIF GETBIT(CFLAG:LCOUNT:38, 0)
			SETBIT CFLAG:LCOUNT:35, 40
		SIF GETBIT(CFLAG:LCOUNT:38, 1)
			SETBIT CFLAG:LCOUNT:35, 41
		SIF GETBIT(CFLAG:LCOUNT:38, 5)
			SETBIT CFLAG:LCOUNT:35, 45
		SIF GETBIT(CFLAG:LCOUNT:38, 10)
			SETBIT CFLAG:LCOUNT:35, 27
		CFLAG:LCOUNT:36 = 0
		CFLAG:LCOUNT:37 = 0
		CFLAG:LCOUNT:38 = 0
		CFLAG:LCOUNT:39 = 0
	NEXT
	FLAG:29 = 203
ENDIF
;アクセサリフラグちょっと変更
IF FLAG:29 == 203
	FOR LCOUNT, 300, 390
		SELECTCASE FLAG:LCOUNT
		CASE 20010
			FLAG:LCOUNT = 20001
		CASE 20020
			FLAG:LCOUNT = 20002
		CASE 20030
			FLAG:LCOUNT = 20003
		ENDSELECT
	NEXT
	CALL ACCESSORY_SET_TALENT

	FLAG:29 = 204
ENDIF
;Ｈな下着をリネーム
IF FLAG:29 == 204
	FOR LCOUNT, 1, CHARANUM
		SIF CHECK_PANTIES("超Ｈ", LCOUNT)
			CALL RENAME_PANTIES, LCOUNT
		SIF CHECK_BRA("超Ｈ", LCOUNT)
			CALL RENAME_BRA, LCOUNT
	NEXT

	FLAG:29 = 205
ENDIF
;否定の珠を反感の珠に変更
IF FLAG:29 == 205
	FOR LCOUNT, 1, CHARANUM
		JUEL:LCOUNT:11 = JUEL:LCOUNT:100
		JUEL:LCOUNT:100 = 0
	NEXT

	FLAG:29 = 206
ENDIF
;ミミックのフラグ変更
IF FLAG:29 == 206
	FOR LCOUNT, 1, CHARANUM
		SIF NO:LCOUNT != 33
			CONTINUE

		SIF TALENT:LCOUNT:夢魔 == 0
			SETBIT CFLAG:LCOUNT:201, 30
		SIF TALENT:LCOUNT:上位夢魔 == 0
			SETBIT CFLAG:LCOUNT:201, 31
		SIF GETBIT(CFLAG:LCOUNT:203, 0)
			SETBIT CFLAG:LCOUNT:201, 32
		SIF GETBIT(CFLAG:LCOUNT:203, 1)
			SETBIT CFLAG:LCOUNT:201, 33
		SIF GETBIT(CFLAG:LCOUNT:203, 2)
			SETBIT CFLAG:LCOUNT:201, 34
		SIF GETBIT(CFLAG:LCOUNT:203, 3)
			SETBIT CFLAG:LCOUNT:201, 35
		CFLAG:LCOUNT:203 = 0
	NEXT

	FLAG:29 = 207
ENDIF
;温泉フラグの修正
IF FLAG:29 == 207
	FLAG:62 = MAX(FLAG:62, 0)

	FLAG:29 = 208
ENDIF
;Ｅｘモードの扱いの変更
IF FLAG:29 == 208
	FLAG:5 = 0

	FLAG:29 = 209
ENDIF
;キャラ間の識別フラグ変更
IF FLAG:29 == 209
	FOR LCOUNT, 1, CHARANUM
		;キャラ独自の識別番号を設置
		CALL SETFLAG, "識別番号", LCOUNT
	NEXT
	;キャラ指定方法を識別番号方式に変更
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE BASE:LCOUNT:父親
		CASE IS >= CHARANUM
			BASE:LCOUNT:父親 = -1
		CASE IS > 0
			BASE:LCOUNT:父親 = BASE:(BASE:LCOUNT:父親):識別番号
		ENDSELECT

		SELECTCASE BASE:LCOUNT:母親
		CASE IS >= CHARANUM
			BASE:LCOUNT:母親 = -1
		CASE IS > 0
			BASE:LCOUNT:母親 = BASE:(BASE:LCOUNT:母親):識別番号
		ENDSELECT

		SELECTCASE BASE:LCOUNT:精液の優勢
		CASE IS >= CHARANUM
			BASE:LCOUNT:精液の優勢 = -1
		CASE IS > 0
			BASE:LCOUNT:精液の優勢 = BASE:(BASE:LCOUNT:精液の優勢):識別番号
		ENDSELECT

		SELECTCASE BASE:LCOUNT:胎児の父親
		CASE IS >= CHARANUM
			BASE:LCOUNT:胎児の父親 = -1
		CASE IS > 0
			BASE:LCOUNT:胎児の父親 = BASE:(BASE:LCOUNT:胎児の父親):識別番号
		ENDSELECT

		SELECTCASE TALENT:LCOUNT:眷属
		CASE IS >= CHARANUM
			TALENT:LCOUNT:眷属 = 0
		CASE IS > 0
			BASE:LCOUNT:眷属 = BASE:(TALENT:LCOUNT:眷属):種族
			TALENT:LCOUNT:眷属 = BASE:(TALENT:LCOUNT:眷属):識別番号
		CASEELSE
			TALENT:LCOUNT:眷属 = 0
		ENDSELECT
	NEXT

	FLAG:29 = 210
ENDIF
;胡蝶の夢のフラグ変更
IF FLAG:29 == 210
	IF ITEM:胡蝶の夢
		LOCAL = FLAG:229/100
		LOCAL:1 = FLAG:229%100
		BASE:LOCAL:胡蝶の夢 = BASE:(LOCAL:1):識別番号
		BASE:(LOCAL:1):胡蝶の夢 = BASE:LOCAL:識別番号
	ENDIF

	FLAG:29 = 211
ENDIF
;温泉フラグを変更
IF FLAG:29 == 211
	IF FLAG:60
		SIF FLAG:61
			SETBIT CFLAG:(FLAG:61):70, 0
		SIF FLAG:62 > 0
			SETBIT CFLAG:(FLAG:62):70, 1
		FLAG:61 = 0
		FLAG:62 = 0
	ENDIF
	FLAG:29 = 212
ENDIF
;続・温泉フラグを修正
IF FLAG:29 == 212
	SIF FLAG:60 == 0
		CVARSET CFLAG, 70, 0

	FLAG:29 = 213
ENDIF
;エクストラフラグ修正忘れ
IF FLAG:29 == 213
	FLAG:5 = 0

	FLAG:29 = 214
ENDIF
;胡蝶の夢と眷属フラグ変更
IF FLAG:29 == 214
	;今までは片方しか見られなかったので今まで使っていたフラグは消去
	CVARSET CFLAG, 463, 0

	FLAG:29 = 215
ENDIF
;眷族のフラグミス修正
IF FLAG:29 == 215
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE TALENT:LCOUNT:眷属
		CASE IS <= 0
			TALENT:LCOUNT:眷属 = 0
		CASE IS >= CHARANUM

		CASEELSE
			TALENT:LCOUNT:眷属 = BASE:(TALENT:LCOUNT:眷属):識別番号
		ENDSELECT
	NEXT

	FLAG:29 = 216
ENDIF
;レベルリミッターのルール変更
IF FLAG:29 == 216
	SIF FLAG:247 + FLAG:248 + FLAG:249 || ABL:MASTER:ＬＶ < FLAG:255
		PRINTFORMW レベルリミッターの仕組みを変更しました
	FLAG:247 = 0
	FLAG:248 = 0
	FLAG:249 = 0
	ABL:MASTER:ＬＶ = FLAG:255

	FLAG:29 = 217
ENDIF
;レベルリミッターのルール変更 その２
IF FLAG:29 == 217
	CALL SETFLAG, "レベルリミッター"
	CALL SETFLAG, "射精ゲージ", MASTER

	FLAG:29 = 218
ENDIF
;EXP:胎内精液経験をBASE:胎児への栄養に変更
IF FLAG:29 == 218
	FOR LCOUNT, 1, CHARANUM
		BASE:LCOUNT:胎児への栄養 = EXP:LCOUNT:63
		EXP:LCOUNT:63 = 0
	NEXT

	FLAG:29 = 219
ENDIF
;主人への屈服刻印を設定
IF FLAG:29 == 219
	IF MARK:MASTER:屈服刻印
		FOR LCOUNT, 2, CHARANUM
			SELECTCASE NO:LCOUNT
			CASE 16
				SELECTCASE CFLAG:LCOUNT:460
				CASE IS > 15
					MARK:LCOUNT:主人屈服刻印 = 3
				CASE IS > 10
					MARK:LCOUNT:主人屈服刻印 = 2
				CASE IS > 5
					MARK:LCOUNT:主人屈服刻印 = 1
				ENDSELECT
			CASE 21
				SIF CFLAG:LCOUNT:460
					MARK:LCOUNT:主人屈服刻印 = MARK:MASTER:屈服刻印
			CASE 50
				SIF GETBITS(CFLAG:LCOUNT:201, 25, 26)
					MARK:LCOUNT:主人屈服刻印 = 3
			ENDSELECT
		NEXT
		MARK:MASTER:屈服刻印 = 0
		PRINTFORML %NAME:MASTER%の屈服刻印の方式をキャラごとのものに変換しました
	ENDIF
	FLAG:29 = 220
ENDIF
;スライムの妊娠フラグのミス解消
IF FLAG:29 == 220
	FOR LCOUNT, 1, CHARANUM
		SIF TALENT:LCOUNT:スライム == 0
			CONTINUE
		SIF BASE:LCOUNT:胎児 == 0
			TALENT:LCOUNT:妊娠 = 0
	NEXT

	FLAG:29 = 221
ENDIF
;調教での獲得経験フラグの暫定処理
IF FLAG:29 == 221
	FOR LCOUNT, 1, CHARANUM
		FOR LOCAL, 0, 99
			SIF EXP:LCOUNT:LOCAL
				CFLAG:LCOUNT:(800 + LOCAL) = 1
		NEXT
	NEXT

	FLAG:29 = 222
ENDIF
;お気に入りの衣装の記録方法の変更
IF FLAG:29 == 222
	FOR LCOUNT, 1, CHARANUM
		LOCALS = 
		FOR LOCAL, 50, 60
			LOCALS = %LOCALS%{EQUIP:LCOUNT:LOCAL},%CSTR:LCOUNT:LOCAL%,
		NEXT
		CSTR:LCOUNT:50 = %LOCALS%
	NEXT
	FOR LCOUNT, 51, 60
		CVARSET CSTR, LCOUNT
	NEXT
	;コンフィグのお気に入りの服装の項目も変更
	SIF FLAG:200 == 3
		FLAG:200 = 4
	SIF FLAG:202 == 2
		FLAG:202 = 1
	FLAG:29 = 223
ENDIF
;精液に弱い？
IF FLAG:29 == 223
	FOR LCOUNT, 1, CHARANUM
		CALL CALC, "精液に弱い", LCOUNT
		IF TALENT:LCOUNT:精液に弱い == 0 && ABL:LCOUNT:精液中毒 > BASE:LCOUNT:識別番号%5
			IF EXP:LCOUNT:フェラ経験 && RANDIF(1, EXP:LCOUNT:Ｖ性交経験, EXP:LCOUNT:Ａ性交経験)
				TALENT:LCOUNT:精液に弱い = 1p0
			ELSEIF EXP:LCOUNT:Ｖ性交経験 && RANDIF(1, EXP:LCOUNT:Ａ性交経験)
				TALENT:LCOUNT:精液に弱い = 1p1
			ELSEIF EXP:LCOUNT:Ａ性交経験
				TALENT:LCOUNT:精液に弱い = 1p2
			ENDIF
		ENDIF
	NEXT
	FLAG:29 = 224
ENDIF
;上位夢魔になり損ねるバグ修正＆一部キャラに素質[嘔吐反射耐性]追加
IF FLAG:29 == 224
	IF CONFIG("ＨＡＲＤ")
		FOR LCOUNT, 2, CHARANUM
			IF ABL:LCOUNT:ＬＶ >= 14 && TALENT:LCOUNT:夢魔 && TALENT:LCOUNT:上位夢魔 == 0
				TALENT:LCOUNT:夢魔 = 0
				TALENT:LCOUNT:上位夢魔 = 1
			ENDIF
		NEXT
	ENDIF
	FOR LCOUNT, 2, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 29, 34, 46
			TALENT:LCOUNT:嘔吐反射耐性 = 1
		ENDSELECT
	NEXT
	FLAG:29 = 225
ENDIF
;ＶＡ拡張度の取得の仕組み変更など
IF FLAG:29 == 225
	FOR LCOUNT, 2, CHARANUM
		CALL GET_EXTALENT, LCOUNT
	NEXT
	FLAG:29 = 226
ENDIF
;肌の色：色白の設定ミス修正
IF FLAG:29 == 226
	FOR LCOUNT, 1, CHARANUM
		SIF TALENT:LCOUNT:肌の色 == 4
			TALENT:LCOUNT:肌の色 = 2
	NEXT
	FLAG:29 = 227
ENDIF
;喉性感と子宮性感の設定
IF FLAG:29 == 227
	FOR LCOUNT, 2, CHARANUM
		;子宮性感
		SIF TALENT:LCOUNT:子宮性感 == 0 && ABL:LCOUNT:Ｖ感覚 + TALENT:LCOUNT:Ｖ敏感*2 >= 5
			TALENT:LCOUNT:子宮性感 = 1
		;喉性感
		SIF TALENT:LCOUNT:喉性感 == 0 && ABL:LCOUNT:Ｍ感覚 + TALENT:LCOUNT:Ｍ敏感*2 >= 5
			TALENT:LCOUNT:喉性感 = 1
	NEXT
	FLAG:29 = 228
ENDIF
;ハニービーの翼としっぽ
IF FLAG:29 == 228
	FOR LCOUNT, 1, CHARANUM
		IF BASE:LCOUNT:種族 == 60
			TALENT:LCOUNT:翼 = 13
			TALENT:LCOUNT:しっぽ = 13
		ENDIF
	NEXT
	FLAG:29 = 229
ENDIF
IF FLAG:29 == 229
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 47
			TALENT:LCOUNT:貞操無頓着 = 1
		ENDSELECT
	NEXT
	FLAG:29 = 230
ENDIF
;身嗜みフラグの変更
IF FLAG:29 == 230
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE GETBITS(CFLAG:LCOUNT:368, 11, 20)
		CASE 1p11
			CLEARBIT CFLAG:LCOUNT:368, 11
			SETBIT CFLAG:LCOUNT:368, 6
		CASE 1p12
			CLEARBIT CFLAG:LCOUNT:368, 12
			SETBIT CFLAG:LCOUNT:368, 7
		ENDSELECT

		SELECTCASE GETBITS(CFLAG:LCOUNT:368, 21, 30)
		CASE 1p21
			CLEARBIT CFLAG:LCOUNT:368, 21
			SETBIT CFLAG:LCOUNT:368, 11
		CASE 1p22
			CLEARBIT CFLAG:LCOUNT:368, 22
			SETBIT CFLAG:LCOUNT:368, 12
		CASE 1p23
			CLEARBIT CFLAG:LCOUNT:368, 23
			SETBIT CFLAG:LCOUNT:368, 13
		CASE 1p24
			CLEARBIT CFLAG:LCOUNT:368, 24
			SETBIT CFLAG:LCOUNT:368, 14
		ENDSELECT

		SELECTCASE GETBITS(CFLAG:LCOUNT:368, 31, 40)
		CASE 1p31
			CLEARBIT CFLAG:LCOUNT:368, 31
			SETBIT CFLAG:LCOUNT:368, 16
		CASE 1p32
			CLEARBIT CFLAG:LCOUNT:368, 32
			SETBIT CFLAG:LCOUNT:368, 17
		CASE 1p33
			CLEARBIT CFLAG:LCOUNT:368, 33
			SETBIT CFLAG:LCOUNT:368, 18
		CASE 1p34
			CLEARBIT CFLAG:LCOUNT:368, 34
			SETBIT CFLAG:LCOUNT:368, 17
		ENDSELECT

		SELECTCASE GETBITS(CFLAG:LCOUNT:368, 41, 50)
		CASE 1p41
			CLEARBIT CFLAG:LCOUNT:368, 41
			SETBIT CFLAG:LCOUNT:368, 21
		CASE 1p42
			CLEARBIT CFLAG:LCOUNT:368, 42
			SETBIT CFLAG:LCOUNT:368, 22
		CASE 1p43
			CLEARBIT CFLAG:LCOUNT:368, 43
			SETBIT CFLAG:LCOUNT:368, 23
		ENDSELECT
	NEXT
	FLAG:29 = 231
ENDIF
;助手との掛け合いフラグの書き換え
IF FLAG:29 == 231
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 2, 19, 20
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：短編スキュラ", LCOUNT
		CASE 5
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：実の娘", LCOUNT
		CASE 7
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：バンシー", LCOUNT
		CASE 8
			IF CFLAG:LCOUNT:209 == 1
				SIF CFLAG:LCOUNT:202
					CALL SET_CEVENT, "助手会話：Ｖヴィレッジャ", LCOUNT
				SIF CFLAG:LCOUNT:203
					CALL SET_CEVENT, "助手会話：サキュバス", LCOUNT
			ELSEIF CFLAG:LCOUNT:209 == 2
				SIF CFLAG:LCOUNT:202
					CALL SET_CEVENT, "助手会話：ヴィレッジャ", LCOUNT
				SIF CFLAG:LCOUNT:203
					CALL SET_CEVENT, "助手会話：ワーウルフ２", LCOUNT
			ENDIF
		CASE 9
			IF CFLAG:LCOUNT:209 == 2
				SIF CFLAG:LCOUNT:202
					CALL SET_CEVENT, "助手会話：巨乳", LCOUNT
				SIF CFLAG:LCOUNT:203
					CALL SET_CEVENT, "助手会話：貧乳", LCOUNT
			ENDIF
		CASE 13
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：短編スキュラ", LCOUNT
			SIF CFLAG:LCOUNT:203
				CALL SET_CEVENT, "助手会話：巨乳", LCOUNT
			SIF CFLAG:LCOUNT:203
				CALL SET_CEVENT, "助手会話：並乳以下", LCOUNT
		CASE 15
			IF CFLAG:LCOUNT:209 == 2
				SIF CFLAG:LCOUNT:202
					CALL SET_CEVENT, "助手会話：ゴブリン", LCOUNT
				SIF CFLAG:LCOUNT:203
					CALL SET_CEVENT, "助手会話：マーメイド", LCOUNT
				SIF CFLAG:LCOUNT:204
					CALL SET_CEVENT, "助手会話：ウィッチ", LCOUNT
				SIF CFLAG:LCOUNT:205
					CALL SET_CEVENT, "助手会話：エンジェル", LCOUNT
			ENDIF
		CASE 16
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：巨乳", LCOUNT
		CASE 17
			IF CFLAG:LCOUNT:209 == 2
				SIF CFLAG:LCOUNT:202
					CALL SET_CEVENT, "助手会話：ヴァンパイア１", LCOUNT
				SIF CFLAG:LCOUNT:203
					CALL SET_CEVENT, "助手会話：ルシフェル", LCOUNT
			ENDIF
		CASE 25
			IF CFLAG:LCOUNT:209 == 2
				SIF CFLAG:LCOUNT:202
					CALL SET_CEVENT, "助手会話：ワーウルフ１", LCOUNT
				SIF CFLAG:LCOUNT:203
					CALL SET_CEVENT, "助手会話：マーメイド", LCOUNT
				SIF CFLAG:LCOUNT:204
					CALL SET_CEVENT, "助手会話：長編スキュラ", LCOUNT
				SIF CFLAG:LCOUNT:205
					CALL SET_CEVENT, "助手会話：短編スキュラ", LCOUNT
				SIF CFLAG:LCOUNT:206
					CALL SET_CEVENT, "助手会話：クズノハ", LCOUNT
				SIF CFLAG:LCOUNT:207
					CALL SET_CEVENT, "助手会話：エンジェル", LCOUNT
				SIF CFLAG:LCOUNT:208
					CALL SET_CEVENT, "助手会話：サキュバス", LCOUNT
				SIF CFLAG:LCOUNT:210
					CALL SET_CEVENT, "助手会話：シルフ", LCOUNT
				SIF CFLAG:LCOUNT:212
					CALL SET_CEVENT, "助手会話：リン１", LCOUNT
				SIF CFLAG:LCOUNT:213
					CALL SET_CEVENT, "助手会話：ワーウルフ２", LCOUNT
				SIF CFLAG:LCOUNT:214
					CALL SET_CEVENT, "助手会話：ワーウルフ３", LCOUNT
				SIF CFLAG:LCOUNT:215
					CALL SET_CEVENT, "助手会話：サロメ１", LCOUNT
				SIF CFLAG:LCOUNT:216
					CALL SET_CEVENT, "助手会話：サロメ２", LCOUNT
				SIF CFLAG:LCOUNT:217
					CALL SET_CEVENT, "助手会話：ウィッチ", LCOUNT
				SIF CFLAG:LCOUNT:218
					CALL SET_CEVENT, "助手会話：娘", LCOUNT
			ELSEIF CFLAG:LCOUNT:209 == 3
				SIF CFLAG:LCOUNT:202
					CALL SET_CEVENT, "助手会話：クィーンメイヴ", LCOUNT
				SIF CFLAG:LCOUNT:203
					CALL SET_CEVENT, "助手会話：Ｖヴィレッジャ", LCOUNT
				SIF CFLAG:LCOUNT:204
					CALL SET_CEVENT, "助手会話：ワーウルフ", LCOUNT
				SIF CFLAG:LCOUNT:205
					CALL SET_CEVENT, "助手会話：クララ", LCOUNT
			ENDIF
		CASE 30
			IF CFLAG:LCOUNT:209 == 2
				SIF CFLAG:LCOUNT:202
					CALL SET_CEVENT, "助手会話：ユニコーン", LCOUNT
			ENDIF
		CASE 33
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：エンプーサ", LCOUNT
		CASE 34
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：メローナ", LCOUNT
		CASE 35
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：ストゥーナ", LCOUNT
		CASE 37
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：ミミック", LCOUNT
		CASE 41
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：ジャブジャブ", LCOUNT
		CASE 42
			IF CFLAG:LCOUNT:209 == 2
				SIF CFLAG:LCOUNT:202
					CALL SET_CEVENT, "助手会話：ジャブジャブ", LCOUNT
			ENDIF
		CASE 43
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：ジャバウォック", LCOUNT
			SIF CFLAG:LCOUNT:203
				CALL SET_CEVENT, "助手会話：バンダースナッチ１", LCOUNT
			SIF CFLAG:LCOUNT:204
				CALL SET_CEVENT, "助手会話：バンダースナッチ２", LCOUNT
		CASE 44
			IF CFLAG:LCOUNT:209 == 3
				SIF CFLAG:LCOUNT:202
					CALL SET_CEVENT, "助手会話：サキュバス", LCOUNT
				SIF CFLAG:LCOUNT:203
					CALL SET_CEVENT, "助手会話：シルフ", LCOUNT
				SIF CFLAG:LCOUNT:204
					CALL SET_CEVENT, "助手会話：マーメイド", LCOUNT
				SIF CFLAG:LCOUNT:205
					CALL SET_CEVENT, "助手会話：クズノハ", LCOUNT
				SIF CFLAG:LCOUNT:206
					CALL SET_CEVENT, "助手会話：エンジェル", LCOUNT
				SIF CFLAG:LCOUNT:207
					CALL SET_CEVENT, "助手会話：ヴァンパイア２", LCOUNT
			ENDIF
		CASE 61
			SIF CFLAG:LCOUNT:202
				CALL SET_CEVENT, "助手会話：汎用", LCOUNT
			SIF CFLAG:LCOUNT:203
				CALL SET_CEVENT, "助手会話：クノイチ", LCOUNT
		CASE 98
			SIF CFLAG:LCOUNT:210
				CALL SET_CEVENT, "エキストラモード", LCOUNT
		ENDSELECT
	NEXT
	;使わなくなったCFLAGを初期化
	FOR LCOUNT, 202, 220
		SIF LCOUNT == 209
			CONTINUE
		CVARSET CFLAG, LCOUNT, 0
	NEXT

	FLAG:29 = 232
ENDIF
;ドラゴンの寝取りイベント周りの整理
IF FLAG:29 == 232
	FOR LCOUNT, 1, CHARANUM
		SIF GETBIT(CFLAG:LCOUNT:470, 3)
			MARK:LCOUNT:竜姦克服刻印 = 1

		IF GETBIT(CFLAG:LCOUNT:470, 2)
			MARK:LCOUNT:竜姦刻印 = 2
		ELSEIF GETBIT(CFLAG:LCOUNT:470, 1)
			MARK:LCOUNT:竜姦刻印 = 1
		ENDIF

		CFLAG:LCOUNT:470 = 0

		;竜姦経験をＶとＡで区別する
		IF EXP:LCOUNT:Ｖ竜姦経験
			;ＶＡ両方経験済み
			IF FIRSTCOM(304, LCOUNT) && FIRSTCOM(305, LCOUNT)
				EXP:LCOUNT:Ａ竜姦経験 = 1
			ELSEIF FIRSTCOM(305, LCOUNT)
				EXP:LCOUNT:Ａ竜姦経験 = EXP:LCOUNT:Ｖ竜姦経験
				EXP:LCOUNT:Ｖ竜姦経験 = 0
			ENDIF
		ENDIF
	NEXT
	FLAG:29 = 233
ENDIF
;好きな体位の処理変更に伴う経験初期化
IF FLAG:29 == 233
	FOR LCOUNT, 80, 95
		CVARSET EXP, LCOUNT, 0
	NEXT
	FLAG:29 = 234
ENDIF
;助手レベルの番号変更＆尿道関連の設定
IF FLAG:29 == 234
	FOR LCOUNT, 1, CHARANUM
		ABL:LCOUNT:91 = ABL:LCOUNT:20
		ABL:LCOUNT:20 = 0
		CALL GET_EXABL2, LCOUNT
	NEXT

	FLAG:29 = 235
ENDIF
;淫魔の雫の番号変換
IF FLAG:29 == 235
	ITEM:淫魔の雫 = ITEM:350
	ITEM:350 = 0

	FLAG:29 = 236
ENDIF
;クズノハ、ヴァンパイア2の日付フラグ周りの整備
IF FLAG:29 == 236
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 16
			CFLAG:LCOUNT:201 = CLEARBITS(CFLAG:LCOUNT:201, 59, 63)
		CASE 25
			SIF CFLAG:LCOUNT:209 == 2
				CFLAG:LCOUNT:201 = CLEARBITS(CFLAG:LCOUNT:201, 40, 56)
		ENDSELECT
	NEXT

	FLAG:29 = 237
ENDIF
IF FLAG:29 == 237
	FOR LCOUNT, 1, CHARANUM
		IF GETBIT(TALENT:LCOUNT:好きな体位, 20)
			CLEARBIT TALENT:LCOUNT:好きな体位, 20
			SETBIT TALENT:LCOUNT:好きな体位, 19
		ENDIF
		CALL GET_EXABL2, LCOUNT
	NEXT

	FLAG:29 = 238
ENDIF
;童貞処女狩りで経験値ＧＥＴ
IF FLAG:29 == 238
	FOR LCOUNT, 1, CHARANUM
		EXP:LCOUNT:経験値 += EXP:LCOUNT:童貞狩り経験 * 50
		SIF GETBIT(TALENT:LCOUNT:初めての人, 0)
			EXP:LCOUNT:経験値 += 950

		EXP:LCOUNT:経験値 += EXP:LCOUNT:処女簒奪経験 * 50
		SIF GETBIT(TALENT:LCOUNT:初めての人, 1)
			EXP:LCOUNT:経験値 += 950
	NEXT

	FLAG:29 = 239
ENDIF
;EVENT_TRAVELでの精液経験獲得の際に受け攻めが同じ場合があったミスの修正
IF FLAG:29 == 239
	FOR LCOUNT, 1, CHARANUM
		;自分の識別番号が自分に射精した記録を消す
		LOCALS = %TOSTR(BASE:LCOUNT:識別番号)%
		CALL DEL_CSTR_GROUP, LOCALS, LCOUNT, 11
		CALL DEL_CSTR_GROUP, LOCALS, LCOUNT, 12
		CALL DEL_CSTR_GROUP, LOCALS, LCOUNT, 13
		CALL DEL_CSTR_GROUP, LOCALS, LCOUNT, 14
		CALL DEL_CSTR_GROUP, LOCALS, LCOUNT, 15
	NEXT

	FLAG:29 = 240
ENDIF
;食事のフラグ変更
IF FLAG:29 == 240
	FLAG:41 = 0

	LOCAL = FLAG:40
	FLAG:40 = 0

	SELECTCASE LOCAL
	CASE 1
		SETBIT FLAG:40, 0
	CASE 2
		SETBIT FLAG:40, 1
	CASE 20
		SETBIT FLAG:40, 10
	CASE 21
		SETBIT FLAG:40, 11
	CASE 40
		SETBIT FLAG:40, 20
	CASE 51
		SETBIT FLAG:40, 21
	CASE 59
		SETBIT FLAG:40, 50
	CASE 60
		SETBIT FLAG:40, 30
	CASE 61
		SETBIT FLAG:40, 31
	CASE 62
		SETBIT FLAG:40, 32
	ENDSELECT

	FLAG:29 = 241
ENDIF
;もったいない使い方のCSTRをフリーに戻す
IF FLAG:29 == 241
	FOR LCOUNT, 1, CHARANUM
		IF CSTR:LCOUNT:70 != ""
			LOCALS = 陰毛の形：%CSTR:LCOUNT:70%
			CALL SET_CEVENT, LOCALS, LCOUNT
			CSTR:LCOUNT:70 = 
		ENDIF
		IF CSTR:LCOUNT:71 != ""
			LOCALS = 陰毛の名称：%CSTR:LCOUNT:71%
			CALL SET_CEVENT, LOCALS, LCOUNT
			CSTR:LCOUNT:71 = 
		ENDIF
		IF CSTR:LCOUNT:72 != ""
			LOCALS = クリピアス：%CSTR:LCOUNT:72%
			CALL SET_CEVENT, LOCALS, LCOUNT
			CSTR:LCOUNT:72 = 
		ENDIF
		IF CSTR:LCOUNT:73 != ""
			LOCALS = ラビアピアス：%CSTR:LCOUNT:73%
			CALL SET_CEVENT, LOCALS, LCOUNT
			CSTR:LCOUNT:73 = 
		ENDIF
		IF CSTR:LCOUNT:74 != ""
			LOCALS = ニプルピアス：%CSTR:LCOUNT:74%
			CALL SET_CEVENT, LOCALS, LCOUNT
			CSTR:LCOUNT:74 = 
		ENDIF
		IF CSTR:LCOUNT:75 != ""
			LOCALS = へそピアス：%CSTR:LCOUNT:75%
			CALL SET_CEVENT, LOCALS, LCOUNT
			CSTR:LCOUNT:75 = 
		ENDIF
	NEXT
	FLAG:29 = 242
ENDIF

IF FLAG:29 <= 243
	FOR LCOUNT, 1, CHARANUM
		SIF GETBIT(CFLAG:LCOUNT:4, 2)
			TALENT:LCOUNT:濡れやすい = 1
		SIF GETBIT(CFLAG:LCOUNT:4, 3)
			TALENT:LCOUNT:濡れにくい = 1
	NEXT

	;過去に使った記憶あるので念のためリセット
	FLAG:12 = 0
	FLAG:29 = 244
ENDIF

;呼び名管理をCFLAGではなくCEVENTで行うように変更
IF FLAG:29 <= 246
	FOR LCOUNT, 2, CHARANUM
		SELECTCASE NO:LCOUNT
		CASE 1
			IF CFLAG:LCOUNT:459
				CALL SET_CEVENT, "一人称主人：お姉ちゃん", LCOUNT
				CALL SET_CEVENT, "一人称主人かな：おねえちゃん", LCOUNT
				CALL SET_CEVENT, "二人称主人：CALLNAME_PLAYER", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：CALLNAME_PLAYER", LCOUNT
			ENDIF
			CFLAG:LCOUNT:459 = 0
		CASE 3
			SELECTCASE CFLAG:LCOUNT:466
			CASE 1
				CALL SET_CEVENT, "二人称主人：ご主人様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：ごしゅじんさま", LCOUNT
			CASE 2
				CALL SET_CEVENT, "二人称主人：マスター", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：ますたー", LCOUNT
			CASE 3
				CALL SET_CEVENT, "二人称主人：お父様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おとうさま", LCOUNT
			CASE 4
				CALL SET_CEVENT, "二人称主人：オオカミさん", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おおかみさん", LCOUNT
			ENDSELECT
			CFLAG:LCOUNT:466 = 0
		CASE 7
			IF COND("Ｃワーウルフ２", LCOUNT)
				SELECTCASE CFLAG:LCOUNT:460
				CASE 0
					CALL SET_CEVENT, "二人称主人：あるじ", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：あるじ", LCOUNT
				CASE 1
					CALL SET_CEVENT, "二人称主人：ごしゅじん", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：ごしゅじん", LCOUNT
				CASE 2
					CALL SET_CEVENT, "二人称主人：CALLNAME_MASTER", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：CALLNAME_MASTER", LCOUNT
				ENDSELECT
				CFLAG:LCOUNT:460 = 0
			ELSEIF COND("Ｃワーウルフ３", LCOUNT)
				SELECTCASE CFLAG:LCOUNT:459
				CASE 1
					IF TALENT:MASTER:オトコ
						CALL SET_CEVENT, "二人称主人：お兄ちゃん", LCOUNT
						CALL SET_CEVENT, "二人称主人かな：おにいちゃん", LCOUNT
					ELSE
						CALL SET_CEVENT, "二人称主人：お姉ちゃん", LCOUNT
						CALL SET_CEVENT, "二人称主人かな：おねえちゃん", LCOUNT
					ENDIF
				CASE 2
					CALL SET_CEVENT, "二人称主人：ダーリン", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：だーりん", LCOUNT
				CASE 3
					CALL SET_CEVENT, "二人称主人：CALLNAME_MASTER", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：CALLNAME_MASTER", LCOUNT
				CASE 4
					CALL SET_CEVENT, "二人称主人：旦那様", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：だんなさま", LCOUNT
				CASE 5
					CALL SET_CEVENT, "二人称主人：先輩", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：せんぱい", LCOUNT
				ENDSELECT
				CFLAG:LCOUNT:459 = 0
			ENDIF
		CASE 10
			IF COND("Ｃメリュジーヌ", LCOUNT)
				SELECTCASE CFLAG:LCOUNT:460
				CASE 1
					IF TALENT:MASTER:オトコ
						CALL SET_CEVENT, "二人称主人：旦那様", LCOUNT
						CALL SET_CEVENT, "二人称主人かな：だんなさま", LCOUNT
					ELSE
						CALL SET_CEVENT, "二人称主人：お嬢様", LCOUNT
						CALL SET_CEVENT, "二人称主人かな：おじょうさま", LCOUNT
					ENDIF
				CASE 2
					IF TALENT:MASTER:オトコ
						CALL SET_CEVENT, "二人称主人：お兄様", LCOUNT
						CALL SET_CEVENT, "二人称主人かな：おにいさま", LCOUNT
					ELSE
						CALL SET_CEVENT, "二人称主人：お姉様", LCOUNT
						CALL SET_CEVENT, "二人称主人かな：おねえさま", LCOUNT
					ENDIF
				CASE 3
					IF TALENT:MASTER:オトコ
						CALL SET_CEVENT, "二人称主人：おじ様", LCOUNT
						CALL SET_CEVENT, "二人称主人かな：おじさま", LCOUNT
					ELSE
						CALL SET_CEVENT, "二人称主人：お義母様", LCOUNT
						CALL SET_CEVENT, "二人称主人かな：おかあさま", LCOUNT
					ENDIF
				CASE 4
					CALL SET_CEVENT, "二人称主人：CALLNAME_MASTER様", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：CALLNAME_MASTERさま", LCOUNT
				ENDSELECT
				CFLAG:LCOUNT:460 = 0
			ENDIF
		CASE 15
			IF COND("Ｃ短編スキュラ", LCOUNT)
				;一人称がスキュラ
				SIF CFLAG:LCOUNT:460 == 1
					SETBIT CFLAG:LCOUNT:201, 30
				CFLAG:LCOUNT:460 = 0
			ENDIF
		CASE 16
			SELECTCASE CFLAG:LCOUNT:466
			CASE 1, 101
			CASE 2, 102
				CALL SET_CEVENT, "二人称主人：ご主人様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：ごしゅじんさま", LCOUNT
			CASE 3, 103
				CALL SET_CEVENT, "二人称主人：お前様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おまえさま", LCOUNT
			CASE 4, 104
				CALL SET_CEVENT, "二人称主人：御館様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おやかたさま", LCOUNT
			CASE 5, 105
				CALL SET_CEVENT, "二人称主人：そなた", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：そなた", LCOUNT
			CASE 6, 106
				CALL SET_CEVENT, "二人称主人：おぬし", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おぬし", LCOUNT
			CASE 7
				CALL SET_CEVENT, "二人称主人：ダーリン", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：だーりん", LCOUNT
			CASE 8
				CALL SET_CEVENT, "二人称主人：旦那様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：だんなさま", LCOUNT
			CASE 9
				CALL SET_CEVENT, "二人称主人：お兄様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おにいさま", LCOUNT
			CASE 10
				CALL SET_CEVENT, "二人称主人：小童", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：こわっぱ", LCOUNT
			CASE 107
				CALL SET_CEVENT, "二人称主人：女王様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：じょおうさま", LCOUNT
			CASE 108
				CALL SET_CEVENT, "二人称主人：お嬢様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おぜうさま", LCOUNT
			CASE 109
				CALL SET_CEVENT, "二人称主人：お姉様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おねえさま", LCOUNT
			CASE 110
				CALL SET_CEVENT, "二人称主人：小娘", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：こむすめ", LCOUNT
			CASE 20, 120
				CALL SET_CEVENT, "二人称主人：クズ殿", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：くずどの", LCOUNT
			CASE 21
				CALL SET_CEVENT, "二人称主人：牡豚殿", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おすぶたどの", LCOUNT
			CASE 121
				CALL SET_CEVENT, "二人称主人：牝豚殿", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：めすぶたどの", LCOUNT
			CASE 22
				CALL SET_CEVENT, "二人称主人：牡犬殿", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おすいぬどの", LCOUNT
			CASE 122
				CALL SET_CEVENT, "二人称主人：牝犬殿", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：めすいぬどの", LCOUNT
			ENDSELECT
			CFLAG:LCOUNT:466 = 0
		CASE 25
			IF COND("Ｃヴァンパイア３", LCOUNT)
				SELECTCASE CFLAG:LCOUNT:459
				CASE 1
					CALL SET_CEVENT, "二人称主人：ダーリン", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：だーりん", LCOUNT
				CASE 2
					CALL SET_CEVENT, "二人称主人：ハニー", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：はにぃ", LCOUNT
				CASE 3
					IF TALENT:MASTER:オトコ
						CALL SET_CEVENT, "二人称主人：お兄様", LCOUNT
						CALL SET_CEVENT, "二人称主人かな：おにいさま", LCOUNT
					ELSE
						CALL SET_CEVENT, "二人称主人：お姉様", LCOUNT
						CALL SET_CEVENT, "二人称主人かな：おねえさま", LCOUNT
					ENDIF
				ENDSELECT
				CFLAG:LCOUNT:459 = 0
			ENDIF
		CASE 30
			SELECTCASE CFLAG:LCOUNT:459
			CASE 1
				CALL SET_CEVENT, "二人称主人：兄さん", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：にいさん", LCOUNT
			CASE 2
				CALL SET_CEVENT, "一人称主人：あたし", LCOUNT
				CALL SET_CEVENT, "一人称主人かな：あたし", LCOUNT
				CALL SET_CEVENT, "二人称主人：お兄ちゃん", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おにいちゃん", LCOUNT
			CASE 4
				CALL SET_CEVENT, "二人称主人：旦那様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：だんなさま", LCOUNT
			CASE 5
				CALL SET_CEVENT, "一人称主人：先生", LCOUNT
				CALL SET_CEVENT, "一人称主人かな：せんせい", LCOUNT
				IF CALLNAME:MASTER == "あなた"
					CALL SET_CEVENT, "二人称主人：あなた", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：あなた", LCOUNT
				;コンフィグで「あなた」以外に設定している場合
				ELSE
					CALL SET_CEVENT, "二人称主人：CALLNAME_MASTER君", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：CALLNAME_MASTERくん", LCOUNT
				ENDIF
			CASE 6
				CALL SET_CEVENT, "一人称主人：センセイ", LCOUNT
				CALL SET_CEVENT, "一人称主人かな：せんせい", LCOUNT
				IF CALLNAME:MASTER == "あなた"
					CALL SET_CEVENT, "二人称主人：キミ", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：きみ", LCOUNT
				;コンフィグで「あなた」以外に設定している場合
				ELSE
					CALL SET_CEVENT, "二人称主人：CALLNAME_MASTERクン", LCOUNT
					CALL SET_CEVENT, "二人称主人かな：CALLNAME_MASTERくん", LCOUNT
				ENDIF
			ENDSELECT
			CFLAG:LCOUNT:459 = 0
		CASE 44
			SELECTCASE CFLAG:LCOUNT:466
			CASE 1, 101

			CASE 2, 102
				CALL SET_CEVENT, "二人称主人：先生", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：せんせい", LCOUNT
			CASE 3, 103
				CALL SET_CEVENT, "二人称主人：ご主人様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：ごしゅじんさま", LCOUNT
			CASE 4
				CALL SET_CEVENT, "二人称主人：お兄様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おにいさま", LCOUNT
			CASE 104
				CALL SET_CEVENT, "二人称主人：お姉様", LCOUNT
				CALL SET_CEVENT, "二人称主人かな：おねえさま", LCOUNT
			ENDSELECT
			CFLAG:LCOUNT:466 = 0
		CASE 47
			SIF GETBIT(CFLAG:LCOUNT:460, 0)
				SETBIT CFLAG:LCOUNT:201, 30
			SIF GETBIT(CFLAG:LCOUNT:460, 1)
				SETBIT CFLAG:LCOUNT:201, 31
			CFLAG:LCOUNT:460 = 0
		CASE 60
			IF COND("Ｃハニービー２", LCOUNT)
				SIF CFLAG:LCOUNT:466
					SETBIT CFLAG:LCOUNT:201, 33
				CFLAG:LCOUNT:466 = 0
			ENDIF
		ENDSELECT
	NEXT

	FLAG:29 = 247
ENDIF

;助手調教時の恋慕の扱いを変更…デフォだと、助手相手では恋慕無し
IF FLAG:29 <= 247
	INVERTBIT FLAG:218, 0
	LOADGLOBAL
	INVERTBIT GLOBAL:161, 0
	SAVEGLOBAL

	FLAG:29 = 248
ENDIF
;におい関連
IF FLAG:29 <= 249
	FOR LCOUNT, 1, CHARANUM
		SIF TALENT:LCOUNT:においに弱い
			TALENT:LCOUNT:汚臭鈍感 = 0
	NEXT

	FLAG:29 = 250
ENDIF

IF FLAG:29 <= 250
	;調教者奉仕フィルタ、尿道フィルタの廃止
	CLEARBIT FLAG:209, 3
	CLEARBIT FLAG:209, 8
	FLAG:210 = 0
	;販売アイテムフィルタの廃止など
	FLAG:215 = 0
	FLAG:216 = 0
	FLAG:256 = 0
	FLAG:257 = 0

	;GLOBALの方も調整
	LOADGLOBAL

	CLEARBIT GLOBAL:125, 3
	CLEARBIT GLOBAL:125, 8
	GLOBAL:127 = 0
	GLOBAL:128 = 0
	GLOBAL:167 = 0
	GLOBAL:168 = 0

	SAVEGLOBAL

	FLAG:29 = 251
ENDIF

IF FLAG:29 == 251
	FOR LCOUNT, 1, CHARANUM
		CALL GET_EXTALENT, LCOUNT
	NEXT
	;TARGET以外が喋るイベントの名前表示
	FLAG:273 = 0
	;GLOBALの方も調整
	LOADGLOBAL
	GLOBAL:182 = 0
	SAVEGLOBAL

	FLAG:29 = 252
ENDIF
;探索の整備
IF FLAG:29 <= 254
	FOR LCOUNT, 1, CHARANUM
		SIF NO:LCOUNT == 38
			TALENT:LCOUNT:鼓舞 = 1
	NEXT

	FLAG:50 = GETBIT(FLAG:51, 1)*1p0
	FLAG:50 += GETBIT(FLAG:52, 1)*1p5 + GETBIT(FLAG:52, 2)*1p6
	FLAG:50 += GETBIT(FLAG:55, 1)*1p15 
	FLAG:50 += GETBIT(FLAG:56, 1)*1p25

	VARSET FLAG, 0, 51, 57

	FLAG:29 = 255
ENDIF
;レベルリミッターの仕様変更
IF FLAG:29 <= 255
	IF GETBIT(FLAG:247, 1)
		FLAG:247 = 1p11
	ELSEIF GETBIT(FLAG:247, 2)
		FLAG:247 = 1p12
	ELSEIF GETBIT(FLAG:247, 3)
		FLAG:247 = 1p13
	ELSEIF GETBIT(FLAG:247, 4)
		FLAG:247 = 1p14
	ELSEIF GETBIT(FLAG:247, 5)
		FLAG:247 = 1p15
	ENDIF

	FLAG:29 = 256
ENDIF
;細かいフラグ変更
IF FLAG:29 <= 256

	;周回ボーナスのフラグの入れ替え
	IF GETBIT(FLAG:33, 6) && GETBIT(FLAG:33, 10) == 0
		CLEARBIT FLAG:33, 6
		SETBIT FLAG:33, 10
	ELSEIF GETBIT(FLAG:33, 10) && GETBIT(FLAG:33, 6) == 0
		CLEARBIT FLAG:33, 10
		SETBIT FLAG:33, 6
	ENDIF
	SIF GETBIT(FLAG:34, 0)
		SETBIT FLAG:33, 30
	SIF GETBIT(FLAG:34, 1)
		SETBIT FLAG:33, 31
	SIF GETBIT(FLAG:34, 2)
		SETBIT FLAG:33, 32
	SIF GETBIT(FLAG:34, 3)
		SETBIT FLAG:33, 33
	SIF GETBIT(FLAG:34, 4)
		SETBIT FLAG:33, 34
	FLAG:34 = 0

	FLAG:29 = 257
ENDIF
IF FLAG:29 <= 258
	;CFLAG:406の使用取りやめ
	CVARSET CFLAG, 406, 0

	FLAG:29 = 259
ENDIF
;竜の血周り
IF FLAG:29 <= 259
	;周回ボーナスの血の濃さを２に変更
	SIF TALENT:MASTER:竜の血 == 1
		TALENT:MASTER:竜の血 = 2

	FLAG:29 = 260
ENDIF
;えるふみみとか
IF FLAG:29 <= 260
	FOR LCOUNT, 1, CHARANUM
		SELECTCASE BASE:LCOUNT:種族
		CASE 1 TO 5, 10, 17, 34, 41, 48, 50, 52
			TALENT:LCOUNT:耳の形 = 1
		ENDSELECT
	NEXT

	FLAG:29 = 261
ENDIF
;好きな体位の設定ミスを直す
IF FLAG:29 <= 262
	FOR LCOUNT, 1, CHARANUM
		CALL CALC, "好きな体位", LCOUNT
	NEXT

	FLAG:29 = 263
ENDIF
;素質獲得回数の廃止
IF FLAG:29 <= 264
	FOR LCOUNT, 2, CHARANUM
		WHILE CFLAG:LCOUNT:5
			EXP:LCOUNT:経験値 += 200 * (CFLAG:LCOUNT:5 - 1)
			CFLAG:LCOUNT:5 -= 1
		WEND
	NEXT

	FLAG:29 = 265
ENDIF
;避妊中の精子の扱いを変更
IF FLAG:29 <= 265
	FOR LCOUNT, 1, CHARANUM
		SIF COND("妊娠可能", LCOUNT) == 0
			BASE:LCOUNT:胎内精子量 = 0

		WHILE CFLAG:LCOUNT:5
			EXP:LCOUNT:経験値 += 200 * (CFLAG:LCOUNT:5 - 1)
			CFLAG:LCOUNT:5 -= 1
		WEND
	NEXT
	FLAG:29 = 266
ENDIF
;外見年齢の問題を修正
IF FLAG:29 <= 269
	;MASTERに関してはどうしようもないのでコンフィグに救済措置を用意
	FOR LCOUNT, 2, CHARANUM
		TALENT:LCOUNT:外見年齢 = 0
		TALENT:LCOUNT:外見年齢 = SET_EXTALENT("外見年齢", LCOUNT)
	NEXT

	FLAG:29 = 270
ENDIF
;乳首の詳細設定
IF FLAG:29 <= 271
	FOR LCOUNT, 1, CHARANUM
		CALL SETFLAG, "乳首の詳細設定", LCOUNT
	NEXT

	FLAG:29 = 272
ENDIF
;SHOP画面の大幅変更
IF FLAG:29 <= 274
	FLAG:2 = 0
	FLAG:29 = 275
ENDIF
IF FLAG:29 <= 276
	PRINTL 
	PRINTL ・スレの177で指摘された召喚時のバグを修正。ありがとうございます
	PRINTL ・インサートを同じ相手とばかり行うと膣やアナルが相手のペニスの形を覚えるように
	PRINTL 　＜ジャストフィット！＞と表示されて、お互いが気持ちよくなります
	PRINTL 　ペニスが大きいほど、何度も挿入するほどによく覚えます
	PRINTL 　一晩外出とか道具入れたりとかさせてると忘れます
	PRINTL ・経験値で素質を獲得する画面に、取得条件を記載しました
	PRINTL 　スレの171の指摘を受けての変更となります。ありがとうございます
	PRINTL 

	FLAG:29 = 277
ENDIF

TARGET = ARG

;PRINTFORMW Ver.0.{VER_ERASQN()}に更新完了しました
PRINTFORMW Ver.1.00に更新完了しました
