@COM179
;羞恥プレイ
CALL PRINT_TRAIN_NAME(SELECTCOM)

CALL TRAIN_MESSAGE_B

SIF REFUSE_CHECK()
	RETURN 0

STR:0 = %STR:2%

;鏡のセット
;終了時は修正なし
IF TEQUIP:羞恥プレイ
	TEQUIP:羞恥プレイ = 0
	RETURN 1
ELSE
	TEQUIP:羞恥プレイ = 1
ENDIF

RETURN 1

@FLAG_COM179, ARG

@SOURCE_COM179, ARG
VARSET LOCAL

LOCAL:20 += 0
LOCAL:21 += 100

LOCAL:12 = 1000
LOCAL:14 = 500

;ABL:露出癖をみる
SELECTCASE ABL:露出癖
CASE 0
	LOCAL:13 += 600
	LOCAL:14 += 1000
	LOCAL:15 += 1000
CASE 1
	LOCAL:7 += 150
	LOCAL:13 += 500
	TIMES LOCAL:12, 1.50
CASE 2
	LOCAL:7 += 300
	LOCAL:13 += 400
	TIMES LOCAL:12, 2.00
CASE 3
	LOCAL:7 += 600
	LOCAL:13 += 300
	TIMES LOCAL:12, 3.00
CASE 4
	LOCAL:7 += 1000
	LOCAL:13 += 200
	TIMES LOCAL:12, 4.00
CASEELSE
	LOCAL:7 += 1800
	LOCAL:13 += 100
	TIMES LOCAL:12, 5.00
ENDSELECT
;ABL:受虐倾向をみる
SELECTCASE ABL:受虐倾向
CASE 0
CASE 1
	TIMES LOCAL:12 , 1.20
CASE 2
	TIMES LOCAL:12 , 1.40
CASE 3
	TIMES LOCAL:12 , 1.60
CASE 4
	TIMES LOCAL:12 , 1.80
CASEELSE
	TIMES LOCAL:12 , 2.00
ENDSELECT

;臆病
SIF TALENT:胆怯
	TIMES LOCAL:14 , 1.50
;恥じらい
SIF TALENT:羞耻心强
	TIMES LOCAL:14 , 3.00
;魅力
IF TALENT:魅力
	LOCAL:3 += 500
	LOCAL:16 += 500
	TIMES LOCAL:12 , 1.50
	TIMES LOCAL:14 , 1.20
ENDIF

LOCAL:16 += LOCAL:12 / 4
LOCAL:9 += LOCAL:14 / 2

CALL CALC, "調教ソース", LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7, LOCAL:8, LOCAL:9, LOCAL:10, LOCAL:11, LOCAL:12, LOCAL:13, LOCAL:14, LOCAL:15, LOCAL:16, LOCAL:17, LOCAL:18, LOCAL:19, LOCAL:20, LOCAL:21, ARG


@TRAIN_MESSAGE_COM179
IF TEQUIP:羞恥プレイ
	PRINTFORMW %CALLNAME:TARGET%を連れて鏡の前から離れた…
ELSE
	PRINTFORMW %CALLNAME:TARGET%を鏡の前に連れて来た…
ENDIF


@EQUIP_COM57
SIF SELECTCOM == 179
	RETURN 0
;羞恥プレイ
CALL SOURCE_COM179, 30

RETURN 1

@EQUIP_COM57_2
SIF SELECTCOM == 179
	RETURN 0
;羞恥プレイ
PRINTL ＜羞恥プレイ中＞

SIF ASSIPLAY == 0 && ABL:露出癖 >= 3
	TFLAG:30 += 1

RETURN 1
