;-------------------------------------------------
;230〜259番,アルカナ詠唱系コマンド
;-------------------------------------------------
@COM_ABLE230
;ミニマム詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 0)
	RETURN 0
CALL COM_ABLE230_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE230_2
;ミニマム詠唱実行判定
SIF COMABLE_DEF(230)
	RETURN 0

VARSET LOCAL
;ペニス有り＆エンラジがかかっていない＆常にエンラジでない ことが条件
SIF ASSI && PENIS(ASSI) && STATE("小根术", ASSI) == 0 && TALENT:ASSI:大根术常态化 == 0
	SETBIT LOCAL, 0
SIF PENIS(MASTER) && STATE("小根术", MASTER) == 0 && TALENT:MASTER:大根术常态化 == 0
	SETBIT LOCAL, 1
SIF PENIS(TARGET) && STATE("小根术", TARGET) == 0 && TALENT:大根术常态化 == 0
	SETBIT LOCAL, 2
SIF LOCAL == 0
	RETURN 0

SIF MAGIC_USER(230, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE231
;センシブ詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 1)
	RETURN 0
CALL COM_ABLE231_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE231_2
;センシブ詠唱実行判定
SIF COMABLE_DEF(231)
	RETURN 0
;センシブがかかっているとダメ
SIF STATE("高敏术", PLAYER)
	RETURN 0
SIF MAGIC_USER(231, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE232
;ウルズグン詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 2)
	RETURN 0
CALL COM_ABLE232_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE232_2
;ウルズグン詠唱実行判定
SIF COMABLE_DEF(232)
	RETURN 0
;ウルズグンが限界までかかっているとダメ
SIF STATE("精强术", PLAYER) >= 3
	RETURN 0
SIF MAGIC_USER(232, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE233
;シギルグン詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 3)
	RETURN 0
CALL COM_ABLE233_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE233_2
;シギルグン詠唱実行判定
SIF COMABLE_DEF(233)
	RETURN 0
;シギルグンが限界までかかっているとダメ
SIF STATE("魅强术", PLAYER) >= 3
	RETURN 0
SIF MAGIC_USER(233, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE234
;エオルグン詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 4)
	RETURN 0
CALL COM_ABLE234_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE234_2
;エオルグン詠唱実行判定
SIF COMABLE_DEF(234)
	RETURN 0
;エオルグンが限界までかかっているとダメ
SIF STATE("防强术", PLAYER) >= 3
	RETURN 0
SIF MAGIC_USER(234, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE235
;ストック詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 5)
	RETURN 0
CALL COM_ABLE235_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE235_2
;ストック詠唱実行判定
SIF COMABLE_DEF(235)
	RETURN 0
;MASTERの精力＆ストックが全快だとダメ
SIF BASE:MASTER:精力 >= MAXBASE:MASTER:精力 && BASE:MASTER:STOCK >= MAXBASE:MASTER:STOCK
	RETURN 0
SIF MAGIC_USER(235, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE236
;ロギン詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 6)
	RETURN 0
CALL COM_ABLE236_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE236_2
;ロギン詠唱実行判定
SIF COMABLE_DEF(236)
	RETURN 0
;TARGETが全快だとダメ
SIF BASE:体力 >= MAXBASE:体力
	RETURN 0
SIF MAGIC_USER(236, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE237
;トワイス詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 7)
	RETURN 0
CALL COM_ABLE237_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE237_2
;トワイス詠唱実行判定
SIF COMABLE_DEF(237)
	RETURN 0
;トワイス状態だとだめ
SIF STATE("倍化术", PLAYER)
	RETURN 0
SIF MAGIC_USER(237, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE238
;イーサグン詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 8)
	RETURN 0
CALL COM_ABLE238_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE238_2
;イーサグン詠唱実行判定
SIF COMABLE_DEF(238)
	RETURN 0
;グン系魔法がかかってないとダメ
SIF STATE("グン") == 0
	RETURN 0
SIF MAGIC_USER(238, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE239
;アルスイーサ詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 9)
	RETURN 0
CALL COM_ABLE239_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE239_2
;アルスイーサ詠唱実行判定
SIF COMABLE_DEF(239)
	RETURN 0
;二人で押し倒されているとダメ（暫定）
SIF TEQUIP:Ｗ押し倒し
	RETURN 0
;バッドステータスになってないとダメ
SIF STATE("バッド", PLAYER) == 0
	RETURN 0
SIF MAGIC_USER(239, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE240
;バインド詠唱実行判定
;とりあえず今のところ通常使用は封印
RETURN 0

@COM_ABLE241
;アルスグン詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 11)
	RETURN 0
CALL COM_ABLE241_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE241_2
;ウルズグン詠唱実行判定
SIF COMABLE_DEF(241)
	RETURN 0
;全てのグンが限界までかかっているとダメ
SIF STATE("精强术", PLAYER) >= 3 && STATE("防强术", PLAYER) >= 3 && STATE("魅强术", PLAYER) >= 3
	RETURN 0
SIF MAGIC_USER(241, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE242
;エンラジ詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 12)
	RETURN 0
CALL COM_ABLE242_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE242_2
;エンラジ詠唱実行判定
SIF COMABLE_DEF(242)
	RETURN 0

VARSET LOCAL
;ペニス有り＆エンラジがかかっていない＆常にミニマムでない ことが条件
SIF ASSI && PENIS(ASSI) && STATE("大根术", ASSI) == 0 && TALENT:ASSI:小根术常态化 == 0
	SETBIT LOCAL, 0
SIF PENIS(MASTER) && STATE("大根术", MASTER) == 0 && TALENT:MASTER:小根术常态化 == 0
	SETBIT LOCAL, 1
SIF PENIS(TARGET) && STATE("大根术", TARGET) == 0 && TALENT:小根术常态化 == 0
	SETBIT LOCAL, 2
SIF LOCAL == 0
	RETURN 0

SIF MAGIC_USER(242, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE243
;ヴィジョン詠唱実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:216, 13)
	RETURN 0
CALL COM_ABLE243_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE243_2
;ヴィジョン詠唱実行判定
SIF COMABLE_DEF(243)
	RETURN 0
;ヴィジョンがかかっているとダメ
SIF STATE("快感术")
	RETURN 0
SIF MAGIC_USER(243, "コマンド")
	RETURN 1
RETURN 0

@COM_ABLE244
RETURN 0



;-------------------------------------------------
;260〜279番,消費アイテムコマンド
;-------------------------------------------------
@COM_ABLE260
;ローション実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:215, 0)
	RETURN 0
CALL COM_ABLE260_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE260_2
;ローション実行判定
SIF COMABLE_DEF(260)
	RETURN 0
;アイテムを持っているか、アイテムなし設定でないとダメ
SIF ITEM:润滑液 == 0 && NOITEM == 0
	RETURN 0
;シャワー中はダメ
SIF TEQUIP:シャワー
	RETURN 0
RETURN 1

@COM_ABLE261
;媚薬実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:215, 1)
	RETURN 0
CALL COM_ABLE261_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE261_2
;媚薬実行判定
SIF COMABLE_DEF(261)
	RETURN 0
;アイテムを持っているか、アイテムなし設定か触手調教中でないとダメ
SIF ITEM:媚药 == 0 && NOITEM == 0 && TEQUIP:触手 == 0
	RETURN 0
;押し倒されている
IF TEQUIP:押し倒し
	;PLAYERかTARGETに効く状態じゃないとダメ
	SIF TEQUIP:媚薬 && TEQUIP:PLAYER:媚薬
		RETURN 0
	;技巧3LVか調合知識が無いとダメ
	SIF ABL:技巧 < 3 && TALENT:调合知识 == 0
		RETURN 0
ELSE
	;TARGETに効く状態じゃないとダメ
	SIF TEQUIP:媚薬
		RETURN 0
ENDIF
RETURN 1

@COM_ABLE262
;利尿剤実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:215, 2)
	RETURN 0
CALL COM_ABLE262_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE262_2
;利尿剤実行判定
SIF COMABLE_DEF(262)
	RETURN 0
;アイテムを持っているか、アイテムなし設定か触手調教中でないとダメ
SIF ITEM:利尿剂 == 0 && NOITEM == 0 && TEQUIP:触手 == 0
	RETURN 0
;薬毒耐性の場合、直接注入以外ダメ
SIF TALENT:药物耐性 && TEQUIP:触手 == 0
	RETURN 0
;重ねての使用はダメ
SIF TEQUIP:利尿剤
	RETURN 0
RETURN 1

@COM_ABLE263
;鎮静剤実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:215, 3)
	RETURN 0
CALL COM_ABLE263_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE263_2
;鎮静剤実行判定
SIF COMABLE_DEF(263)
	RETURN 0
;アイテムを持っているか、アイテムなし設定でないとダメ
SIF ITEM:镇静剂 == 0 && NOITEM == 0
	RETURN 0
;使用中だとダメ
SIF GETBIT(TEQUIP:PLAYER:ドラッグ, 0)
	RETURN 0
RETURN 1

@COM_ABLE264
;排卵誘発剤実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:215, 4)
	RETURN 0
CALL COM_ABLE264_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE264_2
;排卵誘発剤実行判定
SIF COMABLE_DEF(264)
	RETURN 0
;妊娠パッチがONで無いとダメ
SIF CONFIG("妊娠パッチ") == 0
	RETURN 0
;アイテムを持っているか、アイテムなし設定でないとダメ
SIF ITEM:排卵诱发剂 == 0 && NOITEM == 0
	RETURN 0
SIF USEABLE_ITEM56(TARGET) + USEABLE_ITEM56(PLAYER) == 0
	RETURN 0
RETURN 1

@USEABLE_ITEM56(ARG)
#FUNCTION
;すでに使用中なら使えない
SIF TEQUIP:ARG:排卵誘発剤
	RETURNF 0
;妊娠中なら不可
SIF TALENT:ARG:怀孕
	RETURNF 0
;薬毒耐性の場合ダメ
SIF TALENT:ARG:药物耐性
	RETURNF 0
;人形に排卵はない
SIF TALENT:ARG:魔导人偶
	RETURNF 0
;オトコだとダメ
SIF TALENT:ARG:男性
	RETURNF 0
RETURNF 1

@COM_ABLE265
;インセンス実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:215, 5)
	RETURN 0
CALL COM_ABLE265_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE265_2
;インセンス実行判定
SIF COMABLE_DEF(265)
	RETURN 0
;インセンスを持っていないとダメ
SIF NUM("所持インセンス") == 0
	RETURN 0
;インセンス効果発揮中だとダメ
SIF TEQUIP:MASTER:インセンス
	RETURN 0
RETURN 1

@COM_ABLE266
;入浴剤実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:215, 6)
	RETURN 0
CALL COM_ABLE266_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE266_2
;入浴剤実行判定
SIF COMABLE_DEF(266)
	RETURN 0
;お風呂でないとダメ
SIF TEQUIP:お風呂プレイ == 0
	RETURN 0
;アイテムを持っているか、アイテムなし設定でないとダメ
SIF ITEM:沐浴乳 == 0 && NOITEM == 0
	RETURN 0
;入浴剤使用中はダメ
SIF TEQUIP:MASTER:入浴剤
	RETURN 0
RETURN 1

@COM_ABLE267
;筋弛緩剤実行判定
;フィルタがオフになってないとダメ
SIF GETBIT(FLAG:215, 7)
	RETURN 0
CALL COM_ABLE267_2
SIF RESULT == 1
	RETURN 1
RETURN 0

@COM_ABLE267_2
;筋弛緩剤実行判定
SIF COMABLE_DEF(267)
	RETURN 0
;アイテムを持っているか、アイテムなし設定でないとダメ
SIF ITEM:肌肉松弛剂 == 0 && NOITEM == 0
	RETURN 0
;用法用量は的確に
SIF TEQUIP:筋弛緩剤
	RETURN 0
RETURN 1

@COM_ABLE268
RETURN 0

@COM_ABLE269
RETURN 0



;-------------------------------------------------
;280〜299番,SQ独自(?)の調教コマンド
;-------------------------------------------------
@COM_ABLE280
;もがく実行判定
SIF COMABLE_DEF(280)
	RETURN 0
;押し倒されていないとダメ
SIF TEQUIP:押し倒し + TEQUIP:ラブトラップ == 0
	RETURN 0
;恍惚状態だとだめ
SIF STATE("恍惚", PLAYER)
	RETURN 0
RETURN 1

@COM_ABLE281
;なすがまま実行判定
SIF COMABLE_DEF(281)
	RETURN 0
;押し倒されていないとダメ
SIF TEQUIP:押し倒し + TEQUIP:ラブトラップ == 0
	RETURN 0
RETURN 1

@COM_ABLE282
;自慰する実行判定
SIF COMABLE_DEF(282)
	RETURN 0
;恍惚状態だとだめ…な気もするができても良い多分
;SIF STATE("恍惚", PLAYER)
;	RETURN 0
;縄・拘束中で手が使えない時はダメ
SIF GETBIT(TEQUIP:PLAYER:拘束, 20) || STATE("バインド：手", PLAYER)
	RETURN 0
;誰かに挿入している時に始めるのは流石に失礼だな
SIF INSERT("挿入中", PLAYER)
	RETURN 0
;特定コマンドの次のターン、ないし特定の状況化じゃないとダメということにしておく
SELECTCASE PREVCOM
;クンニ, 自慰, フェラする, アナル舐め, くぱぁさせる, Ａくぱぁさせる
CASE 1, 3, 4, 9, 13, 14, 282
	RETURN 1
CASEELSE
	SIF TEQUIP:颜面骑乘 || TEQUIP:自慰する
		RETURN 1
ENDSELECT
RETURN 0



@COM_ABLE283
RETURN 0

@COM_ABLE284
RETURN 0
