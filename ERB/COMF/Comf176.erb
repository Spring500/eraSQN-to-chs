@COM176
;押し倒される

IF TALENT:拉弥亚
	PRINTL 巻きつかれる
ELSE
	PRINTL 押し倒される
ENDIF

;-------------------------------------------------
;実行できるかの判定
;-------------------------------------------------
CALL SHOW_COM_ORDER_COM, 176

;実行できない
SIF TCVAR:28 == 0
	RETURN 0
;-------------------------------------------------
;実行決定
;-------------------------------------------------
CALL TRAIN_MESSAGE_B

SIF REFUSE_CHECK()
	RETURN 0

STR:0 = 押し倒される

;押し倒され状態の付与
TEQUIP:推到 = 1

RETURN 1

@FLAG_COM176, ARG

@SOURCE_COM176, ARG
VARSET LOCAL

LOCAL:20 += 60
LOCAL:21 += 150

LOCAL:12 = 400

;ABL:侍奉精神をみる
SELECTCASE ABL:侍奉精神
CASE 0
	LOCAL:4 = 200
	LOCAL:5 = 50
CASE 1
	LOCAL:4 = 250
	LOCAL:5 = 200
CASE 2
	LOCAL:4 = 350
	LOCAL:5 = 550
CASE 3
	LOCAL:4 = 450
	LOCAL:5 = 900
CASE 4
	LOCAL:4 = 600
	LOCAL:5 = 1500
CASEELSE
	LOCAL:4 = 750
	LOCAL:5 = 2200
ENDSELECT

;ABL:Ｖ感觉をみる
SELECTCASE ABL:Ｖ感觉
CASE 0
	LOCAL:3 = 25
	TIMES LOCAL:4 , 0.50
CASE 1
	LOCAL:3 = 75
	TIMES LOCAL:4 , 0.80
CASE 2
	LOCAL:3 = 125
	TIMES LOCAL:4 , 1.00
CASE 3
	LOCAL:3 = 175
	TIMES LOCAL:4 , 1.20
CASE 4
	LOCAL:3 = 300
	TIMES LOCAL:4 , 1.50
CASEELSE
	LOCAL:3 = 425
	TIMES LOCAL:4 , 2.00
ENDSELECT

;PALAM:欲情
SELECTCASE PALAM:欲情
CASE IS < PALAMLV:1
	TIMES LOCAL:3 , 0.30
CASE IS < PALAMLV:2
	TIMES LOCAL:3 , 0.60
CASE IS < PALAMLV:3
	TIMES LOCAL:3 , 1.00
CASE IS < PALAMLV:4
	TIMES LOCAL:3 , 1.50
CASE IS < PALAMLV:5
	TIMES LOCAL:3 , 1.80
CASEELSE
	TIMES LOCAL:3 , 2.20
ENDSELECT

;ABL:服从をみる
SELECTCASE ABL:服从
CASE 0
	TIMES LOCAL:3 , 0.60
	LOCAL:13 += 700
CASE 1
	TIMES LOCAL:3 , 0.80
	LOCAL:13 += 500
CASE 2
	LOCAL:13 += 300
CASE 3
	TIMES LOCAL:3 , 1.20
	LOCAL:13 += 100
CASE 4
	TIMES LOCAL:3 , 1.40
	LOCAL:13 += 30
CASEELSE
	TIMES LOCAL:3 , 1.60
ENDSELECT

CALL CALC, "調教ソース", LOCAL:0, LOCAL:1, LOCAL:2, LOCAL:3, LOCAL:4, LOCAL:5, LOCAL:6, LOCAL:7, LOCAL:8, LOCAL:9, LOCAL:10, LOCAL:11, LOCAL:12, LOCAL:13, LOCAL:14, LOCAL:15, LOCAL:16, LOCAL:17, LOCAL:18, LOCAL:19, LOCAL:20, LOCAL:21, ARG


@TRAIN_MESSAGE_COM176
;ラミア
IF TALENT:拉弥亚
	PRINTFORMW 妖しく微笑みながら%CALLNAME:TARGET%が%CALLNAME:PLAYER%に長い尾を巻きつけてくる… 
	PRINTFORMW %CALLNAME:PLAYER%の動きは封じられてしまった…
;それ以外
ELSE
	IF INSERT("インサート")
		PRINTFORMW 妖しく微笑みながら%CALLNAME:TARGET%が%CALLNAME:PLAYER%を押さえつける…
	ELSE
		PRINTFORMW 妖しく微笑みながら%CALLNAME:TARGET%が%CALLNAME:PLAYER%に歩み寄る…
	ENDIF
	PRINTFORMW %CALLNAME:PLAYER%は押し倒されてしまった…
ENDIF


@EQUIP_COM30
;押し倒され中
CALL SOURCE_COM176, 20
SIF STATE("束缚术", PLAYER)
	EXP:PLAYER:束缚经验 += 1

RETURN 1

@EQUIP_COM30_2
;押し倒され中
PRINTL ＜押し倒され中＞

RETURN 1


@COM_ORDER_COM176, ARG
VARSET LOCAL
LOCALS = 

;すべての命令に共通の要素を考慮
;(従順が高いと命令に従いやすいなど)
CALL COM_ORDER, ARG

LOCAL = RESULT

;ABL:侍奉精神
IF ABL:侍奉精神
	LOCAL += ABL:侍奉精神 * 4
	LOCALS = %LOCALS% + %ABLNAME:6%LV{ABL:侍奉精神}({ABL:侍奉精神 * 4})
ENDIF
;ABL:精液上瘾
IF ABL:精液上瘾
	LOCAL += ABL:精液上瘾 * 3
	LOCALS = %LOCALS% + %ABLNAME:11%LV{ABL:精液上瘾}({ABL:精液上瘾 * 3})
ENDIF
;強気
IF TALENT:强硬
	LOCAL += 10
	LOCALS = %LOCALS% + %TALENTNAME:18%(10)
ENDIF
;恥じらい
IF TALENT:羞耻心强
	LOCAL -= 5
	LOCALS = %LOCALS% - %TALENTNAME:35%(5)
ENDIF
;快感の否定
IF TALENT:否认快感
	LOCAL -= 1
	LOCALS = %LOCALS% - %TALENTNAME:71%(1)
ENDIF
;サド
IF TALENT:抖Ｓ
	LOCAL += 5
	LOCALS = %LOCALS% + %TALENTNAME:83%(5)
ENDIF

;処女
IF TALENT:处女
	LOCAL -= 20
	LOCALS = %LOCALS% - %TALENTNAME:0%(20)
ELSEIF EXP:Ｖ经验 < EXPLV:2
	LOCAL -= 5
	LOCALS = %LOCALS% - %EXPNAME:0%不足(5)
ENDIF

;媚薬
IF TEQUIP:媚药
	LOCAL += 6
	LOCALS = %LOCALS% + %ITEMNAME:31%(6)
ENDIF

;合計を表示(24以上で実行)
CALL PRINT_COM_ORDER_COM, LOCALS, ARG, LOCAL, 24

RETURN RESULT
